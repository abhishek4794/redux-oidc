!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("prop-types"),require("react"),function(){try{return require("immutable")}catch(e){}}());else if("function"==typeof define&&define.amd)define(["prop-types","react","immutable"],t);else{var r="object"==typeof exports?t(require("prop-types"),require("react"),function(){try{return require("immutable")}catch(e){}}()):t(e["prop-types"],e.react,e.immutable);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(e,t,r){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=16)}([function(e,t,r){"use strict";function n(){return{type:l.USER_EXPIRED}}function i(e){return{type:l.USER_FOUND,payload:e}}function o(e){return{type:l.SILENT_RENEW_ERROR,payload:e}}function s(){return{type:l.SESSION_TERMINATED}}function a(){return{type:l.USER_EXPIRING}}function u(){return{type:l.LOADING_USER}}function c(){return{type:l.USER_SIGNED_OUT}}function h(){return{type:l.LOAD_USER_ERROR}}Object.defineProperty(t,"__esModule",{value:!0}),t.userExpired=n,t.userFound=i,t.silentRenewError=o,t.sessionTerminated=s,t.userExpiring=a,t.loadingUser=u,t.userSignedOut=c,t.loadUserError=h;var l=r(1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USER_EXPIRED="redux-oidc/USER_EXPIRED",t.SILENT_RENEW_ERROR="redux-oidc/SILENT_RENEW_ERROR",t.SESSION_TERMINATED="redux-oidc/SESSION_TERMINATED",t.USER_EXPIRING="redux-oidc/USER_EXPIRING",t.USER_FOUND="redux-oidc/USER_FOUND",t.LOADING_USER="redux-oidc/LOADING_USER",t.USER_SIGNED_OUT="redux-oidc/USER_SIGNED_OUT",t.LOAD_USER_ERROR="redux-oidc/LOAD_USER_ERROR"},function(e,t,r){"use strict";function n(e){return new i.UserManager(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var i=r(10)},function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("react")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadUserError=t.userSignedOut=t.loadingUser=t.userExpiring=t.sessionTerminated=t.silentRenewError=t.userFound=t.userExpired=t.LOAD_USER_ERROR=t.USER_SIGNED_OUT=t.LOADING_USER=t.USER_EXPIRING=t.SESSION_TERMINATED=t.SILENT_RENEW_ERROR=t.USER_FOUND=t.USER_EXPIRED=t.OidcProvider=t.reducer=t.immutableReducer=t.CallbackComponent=t.loadUser=t.processSilentRenew=t.createUserManager=void 0;var n=r(11),i=function(e){return e&&e.__esModule?e:{default:e}}(n);t.createUserManager=r(2).default,t.processSilentRenew=r(9).default,t.loadUser=r(8).default,t.CallbackComponent=r(6).default,t.immutableReducer=r(12).default,t.reducer=r(13).default,t.OidcProvider=r(7).default,t.USER_EXPIRED=r(1).USER_EXPIRED,t.USER_FOUND=r(1).USER_FOUND,t.SILENT_RENEW_ERROR=r(1).SILENT_RENEW_ERROR,t.SESSION_TERMINATED=r(1).SESSION_TERMINATED,t.USER_EXPIRING=r(1).USER_EXPIRING,t.LOADING_USER=r(1).LOADING_USER,t.USER_SIGNED_OUT=r(1).USER_SIGNED_OUT,t.LOAD_USER_ERROR=r(1).LOAD_USER_ERROR,t.userExpired=r(0).userExpired,t.userFound=r(0).userFound,t.silentRenewError=r(0).silentRenewError,t.sessionTerminated=r(0).sessionTerminated,t.userExpiring=r(0).userExpiring,t.loadingUser=r(0).loadingUser,t.userSignedOut=r(0).userSignedOut,t.loadUserError=r(0).loadUserError,t.default=i.default},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(3),c=n(u),h=r(4),l=n(h),f=(r(0),function(e){function t(){var e,r,n,s;i(this,t);for(var a=arguments.length,u=Array(a),c=0;c<a;c++)u[c]=arguments[c];return r=n=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n.onRedirectSuccess=function(e){n.props.successCallback(e)},n.onRedirectError=function(e){if(!n.props.errorCallback)throw new Error("Error handling redirect callback: "+e.message);n.props.errorCallback(e)},s=r,o(n,s)}return s(t,e),a(t,[{key:"componentDidMount",value:function(){var e=this;this.props.userManager.signinRedirectCallback().then(function(t){return e.onRedirectSuccess(t)}).catch(function(t){return e.onRedirectError(t)})}},{key:"render",value:function(){return l.default.Children.only(this.props.children)}}]),t}(l.default.Component));f.propTypes={children:c.default.element.isRequired,userManager:c.default.object.isRequired,successCallback:c.default.func.isRequired,errorCallback:c.default.func},t.default=f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(3),c=n(u),h=r(4),l=n(h),f=r(0),p=function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.onUserLoaded=function(e){r.props.store.dispatch((0,f.userFound)(e))},r.onSilentRenewError=function(e){r.props.store.dispatch((0,f.silentRenewError)(e))},r.onAccessTokenExpired=function(){r.props.store.dispatch((0,f.userExpired)())},r.onUserUnloaded=function(){r.props.store.dispatch((0,f.sessionTerminated)())},r.onAccessTokenExpiring=function(){r.props.store.dispatch((0,f.userExpiring)())},r.onUserSignedOut=function(){r.props.store.dispatch((0,f.userSignedOut)())},r.userManager=e.userManager,r}return s(t,e),a(t,[{key:"componentWillMount",value:function(){this.userManager.events.addUserLoaded(this.onUserLoaded),this.userManager.events.addSilentRenewError(this.onSilentRenewError),this.userManager.events.addAccessTokenExpired(this.onAccessTokenExpired),this.userManager.events.addAccessTokenExpiring(this.onAccessTokenExpiring),this.userManager.events.addUserUnloaded(this.onUserUnloaded),this.userManager.events.addUserSignedOut(this.onUserSignedOut)}},{key:"componentWillUnmount",value:function(){this.userManager.events.removeUserLoaded(this.onUserLoaded),this.userManager.events.removeSilentRenewError(this.onSilentRenewError),this.userManager.events.removeAccessTokenExpired(this.onAccessTokenExpired),this.userManager.events.removeAccessTokenExpiring(this.onAccessTokenExpiring),this.userManager.events.removeUserUnloaded(this.onUserUnloaded),this.userManager.events.removeUserSignedOut(this.onUserSignedOut)}},{key:"render",value:function(){return l.default.Children.only(this.props.children)}}]),t}(l.default.Component);p.propTypes={userManager:c.default.object.isRequired,store:c.default.object.isRequired},t.default=p},function(e,t,r){"use strict";function n(e){c=e}function i(){return c}function o(e){return e&&!e.expired?c.dispatch((0,u.userFound)(e)):(!e||e&&e.expired)&&c.dispatch((0,u.userExpired)()),e}function s(e){console.error("redux-oidc: Error in loadUser() function: "+e.message),c.dispatch((0,u.loadUserError)())}function a(e,t){if(!e||!e.dispatch)throw new Error("redux-oidc: You need to pass the redux store into the loadUser helper!");if(!t||!t.getUser)throw new Error("redux-oidc: You need to pass the userManager into the loadUser helper!");return c=e,e.dispatch((0,u.loadingUser)()),t.getUser().then(o).catch(s)}Object.defineProperty(t,"__esModule",{value:!0}),t.setReduxStore=n,t.getReduxStore=i,t.getUserCallback=o,t.errorCallback=s,t.default=a;var u=r(0),c=void 0},function(e,t,r){"use strict";function n(){(0,o.default)().signinSilentCallback()}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var i=r(2),o=function(e){return e&&e.__esModule?e:{default:e}}(i)},function(e,t,r){"use strict";(function(e){var r,n,i,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(s,a){"object"===o(t)&&"object"===o(e)?e.exports=a():(n=[],r=a,void 0!==(i="function"==typeof r?r.apply(t,n):r)&&(e.exports=i))}(window,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"===(void 0===e?"undefined":o(e))&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var i in e)t.d(n,i,function(t){return e[t]}.bind(null,i));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s="./index.js")}({"./index.js":function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=r("./src/Log.js"),i=r("./src/OidcClient.js"),o=r("./src/OidcClientSettings.js"),s=r("./src/WebStorageStateStore.js"),a=r("./src/InMemoryWebStorage.js"),u=r("./src/UserManager.js"),c=r("./src/AccessTokenEvents.js"),h=r("./src/MetadataService.js"),l=r("./src/CordovaPopupNavigator.js"),f=r("./src/CordovaIFrameNavigator.js"),p=r("./src/CheckSessionIFrame.js"),d=r("./src/TokenRevocationClient.js"),g=r("./src/SessionMonitor.js"),v=r("./src/Global.js"),y=r("./src/User.js");t.default={Log:n.Log,OidcClient:i.OidcClient,OidcClientSettings:o.OidcClientSettings,WebStorageStateStore:s.WebStorageStateStore,InMemoryWebStorage:a.InMemoryWebStorage,UserManager:u.UserManager,AccessTokenEvents:c.AccessTokenEvents,MetadataService:h.MetadataService,CordovaPopupNavigator:l.CordovaPopupNavigator,CordovaIFrameNavigator:f.CordovaIFrameNavigator,CheckSessionIFrame:p.CheckSessionIFrame,TokenRevocationClient:d.TokenRevocationClient,SessionMonitor:g.SessionMonitor,Global:v.Global,User:y.User},e.exports=t.default},"./jsrsasign/dist/jsrsasign.js":function(e,t,r){(function(e){function r(e){var t,r,n="";for(t=0;t+3<=e.length;t+=3)r=parseInt(e.substring(t,t+3),16),n+=Vr.charAt(r>>6)+Vr.charAt(63&r);if(t+1==e.length?(r=parseInt(e.substring(t,t+1),16),n+=Vr.charAt(r<<2)):t+2==e.length&&(r=parseInt(e.substring(t,t+2),16),n+=Vr.charAt(r>>2)+Vr.charAt((3&r)<<4)),Wr)for(;(3&n.length)>0;)n+=Wr;return n}function n(e){var t,r,n,i="",o=0;for(t=0;t<e.length&&e.charAt(t)!=Wr;++t)(n=Vr.indexOf(e.charAt(t)))<0||(0==o?(i+=l(n>>2),r=3&n,o=1):1==o?(i+=l(r<<2|n>>4),r=15&n,o=2):2==o?(i+=l(r),i+=l(n>>2),r=3&n,o=3):(i+=l(r<<2|n>>4),i+=l(15&n),o=0));return 1==o&&(i+=l(r<<2)),i}function i(e){var t,r=n(e),i=new Array;for(t=0;2*t<r.length;++t)i[t]=parseInt(r.substring(2*t,2*t+2),16);return i}function s(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function a(){return new s(null)}function u(e,t,r,n,i,o){for(;--o>=0;){var s=t*this[e++]+r[n]+i;i=Math.floor(s/67108864),r[n++]=67108863&s}return i}function c(e,t,r,n,i,o){for(var s=32767&t,a=t>>15;--o>=0;){var u=32767&this[e],c=this[e++]>>15,h=a*u+c*s;u=s*u+((32767&h)<<15)+r[n]+(1073741823&i),i=(u>>>30)+(h>>>15)+a*c+(i>>>30),r[n++]=1073741823&u}return i}function h(e,t,r,n,i,o){for(var s=16383&t,a=t>>14;--o>=0;){var u=16383&this[e],c=this[e++]>>14,h=a*u+c*s;u=s*u+((16383&h)<<14)+r[n]+i,i=(u>>28)+(h>>14)+a*c,r[n++]=268435455&u}return i}function l(e){return Gr.charAt(e)}function f(e,t){var r=zr[e.charCodeAt(t)];return null==r?-1:r}function p(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s}function d(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0}function g(e){var t=a();return t.fromInt(e),t}function v(e,t){var r;if(16==t)r=4;else if(8==t)r=3;else if(256==t)r=8;else if(2==t)r=1;else if(32==t)r=5;else{if(4!=t)return void this.fromRadix(e,t);r=2}this.t=0,this.s=0;for(var n=e.length,i=!1,o=0;--n>=0;){var a=8==r?255&e[n]:f(e,n);a<0?"-"==e.charAt(n)&&(i=!0):(i=!1,0==o?this[this.t++]=a:o+r>this.DB?(this[this.t-1]|=(a&(1<<this.DB-o)-1)<<o,this[this.t++]=a>>this.DB-o):this[this.t-1]|=a<<o,(o+=r)>=this.DB&&(o-=this.DB))}8==r&&0!=(128&e[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),i&&s.ZERO.subTo(this,this)}function y(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t}function m(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(r=this[s]>>a)>0&&(i=!0,o=l(r));s>=0;)a<t?(r=(this[s]&(1<<a)-1)<<t-a,r|=this[--s]>>(a+=this.DB-t)):(r=this[s]>>(a-=t)&n,a<=0&&(a+=this.DB,--s)),r>0&&(i=!0),i&&(o+=l(r));return i?o:"0"}function S(){var e=a();return s.ZERO.subTo(this,e),e}function _(){return this.s<0?this.negate():this}function F(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0}function b(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function w(){return this.t<=0?0:this.DB*(this.t-1)+b(this[this.t-1]^this.s&this.DM)}function E(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s}function x(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s}function A(e,t){var r,n=e%this.DB,i=this.DB-n,o=(1<<i)-1,s=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+s+1]=this[r]>>i|a,a=(this[r]&o)<<n;for(r=s-1;r>=0;--r)t[r]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()}function P(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)return void(t.t=0);var n=e%this.DB,i=this.DB-n,o=(1<<n)-1;t[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)t[s-r-1]|=(this[s]&o)<<i,t[s-r]=this[s]>>n;n>0&&(t[this.t-r-1]|=(this.s&o)<<i),t.t=this.t-r,t.clamp()}function C(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()}function k(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t[i]=0;for(i=0;i<n.t;++i)t[i+r.t]=r.am(0,n[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&s.ZERO.subTo(t,t)}function R(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()}function T(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=a());var o=a(),u=this.s,c=e.s,h=this.DB-b(n[n.t-1]);h>0?(n.lShiftTo(h,o),i.lShiftTo(h,r)):(n.copyTo(o),i.copyTo(r));var l=o.t,f=o[l-1];if(0!=f){var p=f*(1<<this.F1)+(l>1?o[l-2]>>this.F2:0),d=this.FV/p,g=(1<<this.F1)/p,v=1<<this.F2,y=r.t,m=y-l,S=null==t?a():t;for(o.dlShiftTo(m,S),r.compareTo(S)>=0&&(r[r.t++]=1,r.subTo(S,r)),s.ONE.dlShiftTo(l,S),S.subTo(o,o);o.t<l;)o[o.t++]=0;for(;--m>=0;){var _=r[--y]==f?this.DM:Math.floor(r[y]*d+(r[y-1]+v)*g);if((r[y]+=o.am(0,_,r,m,0,l))<_)for(o.dlShiftTo(m,S),r.subTo(S,r);r[y]<--_;)r.subTo(S,r)}null!=t&&(r.drShiftTo(l,t),u!=c&&s.ZERO.subTo(t,t)),r.t=l,r.clamp(),h>0&&r.rShiftTo(h,r),u<0&&s.ZERO.subTo(r,r)}}}function I(e){var t=a();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(s.ZERO)>0&&e.subTo(t,t),t}function U(e){this.m=e}function j(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function O(e){return e}function L(e){e.divRemTo(this.m,null,e)}function N(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function D(e,t){e.squareTo(t),this.reduce(t)}function M(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return t=t*(2-(15&e)*t)&15,t=t*(2-(255&e)*t)&255,t=t*(2-((65535&e)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function B(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function H(e){var t=a();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(s.ZERO)>0&&this.m.subTo(t,t),t}function K(e){var t=a();return e.copyTo(t),this.reduce(t),t}function q(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e[r]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function V(e,t){e.squareTo(t),this.reduce(t)}function W(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function J(){return 0==(this.t>0?1&this[0]:this.s)}function Y(e,t){if(e>4294967295||e<1)return s.ONE;var r=a(),n=a(),i=t.convert(this),o=b(e)-1;for(i.copyTo(r);--o>=0;)if(t.sqrTo(r,n),(e&1<<o)>0)t.mulTo(n,i,r);else{var u=r;r=n,n=u}return t.revert(r)}function G(e,t){var r;return r=e<256||t.isEven()?new U(t):new B(t),this.exp(e,r)}function z(){var e=a();return this.copyTo(e),e}function X(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function Z(){return 0==this.t?this.s:this[0]<<24>>24}function Q(){return 0==this.t?this.s:this[0]<<16>>16}function $(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function ee(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function te(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=g(r),i=a(),o=a(),s="";for(this.divRemTo(n,i,o);i.signum()>0;)s=(r+o.intValue()).toString(e).substr(1)+s,i.divRemTo(n,i,o);return o.intValue().toString(e)+s}function re(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,o=0,a=0,u=0;u<e.length;++u){var c=f(e,u);c<0?"-"==e.charAt(u)&&0==this.signum()&&(i=!0):(a=t*a+c,++o>=r&&(this.dMultiply(n),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(a,0)),i&&s.ZERO.subTo(this,this)}function ne(e,t,r){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(s.ONE.shiftLeft(e-1),le,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(s.ONE.shiftLeft(e-1),this);else{var n=new Array,i=7&e;n.length=1+(e>>3),t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function ie(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t}function oe(e){return 0==this.compareTo(e)}function se(e){return this.compareTo(e)<0?this:e}function ae(e){return this.compareTo(e)>0?this:e}function ue(e,t,r){var n,i,o=Math.min(e.t,this.t);for(n=0;n<o;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=o;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=o;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function ce(e,t){return e&t}function he(e){var t=a();return this.bitwiseTo(e,ce,t),t}function le(e,t){return e|t}function fe(e){var t=a();return this.bitwiseTo(e,le,t),t}function pe(e,t){return e^t}function de(e){var t=a();return this.bitwiseTo(e,pe,t),t}function ge(e,t){return e&~t}function ve(e){var t=a();return this.bitwiseTo(e,ge,t),t}function ye(){for(var e=a(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e}function me(e){var t=a();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Se(e){var t=a();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function _e(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function Fe(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+_e(this[e]);return this.s<0?this.t*this.DB:-1}function be(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function we(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=be(this[r]^t);return e}function Ee(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)}function xe(e,t){var r=s.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function Ae(e){return this.changeBit(e,le)}function Pe(e){return this.changeBit(e,ge)}function Ce(e){return this.changeBit(e,pe)}function ke(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()}function Re(e){var t=a();return this.addTo(e,t),t}function Te(e){var t=a();return this.subTo(e,t),t}function Ie(e){var t=a();return this.multiplyTo(e,t),t}function Ue(){var e=a();return this.squareTo(e),e}function je(e){var t=a();return this.divRemTo(e,t,null),t}function Oe(e){var t=a();return this.divRemTo(e,null,t),t}function Le(e){var t=a(),r=a();return this.divRemTo(e,t,r),new Array(t,r)}function Ne(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function De(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}}function Me(){}function Be(e){return e}function He(e,t,r){e.multiplyTo(t,r)}function Ke(e,t){e.squareTo(t)}function qe(e){return this.exp(e,new Me)}function Ve(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()}function We(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function Je(e){this.r2=a(),this.q3=a(),s.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function Ye(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=a();return e.copyTo(t),this.reduce(t),t}function Ge(e){return e}function ze(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function Xe(e,t){e.squareTo(t),this.reduce(t)}function Ze(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function Qe(e,t){var r,n,i=e.bitLength(),o=g(1);if(i<=0)return o;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new U(t):t.isEven()?new Je(t):new B(t);var s=new Array,u=3,c=r-1,h=(1<<r)-1;if(s[1]=n.convert(this),r>1){var l=a();for(n.sqrTo(s[1],l);u<=h;)s[u]=a(),n.mulTo(l,s[u-2],s[u]),u+=2}var f,p,d=e.t-1,v=!0,y=a();for(i=b(e[d])-1;d>=0;){for(i>=c?f=e[d]>>i-c&h:(f=(e[d]&(1<<i+1)-1)<<c-i,d>0&&(f|=e[d-1]>>this.DB+i-c)),u=r;0==(1&f);)f>>=1,--u;if((i-=u)<0&&(i+=this.DB,--d),v)s[f].copyTo(o),v=!1;else{for(;u>1;)n.sqrTo(o,y),n.sqrTo(y,o),u-=2;u>0?n.sqrTo(o,y):(p=o,o=y,y=p),n.mulTo(y,s[f],o)}for(;d>=0&&0==(e[d]&1<<i);)n.sqrTo(o,y),p=o,o=y,y=p,--i<0&&(i=this.DB-1,--d)}return n.revert(o)}function $e(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(i<o&&(o=i),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function et(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r}function tt(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return s.ZERO;for(var r=e.clone(),n=this.clone(),i=g(1),o=g(0),a=g(0),u=g(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(i.isEven()&&o.isEven()||(i.addTo(this,i),o.subTo(e,o)),i.rShiftTo(1,i)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&u.isEven()||(a.addTo(this,a),u.subTo(e,u)),a.rShiftTo(1,a)):u.isEven()||u.subTo(e,u),u.rShiftTo(1,u);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),o.subTo(u,o)):(n.subTo(r,n),t&&a.subTo(i,a),u.subTo(o,u))}return 0!=n.compareTo(s.ONE)?s.ZERO:u.compareTo(e)>=0?u.subtract(e):u.signum()<0?(u.addTo(e,u),u.signum()<0?u.add(e):u):u}function rt(e){var t,r=this.abs();if(1==r.t&&r[0]<=Xr[Xr.length-1]){for(t=0;t<Xr.length;++t)if(r[0]==Xr[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<Xr.length;){for(var n=Xr[t],i=t+1;i<Xr.length&&n<Zr;)n*=Xr[i++];for(n=r.modInt(n);t<i;)if(n%Xr[t++]==0)return!1}return r.millerRabin(e)}function nt(e){var t=this.subtract(s.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);(e=e+1>>1)>Xr.length&&(e=Xr.length);for(var i=a(),o=0;o<e;++o){i.fromInt(Xr[Math.floor(Math.random()*Xr.length)]);var u=i.modPow(n,this);if(0!=u.compareTo(s.ONE)&&0!=u.compareTo(t)){for(var c=1;c++<r&&0!=u.compareTo(t);)if(u=u.modPowInt(2,this),0==u.compareTo(s.ONE))return!1;if(0!=u.compareTo(t))return!1}}return!0}function it(){this.i=0,this.j=0,this.S=new Array}function ot(e){var t,r,n;for(t=0;t<256;++t)this.S[t]=t;for(r=0,t=0;t<256;++t)r=r+this.S[t]+e[t%e.length]&255,n=this.S[t],this.S[t]=this.S[r],this.S[r]=n;this.i=0,this.j=0}function st(){var e;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,e=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=e,this.S[e+this.S[this.i]&255]}function at(){return new it}function ut(e){$r[en++]^=255&e,$r[en++]^=e>>8&255,$r[en++]^=e>>16&255,$r[en++]^=e>>24&255,en>=tn&&(en-=tn)}function ct(){ut((new Date).getTime())}function ht(){if(null==Qr){for(ct(),Qr=at(),Qr.init($r),en=0;en<$r.length;++en)$r[en]=0;en=0}return Qr.next()}function lt(e){var t;for(t=0;t<e.length;++t)e[t]=ht()}function ft(){}function pt(e,t){return new s(e,t)}function dt(e,t){if(t<e.length+11)throw"Message too long for RSA";for(var r=new Array,n=e.length-1;n>=0&&t>0;){var i=e.charCodeAt(n--);i<128?r[--t]=i:i>127&&i<2048?(r[--t]=63&i|128,r[--t]=i>>6|192):(r[--t]=63&i|128,r[--t]=i>>6&63|128,r[--t]=i>>12|224)}r[--t]=0;for(var o=new ft,a=new Array;t>2;){for(a[0]=0;0==a[0];)o.nextBytes(a);r[--t]=a[0]}return r[--t]=2,r[--t]=0,new s(r)}function gt(e,t,r){for(var n="",i=0;n.length<t;)n+=r(String.fromCharCode.apply(String,e.concat([(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i]))),i+=1;return n}function vt(e,t,r,n){var i=cn.crypto.MessageDigest,o=cn.crypto.Util,a=null;if(r||(r="sha1"),"string"==typeof r&&(a=i.getCanonicalAlgName(r),n=i.getHashLength(a),r=function(e){return hr(o.hashHex(lr(e),a))}),e.length+2*n+2>t)throw"Message too long for RSA";var u,c="";for(u=0;u<t-e.length-2*n-2;u+=1)c+="\0";var h=r("")+c+""+e,l=new Array(n);(new ft).nextBytes(l);var f=gt(l,h.length,r),p=[];for(u=0;u<h.length;u+=1)p[u]=h.charCodeAt(u)^f.charCodeAt(u);var d=gt(p,l.length,r),g=[0];for(u=0;u<l.length;u+=1)g[u+1]=l[u]^d.charCodeAt(u);return new s(g.concat(p))}function yt(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function mt(e,t){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof e)this.n=e,this.e=t;else{if(!(null!=e&&null!=t&&e.length>0&&t.length>0))throw"Invalid RSA public key";this.n=pt(e,16),this.e=parseInt(t,16)}}function St(e){return e.modPowInt(this.e,this.n)}function _t(e){var t=dt(e,this.n.bitLength()+7>>3);if(null==t)return null;var r=this.doPublic(t);if(null==r)return null;var n=r.toString(16);return 0==(1&n.length)?n:"0"+n}function Ft(e,t,r){var n=vt(e,this.n.bitLength()+7>>3,t,r);if(null==n)return null;var i=this.doPublic(n);if(null==i)return null;var o=i.toString(16);return 0==(1&o.length)?o:"0"+o}function bt(e,t){this.x=t,this.q=e}function wt(e){return e==this||this.q.equals(e.q)&&this.x.equals(e.x)}function Et(){return this.x}function xt(){return new bt(this.q,this.x.negate().mod(this.q))}function At(e){return new bt(this.q,this.x.add(e.toBigInteger()).mod(this.q))}function Pt(e){return new bt(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))}function Ct(e){return new bt(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))}function kt(){return new bt(this.q,this.x.square().mod(this.q))}function Rt(e){return new bt(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))}function Tt(e,t,r,n){this.curve=e,this.x=t,this.y=r,this.z=null==n?s.ONE:n,this.zinv=null}function It(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function Ut(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function jt(e){if(e==this)return!0;if(this.isInfinity())return e.isInfinity();if(e.isInfinity())return this.isInfinity();var t,r;return t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),!!t.equals(s.ZERO)&&(r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q),r.equals(s.ZERO))}function Ot(){return null==this.x&&null==this.y||this.z.equals(s.ZERO)&&!this.y.toBigInteger().equals(s.ZERO)}function Lt(){return new Tt(this.curve,this.x,this.y.negate(),this.z)}function Nt(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),r=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(s.ZERO.equals(r))return s.ZERO.equals(t)?this.twice():this.curve.getInfinity();var n=new s("3"),i=this.x.toBigInteger(),o=this.y.toBigInteger(),a=(e.x.toBigInteger(),e.y.toBigInteger(),r.square()),u=a.multiply(r),c=i.multiply(a),h=t.square().multiply(this.z),l=h.subtract(c.shiftLeft(1)).multiply(e.z).subtract(u).multiply(r).mod(this.curve.q),f=c.multiply(n).multiply(t).subtract(o.multiply(u)).subtract(h.multiply(t)).multiply(e.z).add(t.multiply(u)).mod(this.curve.q),p=u.multiply(this.z).multiply(e.z).mod(this.curve.q);return new Tt(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(f),p)}function Dt(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new s("3"),t=this.x.toBigInteger(),r=this.y.toBigInteger(),n=r.multiply(this.z),i=n.multiply(r).mod(this.curve.q),o=this.curve.a.toBigInteger(),a=t.square().multiply(e);s.ZERO.equals(o)||(a=a.add(this.z.square().multiply(o))),a=a.mod(this.curve.q);var u=a.square().subtract(t.shiftLeft(3).multiply(i)).shiftLeft(1).multiply(n).mod(this.curve.q),c=a.multiply(e).multiply(t).subtract(i.shiftLeft(1)).shiftLeft(2).multiply(i).subtract(a.square().multiply(a)).mod(this.curve.q),h=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new Tt(this.curve,this.curve.fromBigInteger(u),this.curve.fromBigInteger(c),h)}function Mt(e){if(this.isInfinity())return this;if(0==e.signum())return this.curve.getInfinity();var t,r=e,n=r.multiply(new s("3")),i=this.negate(),o=this;for(t=n.bitLength()-2;t>0;--t){o=o.twice();var a=n.testBit(t);a!=r.testBit(t)&&(o=o.add(a?this:i))}return o}function Bt(e,t,r){var n;n=e.bitLength()>r.bitLength()?e.bitLength()-1:r.bitLength()-1;for(var i=this.curve.getInfinity(),o=this.add(t);n>=0;)i=i.twice(),e.testBit(n)?i=r.testBit(n)?i.add(o):i.add(this):r.testBit(n)&&(i=i.add(t)),--n;return i}function Ht(e,t,r){this.q=e,this.a=this.fromBigInteger(t),this.b=this.fromBigInteger(r),this.infinity=new Tt(this,null,null)}function Kt(){return this.q}function qt(){return this.a}function Vt(){return this.b}function Wt(e){return e==this||this.q.equals(e.q)&&this.a.equals(e.a)&&this.b.equals(e.b)}function Jt(){return this.infinity}function Yt(e){return new bt(this.q,e)}function Gt(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var t=(e.length-2)/2,r=e.substr(2,t),n=e.substr(t+2,t);return new Tt(this,this.fromBigInteger(new s(r,16)),this.fromBigInteger(new s(n,16)));default:return null}}function zt(e){for(var t=new Array,r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function Xt(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}function Zt(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);1==n.length&&(n="0"+n),t+=n}return t}function Qt(e){return Zt(zt(e))}function $t(e){return r(Qt(e))}function er(e){return rr(r(Qt(e)))}function tr(e){return Xt(i(nr(e)))}function rr(e){return e=e.replace(/\=/g,""),e=e.replace(/\+/g,"-"),e=e.replace(/\//g,"_")}function nr(e){return e.length%4==2?e+="==":e.length%4==3&&(e+="="),e=e.replace(/-/g,"+"),e=e.replace(/_/g,"/")}function ir(e){return e.length%2==1&&(e="0"+e),rr(r(e))}function or(e){return n(nr(e))}function sr(e){return r(wr(kr(e)))}function ar(e){return decodeURIComponent(Er(n(e)))}function ur(e){return wr(kr(e))}function cr(e){return decodeURIComponent(Er(e))}function hr(e){for(var t="",r=0;r<e.length-1;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t}function lr(e){for(var t="",r=0;r<e.length;r++)t+=("0"+e.charCodeAt(r).toString(16)).slice(-2);return t}function fr(e){return r(e)}function pr(e){var t=fr(e),r=t.replace(/(.{64})/g,"$1\r\n");return r=r.replace(/\r\n$/,"")}function dr(e){return n(e.replace(/[^0-9A-Za-z\/+=]*/g,""))}function gr(e,t){return"-----BEGIN "+t+"-----\r\n"+pr(e)+"\r\n-----END "+t+"-----\r\n"}function vr(e,t){if(-1==e.indexOf("-----BEGIN "))throw"can't find PEM header: "+t;return void 0!==t?(e=e.replace("-----BEGIN "+t+"-----",""),e=e.replace("-----END "+t+"-----","")):(e=e.replace(/-----BEGIN [^-]+-----/,""),e=e.replace(/-----END [^-]+-----/,"")),dr(e)}function yr(e){if(e.length%2!=0)throw"input is not even length";if(null==e.match(/^[0-9A-Fa-f]+$/))throw"input is not hexadecimal";for(var t=new ArrayBuffer(e.length/2),r=new DataView(t),n=0;n<e.length/2;n++)r.setUint8(n,parseInt(e.substr(2*n,2),16));return t}function mr(e){for(var t="",r=new DataView(e),n=0;n<e.byteLength;n++)t+=("00"+r.getUint8(n).toString(16)).slice(-2);return t}function Sr(e){var t,r,n,i,o,s,a,u,c,h,l;if(l=e.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return u=l[1],t=parseInt(u),2===u.length&&(50<=t&&t<100?t=1900+t:0<=t&&t<50&&(t=2e3+t)),r=parseInt(l[2])-1,n=parseInt(l[3]),i=parseInt(l[4]),o=parseInt(l[5]),s=parseInt(l[6]),a=0,c=l[7],""!==c&&(h=(c.substr(1)+"00").substr(0,3),a=parseInt(h)),Date.UTC(t,r,n,i,o,s,a);throw"unsupported zulu format: "+e}function _r(e){return~~(Sr(e)/1e3)}function Fr(e){return new Date(Sr(e))}function br(e,t,r){var n,i=e.getUTCFullYear();if(t){if(i<1950||2049<i)throw"not proper year for UTCTime: "+i;n=(""+i).slice(-2)}else n=("000"+i).slice(-4);if(n+=("0"+(e.getUTCMonth()+1)).slice(-2),n+=("0"+e.getUTCDate()).slice(-2),n+=("0"+e.getUTCHours()).slice(-2),n+=("0"+e.getUTCMinutes()).slice(-2),n+=("0"+e.getUTCSeconds()).slice(-2),r){var o=e.getUTCMilliseconds();0!==o&&(o=("00"+o).slice(-3),o=o.replace(/0+$/g,""),n+="."+o)}return n+="Z"}function wr(e){return e.replace(/%/g,"")}function Er(e){return e.replace(/(..)/g,"%$1")}function xr(e){var t="malformed IPv6 address";if(!e.match(/^[0-9A-Fa-f:]+$/))throw t;e=e.toLowerCase();var r=e.split(":").length-1;if(r<2)throw t;var n=":".repeat(7-r+2);e=e.replace("::",n);var i=e.split(":");if(8!=i.length)throw t;for(var o=0;o<8;o++)i[o]=("0000"+i[o]).slice(-4);return i.join("")}function Ar(e){if(!e.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";e=e.toLowerCase();for(var t=e.match(/.{1,4}/g),r=0;r<8;r++)t[r]=t[r].replace(/^0+/,""),""==t[r]&&(t[r]="0");e=":"+t.join(":")+":";var n=e.match(/:(0:){2,}/g);if(null===n)return e.slice(1,-1);for(var i="",r=0;r<n.length;r++)n[r].length>i.length&&(i=n[r]);return e=e.replace(i,"::"),e.slice(1,-1)}function Pr(e){var t="malformed hex value";if(!e.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw t;if(8!=e.length)return 32==e.length?Ar(e):e;try{return parseInt(e.substr(0,2),16)+"."+parseInt(e.substr(2,2),16)+"."+parseInt(e.substr(4,2),16)+"."+parseInt(e.substr(6,2),16)}catch(e){throw t}}function Cr(e){var t="malformed IP address";if(e=e.toLowerCase(e),!e.match(/^[0-9.]+$/)){if(e.match(/^[0-9a-f:]+$/)&&-1!==e.indexOf(":"))return xr(e);throw t}var r=e.split(".");if(4!==r.length)throw t;var n="";try{for(var i=0;i<4;i++)n+=("0"+parseInt(r[i]).toString(16)).slice(-2);return n}catch(e){throw t}}function kr(e){for(var t=encodeURIComponent(e),r="",n=0;n<t.length;n++)"%"==t[n]?(r+=t.substr(n,3),n+=2):r=r+"%"+Qt(t[n]);return r}function Rr(e){return e=e.replace(/\r\n/gm,"\n")}function Tr(e){return e=e.replace(/\r\n/gm,"\n"),e=e.replace(/\n/gm,"\r\n")}function Ir(e){return e.length%2==1?"0"+e:e.substr(0,1)>"7"?"00"+e:e}function Ur(e){e=e.replace(/^\s*\[\s*/,""),e=e.replace(/\s*\]\s*$/,""),e=e.replace(/\s*/g,"");try{return e.split(/,/).map(function(e,t,r){var n=parseInt(e);if(n<0||255<n)throw"integer not in range 0-255";return("00"+n.toString(16)).slice(-2)}).join("")}catch(e){throw"malformed integer array string: "+e}}function jr(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r+="0";return r+e}function Or(e,t,r){for(var n="",i=0;n.length<t;)n+=hr(r(lr(e+String.fromCharCode.apply(String,[(4278190080&i)>>24,(16711680&i)>>16,(65280&i)>>8,255&i])))),i+=1;return n}function Lr(e){for(var t in cn.crypto.Util.DIGESTINFOHEAD){var r=cn.crypto.Util.DIGESTINFOHEAD[t],n=r.length;if(e.substring(0,n)==r)return[t,e.substring(n)]}return[]}function Nr(){var e=un,t=e.getChildIdx,r=e.getV,n=e.getTLV,i=e.getVbyList,o=e.getTLVbyList,s=e.getIdxbyList,a=e.getVidx,u=e.oidname,c=Nr,h=vr;this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==o(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return i(this.hex,0,[0,1+this.foffset],"02")},this.getSignatureAlgorithmField=function(){return u(i(this.hex,0,[0,2+this.foffset,0],"06"))},this.getIssuerHex=function(){return o(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return c.hex2dn(this.getIssuerHex())},this.getSubjectHex=function(){return o(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return c.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var e=i(this.hex,0,[0,4+this.foffset,0]);return e=e.replace(/(..)/g,"%$1"),e=decodeURIComponent(e)},this.getNotAfter=function(){var e=i(this.hex,0,[0,4+this.foffset,1]);return e=e.replace(/(..)/g,"%$1"),e=decodeURIComponent(e)},this.getPublicKeyHex=function(){return e.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return s(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var e=this.getPublicKeyIdx();return s(this.hex,e,[1,0],"30")},this.getPublicKey=function(){return pn.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){return u(i(this.hex,0,[1,0],"06"))},this.getSignatureValueHex=function(){return i(this.hex,0,[2],"03",!0)},this.verifySignature=function(e){var t=this.getSignatureAlgorithmName(),r=this.getSignatureValueHex(),n=o(this.hex,0,[0],"30"),i=new cn.crypto.Signature({alg:t});return i.init(e),i.updateHex(n),i.verify(r)},this.parseExt=function(){if(3!==this.version)return-1;var r=s(this.hex,0,[0,7,0],"30"),n=t(this.hex,r);this.aExtInfo=new Array;for(var o=0;o<n.length;o++){var u={};u.critical=!1;var c=t(this.hex,n[o]),h=0;3===c.length&&(u.critical=!0,h=1),u.oid=e.hextooidstr(i(this.hex,n[o],[0],"06"));var l=s(this.hex,n[o],[1+h]);u.vidx=a(this.hex,l),this.aExtInfo.push(u)}},this.getExtInfo=function(e){var t=this.aExtInfo,r=e;if(e.match(/^[0-9.]+$/)||(r=cn.asn1.x509.OID.name2oid(e)),""!==r)for(var n=0;n<t.length;n++)if(t[n].oid===r)return t[n]},this.getExtBasicConstraints=function(){var e=this.getExtInfo("basicConstraints");if(void 0===e)return e;var t=r(this.hex,e.vidx);if(""===t)return{};if("0101ff"===t)return{cA:!0};if("0101ff02"===t.substr(0,8)){var n=r(t,6);return{cA:!0,pathLen:parseInt(n,16)}}throw"basicConstraints parse error"},this.getExtKeyUsageBin=function(){var e=this.getExtInfo("keyUsage");if(void 0===e)return"";var t=r(this.hex,e.vidx);if(t.length%2!=0||t.length<=2)throw"malformed key usage value";var n=parseInt(t.substr(0,2)),i=parseInt(t.substr(2),16).toString(2);return i.substr(0,i.length-n)},this.getExtKeyUsageString=function(){for(var e=this.getExtKeyUsageBin(),t=new Array,r=0;r<e.length;r++)"1"==e.substr(r,1)&&t.push(Nr.KEYUSAGE_NAME[r]);return t.join(",")},this.getExtSubjectKeyIdentifier=function(){var e=this.getExtInfo("subjectKeyIdentifier");return void 0===e?e:r(this.hex,e.vidx)},this.getExtAuthorityKeyIdentifier=function(){var e=this.getExtInfo("authorityKeyIdentifier");if(void 0===e)return e;for(var i={},o=n(this.hex,e.vidx),s=t(o,0),a=0;a<s.length;a++)"80"===o.substr(s[a],2)&&(i.kid=r(o,s[a]));return i},this.getExtExtKeyUsageName=function(){var e=this.getExtInfo("extKeyUsage");if(void 0===e)return e;var i=new Array,o=n(this.hex,e.vidx);if(""===o)return i;for(var s=t(o,0),a=0;a<s.length;a++)i.push(u(r(o,s[a])));return i},this.getExtSubjectAltName=function(){for(var e=this.getExtSubjectAltName2(),t=new Array,r=0;r<e.length;r++)"DNS"===e[r][0]&&t.push(e[r][1]);return t},this.getExtSubjectAltName2=function(){var e,i,o,s=this.getExtInfo("subjectAltName");if(void 0===s)return s;for(var a=new Array,u=n(this.hex,s.vidx),c=t(u,0),h=0;h<c.length;h++)o=u.substr(c[h],2),e=r(u,c[h]),"81"===o&&(i=cr(e),a.push(["MAIL",i])),"82"===o&&(i=cr(e),a.push(["DNS",i])),"84"===o&&(i=Nr.hex2dn(e,0),a.push(["DN",i])),"86"===o&&(i=cr(e),a.push(["URI",i])),"87"===o&&(i=Pr(e),a.push(["IP",i]));return a},this.getExtCRLDistributionPointsURI=function(){var e=this.getExtInfo("cRLDistributionPoints");if(void 0===e)return e;for(var r=new Array,n=t(this.hex,e.vidx),o=0;o<n.length;o++)try{var s=i(this.hex,n[o],[0,0,0],"86"),a=cr(s);r.push(a)}catch(e){}return r},this.getExtAIAInfo=function(){var e=this.getExtInfo("authorityInfoAccess");if(void 0===e)return e;for(var r={ocsp:[],caissuer:[]},n=t(this.hex,e.vidx),o=0;o<n.length;o++){var s=i(this.hex,n[o],[0],"06"),a=i(this.hex,n[o],[1],"86");"2b06010505073001"===s&&r.ocsp.push(cr(a)),"2b06010505073002"===s&&r.caissuer.push(cr(a))}return r},this.getExtCertificatePolicies=function(){var e=this.getExtInfo("certificatePolicies");if(void 0===e)return e;for(var o=n(this.hex,e.vidx),s=[],a=t(o,0),c=0;c<a.length;c++){var h={},l=t(o,a[c]);if(h.id=u(r(o,l[0])),2===l.length)for(var f=t(o,l[1]),p=0;p<f.length;p++){var d=i(o,f[p],[0],"06");"2b06010505070201"===d?h.cps=cr(i(o,f[p],[1])):"2b06010505070202"===d&&(h.unotice=cr(i(o,f[p],[1,0])))}s.push(h)}return s},this.readCertPEM=function(e){this.readCertHex(h(e))},this.readCertHex=function(e){this.hex=e,this.getVersion();try{s(this.hex,0,[0,7],"a3"),this.parseExt()}catch(e){}},this.getInfo=function(){var e,t,r;if(e="Basic Fields\n",e+="  serial number: "+this.getSerialNumberHex()+"\n",e+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",e+="  issuer: "+this.getIssuerString()+"\n",e+="  notBefore: "+this.getNotBefore()+"\n",e+="  notAfter: "+this.getNotAfter()+"\n",e+="  subject: "+this.getSubjectString()+"\n",e+="  subject public key info: \n",t=this.getPublicKey(),e+="    key algorithm: "+t.type+"\n","RSA"===t.type&&(e+="    n="+Ir(t.n.toString(16)).substr(0,16)+"...\n",e+="    e="+Ir(t.e.toString(16))+"\n"),void 0!==(r=this.aExtInfo)&&null!==r){e+="X509v3 Extensions:\n";for(var n=0;n<r.length;n++){var i=r[n],o=cn.asn1.x509.OID.oid2name(i.oid);""===o&&(o=i.oid);var s="";if(!0===i.critical&&(s="CRITICAL"),e+="  "+o+" "+s+":\n","basicConstraints"===o){var a=this.getExtBasicConstraints();void 0===a.cA?e+="    {}\n":(e+="    cA=true",void 0!==a.pathLen&&(e+=", pathLen="+a.pathLen),e+="\n")}else if("keyUsage"===o)e+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===o)e+="    "+this.getExtSubjectKeyIdentifier()+"\n";else if("authorityKeyIdentifier"===o){var u=this.getExtAuthorityKeyIdentifier();void 0!==u.kid&&(e+="    kid="+u.kid+"\n")}else if("extKeyUsage"===o){var c=this.getExtExtKeyUsageName();e+="    "+c.join(", ")+"\n"}else if("subjectAltName"===o){var h=this.getExtSubjectAltName2();e+="    "+h+"\n"}else if("cRLDistributionPoints"===o){var l=this.getExtCRLDistributionPointsURI();e+="    "+l+"\n"}else if("authorityInfoAccess"===o){var f=this.getExtAIAInfo();void 0!==f.ocsp&&(e+="    ocsp: "+f.ocsp.join(",")+"\n"),void 0!==f.caissuer&&(e+="    caissuer: "+f.caissuer.join(",")+"\n")}else if("certificatePolicies"===o)for(var p=this.getExtCertificatePolicies(),d=0;d<p.length;d++)void 0!==p[d].id&&(e+="    policy oid: "+p[d].id+"\n"),void 0!==p[d].cps&&(e+="    cps: "+p[d].cps+"\n")}}return e+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",e+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"}}var Dr="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return void 0===e?"undefined":o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":o(e)},Mr={};Mr.userAgent=!1;var Br={};if(void 0===Hr)var Hr={};Hr.lang={extend:function(e,t,r){if(!t||!e)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var n=function(){};if(n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.superclass=t.prototype,t.prototype.constructor==Object.prototype.constructor&&(t.prototype.constructor=t),r){var i;for(i in r)e.prototype[i]=r[i];var o=function(){},s=["toString","valueOf"];try{/MSIE/.test(Mr.userAgent)&&(o=function(e,t){for(i=0;i<s.length;i+=1){var r=s[i],n=t[r];"function"==typeof n&&n!=Object.prototype[r]&&(e[r]=n)}})}catch(e){}o(e.prototype,r)}}};var Kr=Kr||function(e,t){var r={},n=r.lib={},i=n.Base=function(){function e(){}return{extend:function(t){e.prototype=this;var r=new e;return t&&r.mixIn(t),r.hasOwnProperty("init")||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),o=n.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,r=e.words,n=this.sigBytes,i=e.sigBytes;if(this.clamp(),n%4)for(var o=0;o<i;o++){var s=r[o>>>2]>>>24-o%4*8&255;t[n+o>>>2]|=s<<24-(n+o)%4*8}else for(var o=0;o<i;o+=4)t[n+o>>>2]=r[o>>>2];return this.sigBytes+=i,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=i.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r=[],n=0;n<t;n+=4)r.push(4294967296*e.random()|0);return new o.init(r,t)}}),s=r.enc={},a=s.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new o.init(r,t/2)}},u=s.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,n=[],i=0;i<r;i++){var o=t[i>>>2]>>>24-i%4*8&255;n.push(String.fromCharCode(o))}return n.join("")},parse:function(e){for(var t=e.length,r=[],n=0;n<t;n++)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new o.init(r,t)}},c=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},h=n.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=c.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,n=r.words,i=r.sigBytes,s=this.blockSize,a=4*s,u=i/a;u=t?e.ceil(u):e.max((0|u)-this._minBufferSize,0);var c=u*s,h=e.min(4*c,i);if(c){for(var l=0;l<c;l+=s)this._doProcessBlock(n,l);var f=n.splice(0,c);r.sigBytes-=h}return new o.init(f,h)},clone:function(){var e=i.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),l=(n.Hasher=h.extend({cfg:i.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new l.HMAC.init(e,r).finalize(t)}}}),r.algo={});return r}(Math);!function(e){var t=Kr,r=t.lib,n=r.Base,i=r.WordArray,t=t.x64={};t.Word=n.extend({init:function(e,t){this.high=e,this.low=t}}),t.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=void 0!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],n=0;n<t;n++){var o=e[n];r.push(o.high),r.push(o.low)}return i.create(r,this.sigBytes)},clone:function(){for(var e=n.clone.call(this),t=e.words=this.words.slice(0),r=t.length,i=0;i<r;i++)t[i]=t[i].clone();return e}})}(),function(){var e=Kr,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,n=this._map;e.clamp(),e=[];for(var i=0;i<r;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;4>s&&i+.75*s<r;s++)e.push(n.charAt(o>>>6*(3-s)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var r=e.length,n=this._map,i=n.charAt(64);i&&-1!=(i=e.indexOf(i))&&(r=i);for(var i=[],o=0,s=0;s<r;s++)if(s%4){var a=n.indexOf(e.charAt(s-1))<<s%4*2,u=n.indexOf(e.charAt(s))>>>6-s%4*2;i[o>>>2]|=(a|u)<<24-o%4*8,o++}return t.create(i,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){for(var t=Kr,r=t.lib,n=r.WordArray,i=r.Hasher,r=t.algo,o=[],s=[],a=function(e){return 4294967296*(e-(0|e))|0},u=2,c=0;64>c;){var h;e:{h=u;for(var l=e.sqrt(h),f=2;f<=l;f++)if(!(h%f)){h=!1;break e}h=!0}h&&(8>c&&(o[c]=a(e.pow(u,.5))),s[c]=a(e.pow(u,1/3)),c++),u++}var p=[],r=r.SHA256=i.extend({_doReset:function(){this._hash=new n.init(o.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],a=r[3],u=r[4],c=r[5],h=r[6],l=r[7],f=0;64>f;f++){if(16>f)p[f]=0|e[t+f];else{var d=p[f-15],g=p[f-2];p[f]=((d<<25|d>>>7)^(d<<14|d>>>18)^d>>>3)+p[f-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+p[f-16]}d=l+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&c^~u&h)+s[f]+p[f],g=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&i^n&o^i&o),l=h,h=c,c=u,u=a+d|0,a=o,o=i,i=n,n=d+g|0}r[0]=r[0]+n|0,r[1]=r[1]+i|0,r[2]=r[2]+o|0,r[3]=r[3]+a|0,r[4]=r[4]+u|0,r[5]=r[5]+c|0,r[6]=r[6]+h|0,r[7]=r[7]+l|0},_doFinalize:function(){var t=this._data,r=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=e.floor(n/4294967296),r[15+(i+64>>>9<<4)]=n,t.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(r),t.HmacSHA256=i._createHmacHelper(r)}(Math),function(){function e(){return i.create.apply(i,arguments)}for(var t=Kr,r=t.lib.Hasher,n=t.x64,i=n.Word,o=n.WordArray,n=t.algo,s=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],a=[],u=0;80>u;u++)a[u]=e();n=n.SHA512=r.extend({_doReset:function(){this._hash=new o.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=this._hash.words,n=r[0],i=r[1],o=r[2],u=r[3],c=r[4],h=r[5],l=r[6],r=r[7],f=n.high,p=n.low,d=i.high,g=i.low,v=o.high,y=o.low,m=u.high,S=u.low,_=c.high,F=c.low,b=h.high,w=h.low,E=l.high,x=l.low,A=r.high,P=r.low,C=f,k=p,R=d,T=g,I=v,U=y,j=m,O=S,L=_,N=F,D=b,M=w,B=E,H=x,K=A,q=P,V=0;80>V;V++){var W=a[V];if(16>V)var J=W.high=0|e[t+2*V],Y=W.low=0|e[t+2*V+1];else{var J=a[V-15],Y=J.high,G=J.low,J=(Y>>>1|G<<31)^(Y>>>8|G<<24)^Y>>>7,G=(G>>>1|Y<<31)^(G>>>8|Y<<24)^(G>>>7|Y<<25),z=a[V-2],Y=z.high,X=z.low,z=(Y>>>19|X<<13)^(Y<<3|X>>>29)^Y>>>6,X=(X>>>19|Y<<13)^(X<<3|Y>>>29)^(X>>>6|Y<<26),Y=a[V-7],Z=Y.high,Q=a[V-16],$=Q.high,Q=Q.low,Y=G+Y.low,J=J+Z+(Y>>>0<G>>>0?1:0),Y=Y+X,J=J+z+(Y>>>0<X>>>0?1:0),Y=Y+Q,J=J+$+(Y>>>0<Q>>>0?1:0);W.high=J,W.low=Y}var Z=L&D^~L&B,Q=N&M^~N&H,W=C&R^C&I^R&I,ee=k&T^k&U^T&U,G=(C>>>28|k<<4)^(C<<30|k>>>2)^(C<<25|k>>>7),z=(k>>>28|C<<4)^(k<<30|C>>>2)^(k<<25|C>>>7),X=s[V],te=X.high,re=X.low,X=q+((N>>>14|L<<18)^(N>>>18|L<<14)^(N<<23|L>>>9)),$=K+((L>>>14|N<<18)^(L>>>18|N<<14)^(L<<23|N>>>9))+(X>>>0<q>>>0?1:0),X=X+Q,$=$+Z+(X>>>0<Q>>>0?1:0),X=X+re,$=$+te+(X>>>0<re>>>0?1:0),X=X+Y,$=$+J+(X>>>0<Y>>>0?1:0),Y=z+ee,W=G+W+(Y>>>0<z>>>0?1:0),K=B,q=H,B=D,H=M,D=L,M=N,N=O+X|0,L=j+$+(N>>>0<O>>>0?1:0)|0,j=I,O=U,I=R,U=T,R=C,T=k,k=X+Y|0,C=$+W+(k>>>0<X>>>0?1:0)|0}p=n.low=p+k,n.high=f+C+(p>>>0<k>>>0?1:0),g=i.low=g+T,i.high=d+R+(g>>>0<T>>>0?1:0),y=o.low=y+U,o.high=v+I+(y>>>0<U>>>0?1:0),S=u.low=S+O,u.high=m+j+(S>>>0<O>>>0?1:0),F=c.low=F+N,c.high=_+L+(F>>>0<N>>>0?1:0),w=h.low=w+M,h.high=b+D+(w>>>0<M>>>0?1:0),x=l.low=x+H,l.high=E+B+(x>>>0<H>>>0?1:0),P=r.low=P+q,r.high=A+K+(P>>>0<q>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;return t[n>>>5]|=128<<24-n%32,t[30+(n+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(n+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32}),t.SHA512=r._createHelper(n),t.HmacSHA512=r._createHmacHelper(n)}(),function(){var e=Kr,t=e.x64,r=t.Word,n=t.WordArray,t=e.algo,i=t.SHA512,t=t.SHA384=i.extend({_doReset:function(){this._hash=new n.init([new r.init(3418070365,3238371032),new r.init(1654270250,914150663),new r.init(2438529370,812702999),new r.init(355462360,4144912697),new r.init(1731405415,4290775857),new r.init(2394180231,1750603025),new r.init(3675008525,1694076839),new r.init(1203062813,3204075428)])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=i._createHelper(t),e.HmacSHA384=i._createHmacHelper(t)}();var qr,Vr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Wr="=";"Microsoft Internet Explorer"==Mr.appName?(s.prototype.am=c,qr=30):"Netscape"!=Mr.appName?(s.prototype.am=u,qr=26):(s.prototype.am=h,qr=28),s.prototype.DB=qr,s.prototype.DM=(1<<qr)-1,s.prototype.DV=1<<qr,s.prototype.FV=Math.pow(2,52),s.prototype.F1=52-qr,s.prototype.F2=2*qr-52;var Jr,Yr,Gr="0123456789abcdefghijklmnopqrstuvwxyz",zr=new Array;for(Jr="0".charCodeAt(0),Yr=0;Yr<=9;++Yr)zr[Jr++]=Yr;for(Jr="a".charCodeAt(0),Yr=10;Yr<36;++Yr)zr[Jr++]=Yr;for(Jr="A".charCodeAt(0),Yr=10;Yr<36;++Yr)zr[Jr++]=Yr;U.prototype.convert=j,U.prototype.revert=O,U.prototype.reduce=L,U.prototype.mulTo=N,U.prototype.sqrTo=D,B.prototype.convert=H,B.prototype.revert=K,B.prototype.reduce=q,B.prototype.mulTo=W,B.prototype.sqrTo=V,s.prototype.copyTo=p,s.prototype.fromInt=d,s.prototype.fromString=v,s.prototype.clamp=y,s.prototype.dlShiftTo=E,s.prototype.drShiftTo=x,s.prototype.lShiftTo=A,s.prototype.rShiftTo=P,s.prototype.subTo=C,s.prototype.multiplyTo=k,s.prototype.squareTo=R,s.prototype.divRemTo=T,s.prototype.invDigit=M,s.prototype.isEven=J,s.prototype.exp=Y,s.prototype.toString=m,s.prototype.negate=S,s.prototype.abs=_,s.prototype.compareTo=F,s.prototype.bitLength=w,s.prototype.mod=I,s.prototype.modPowInt=G,s.ZERO=g(0),s.ONE=g(1),Me.prototype.convert=Be,Me.prototype.revert=Be,Me.prototype.mulTo=He,Me.prototype.sqrTo=Ke,Je.prototype.convert=Ye,Je.prototype.revert=Ge,Je.prototype.reduce=ze,Je.prototype.mulTo=Ze,Je.prototype.sqrTo=Xe;var Xr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Zr=(1<<26)/Xr[Xr.length-1];s.prototype.chunkSize=$,s.prototype.toRadix=te,s.prototype.fromRadix=re,s.prototype.fromNumber=ne,s.prototype.bitwiseTo=ue,s.prototype.changeBit=xe,s.prototype.addTo=ke,s.prototype.dMultiply=Ne,s.prototype.dAddOffset=De,s.prototype.multiplyLowerTo=Ve,s.prototype.multiplyUpperTo=We,s.prototype.modInt=et,s.prototype.millerRabin=nt,s.prototype.clone=z,s.prototype.intValue=X,s.prototype.byteValue=Z,s.prototype.shortValue=Q,s.prototype.signum=ee,s.prototype.toByteArray=ie,s.prototype.equals=oe,s.prototype.min=se,s.prototype.max=ae,s.prototype.and=he,s.prototype.or=fe,s.prototype.xor=de,s.prototype.andNot=ve,s.prototype.not=ye,s.prototype.shiftLeft=me,s.prototype.shiftRight=Se,s.prototype.getLowestSetBit=Fe,s.prototype.bitCount=we,s.prototype.testBit=Ee,s.prototype.setBit=Ae,s.prototype.clearBit=Pe,s.prototype.flipBit=Ce,s.prototype.add=Re,s.prototype.subtract=Te,s.prototype.multiply=Ie,s.prototype.divide=je,s.prototype.remainder=Oe,s.prototype.divideAndRemainder=Le,s.prototype.modPow=Qe,s.prototype.modInverse=tt,s.prototype.pow=qe,s.prototype.gcd=$e,s.prototype.isProbablePrime=rt,s.prototype.square=Ue,it.prototype.init=ot,it.prototype.next=st;var Qr,$r,en,tn=256;if(null==$r){$r=new Array,en=0;var rn;if(void 0!==Br&&(void 0!==Br.crypto||void 0!==Br.msCrypto)){var nn=Br.crypto||Br.msCrypto;if(nn.getRandomValues){var on=new Uint8Array(32);for(nn.getRandomValues(on),rn=0;rn<32;++rn)$r[en++]=on[rn]}else if("Netscape"==Mr.appName&&Mr.appVersion<"5"){var sn=Br.crypto.random(32);for(rn=0;rn<sn.length;++rn)$r[en++]=255&sn.charCodeAt(rn)}}for(;en<tn;)rn=Math.floor(65536*Math.random()),$r[en++]=rn>>>8,$r[en++]=255&rn;en=0,ct()}ft.prototype.nextBytes=lt,yt.prototype.doPublic=St,yt.prototype.setPublic=mt,yt.prototype.encrypt=_t,yt.prototype.encryptOAEP=Ft,yt.prototype.type="RSA",bt.prototype.equals=wt,bt.prototype.toBigInteger=Et,bt.prototype.negate=xt,bt.prototype.add=At,bt.prototype.subtract=Pt,bt.prototype.multiply=Ct,bt.prototype.square=kt,bt.prototype.divide=Rt,Tt.prototype.getX=It,Tt.prototype.getY=Ut,Tt.prototype.equals=jt,Tt.prototype.isInfinity=Ot,Tt.prototype.negate=Lt,Tt.prototype.add=Nt,Tt.prototype.twice=Dt,Tt.prototype.multiply=Mt,Tt.prototype.multiplyTwo=Bt,Ht.prototype.getQ=Kt,Ht.prototype.getA=qt,Ht.prototype.getB=Vt,Ht.prototype.equals=Wt,Ht.prototype.getInfinity=Jt,Ht.prototype.fromBigInteger=Yt,Ht.prototype.decodePointHex=Gt;var an=function(){function e(e,t,r){return t?n[t]:String.fromCharCode(parseInt(r,16))}var t=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),r=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),n={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},i=new String(""),o=(Object,Array,Object.hasOwnProperty);return function(n,s){var a,u=n.match(t),c=u[0],h=!1;"{"===c?a={}:"["===c?a=[]:(a=[],h=!0);for(var l,f=[a],p=1-h,d=u.length;p<d;++p){c=u[p];var g;switch(c.charCodeAt(0)){default:g=f[0],g[l||g.length]=+c,l=void 0;break;case 34:if(c=c.substring(1,c.length-1),-1!==c.indexOf("\\")&&(c=c.replace(r,e)),g=f[0],!l){if(!(g instanceof Array)){l=c||i;break}l=g.length}g[l]=c,l=void 0;break;case 91:g=f[0],f.unshift(g[l||g.length]=[]),l=void 0;break;case 93:f.shift();break;case 102:g=f[0],g[l||g.length]=!1,l=void 0;break;case 110:g=f[0],g[l||g.length]=null,l=void 0;break;case 116:g=f[0],g[l||g.length]=!0,l=void 0;break;case 123:g=f[0],f.unshift(g[l||g.length]={}),l=void 0;break;case 125:f.shift()}}if(h){if(1!==f.length)throw new Error;a=a[0]}else if(f.length)throw new Error;return s&&(a=function e(t,r){var n=t[r];if(n&&"object"===(void 0===n?"undefined":Dr(n))){var i=null;for(var a in n)if(o.call(n,a)&&n!==t){var u=e(n,a);void 0!==u?n[a]=u:(i||(i=[]),i.push(a))}if(i)for(var c=i.length;--c>=0;)delete n[i[c]]}return s.call(t,r,n)}({"":a},"")),a}}(),un=new function(){};un.getLblen=function(e,t){if("8"!=e.substr(t+2,1))return 1;var r=parseInt(e.substr(t+3,1));return 0==r?-1:0<r&&r<10?r+1:-2},un.getL=function(e,t){var r=un.getLblen(e,t);return r<1?"":e.substr(t+2,2*r)},un.getVblen=function(e,t){var r,n;return""==(r=un.getL(e,t))?-1:(n="8"===r.substr(0,1)?new s(r.substr(2),16):new s(r,16),n.intValue())},un.getVidx=function(e,t){var r=un.getLblen(e,t);return r<0?r:t+2*(r+1)},un.getV=function(e,t){var r=un.getVidx(e,t),n=un.getVblen(e,t);return e.substr(r,2*n)},un.getTLV=function(e,t){return e.substr(t,2)+un.getL(e,t)+un.getV(e,t)},un.getNextSiblingIdx=function(e,t){return un.getVidx(e,t)+2*un.getVblen(e,t)},un.getChildIdx=function(e,t){var r=un,n=new Array,i=r.getVidx(e,t);"03"==e.substr(t,2)?n.push(i+2):n.push(i);for(var o=r.getVblen(e,t),s=i,a=0;;){var u=r.getNextSiblingIdx(e,s);if(null==u||u-i>=2*o)break;if(a>=200)break;n.push(u),s=u,a++}return n},un.getNthChildIdx=function(e,t,r){return un.getChildIdx(e,t)[r]},un.getIdxbyList=function(e,t,r,n){var i,o,s=un;if(0==r.length){if(void 0!==n&&e.substr(t,2)!==n)throw"checking tag doesn't match: "+e.substr(t,2)+"!="+n;return t}return i=r.shift(),o=s.getChildIdx(e,t),s.getIdxbyList(e,o[i],r,n)},un.getTLVbyList=function(e,t,r,n){var i=un,o=i.getIdxbyList(e,t,r);if(void 0===o)throw"can't find nthList object";if(void 0!==n&&e.substr(o,2)!=n)throw"checking tag doesn't match: "+e.substr(o,2)+"!="+n;return i.getTLV(e,o)},un.getVbyList=function(e,t,r,n,i){var o,s,a=un;if(void 0===(o=a.getIdxbyList(e,t,r,n)))throw"can't find nthList object";return s=a.getV(e,o),!0===i&&(s=s.substr(2)),s},un.hextooidstr=function(e){var t=function(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e},r=[],n=e.substr(0,2),i=parseInt(n,16);r[0]=new String(Math.floor(i/40)),r[1]=new String(i%40);for(var o=e.substr(2),s=[],a=0;a<o.length/2;a++)s.push(parseInt(o.substr(2*a,2),16));for(var u=[],c="",a=0;a<s.length;a++)128&s[a]?c+=t((127&s[a]).toString(2),7):(c+=t((127&s[a]).toString(2),7),u.push(new String(parseInt(c,2))),c="");var h=r.join(".");return u.length>0&&(h=h+"."+u.join(".")),h},un.dump=function(e,t,r,n){var i=un,o=i.getV,s=i.dump,a=i.getChildIdx,u=e;e instanceof cn.asn1.ASN1Object&&(u=e.getEncodedHex());var c=function(e,t){return e.length<=2*t?e:e.substr(0,t)+"..(total "+e.length/2+"bytes).."+e.substr(e.length-t,t)};void 0===t&&(t={ommit_long_octet:32}),void 0===r&&(r=0),void 0===n&&(n="");var h=t.ommit_long_octet;if("01"==u.substr(r,2)){var l=o(u,r);return"00"==l?n+"BOOLEAN FALSE\n":n+"BOOLEAN TRUE\n"}if("02"==u.substr(r,2)){var l=o(u,r);return n+"INTEGER "+c(l,h)+"\n"}if("03"==u.substr(r,2)){var l=o(u,r);return n+"BITSTRING "+c(l,h)+"\n"}if("04"==u.substr(r,2)){var l=o(u,r);if(i.isASN1HEX(l)){var f=n+"OCTETSTRING, encapsulates\n";return f+=s(l,t,0,n+"  ")}return n+"OCTETSTRING "+c(l,h)+"\n"}if("05"==u.substr(r,2))return n+"NULL\n";if("06"==u.substr(r,2)){var p=o(u,r),d=cn.asn1.ASN1Util.oidHexToInt(p),g=cn.asn1.x509.OID.oid2name(d),v=d.replace(/\./g," ");return""!=g?n+"ObjectIdentifier "+g+" ("+v+")\n":n+"ObjectIdentifier ("+v+")\n"}if("0c"==u.substr(r,2))return n+"UTF8String '"+cr(o(u,r))+"'\n";if("13"==u.substr(r,2))return n+"PrintableString '"+cr(o(u,r))+"'\n";if("14"==u.substr(r,2))return n+"TeletexString '"+cr(o(u,r))+"'\n";if("16"==u.substr(r,2))return n+"IA5String '"+cr(o(u,r))+"'\n";if("17"==u.substr(r,2))return n+"UTCTime "+cr(o(u,r))+"\n";if("18"==u.substr(r,2))return n+"GeneralizedTime "+cr(o(u,r))+"\n";if("30"==u.substr(r,2)){if("3000"==u.substr(r,4))return n+"SEQUENCE {}\n";var f=n+"SEQUENCE\n",y=a(u,r),m=t;if((2==y.length||3==y.length)&&"06"==u.substr(y[0],2)&&"04"==u.substr(y[y.length-1],2)){var g=i.oidname(o(u,y[0])),S=JSON.parse(JSON.stringify(t));S.x509ExtName=g,m=S}for(var _=0;_<y.length;_++)f+=s(u,m,y[_],n+"  ");return f}if("31"==u.substr(r,2)){for(var f=n+"SET\n",y=a(u,r),_=0;_<y.length;_++)f+=s(u,t,y[_],n+"  ");return f}var F=parseInt(u.substr(r,2),16);if(0!=(128&F)){var b=31&F;if(0!=(32&F)){for(var f=n+"["+b+"]\n",y=a(u,r),_=0;_<y.length;_++)f+=s(u,t,y[_],n+"  ");return f}var l=o(u,r);"68747470"==l.substr(0,8)&&(l=cr(l)),"subjectAltName"===t.x509ExtName&&2==b&&(l=cr(l));var f=n+"["+b+"] "+l+"\n";return f}return n+"UNKNOWN("+u.substr(r,2)+") "+o(u,r)+"\n"},un.isASN1HEX=function(e){var t=un;if(e.length%2==1)return!1;var r=t.getVblen(e,0),n=e.substr(0,2),i=t.getL(e,0);return e.length-n.length-i.length==2*r},un.oidname=function(e){var t=cn.asn1;cn.lang.String.isHex(e)&&(e=t.ASN1Util.oidHexToInt(e));var r=t.x509.OID.oid2name(e);return""===r&&(r=e),r};var cn;void 0!==cn&&cn||(cn={}),void 0!==cn.lang&&cn.lang||(cn.lang={}),cn.lang.String=function(){};var hn,ln;"function"==typeof e?(hn=function(t){return rr(new e(t,"utf8").toString("base64"))},ln=function(t){return new e(nr(t),"base64").toString("utf8")}):(hn=function(e){return ir(wr(kr(e)))},ln=function(e){return decodeURIComponent(Er(or(e)))}),cn.lang.String.isInteger=function(e){return!!e.match(/^[0-9]+$/)||!!e.match(/^-[0-9]+$/)},cn.lang.String.isHex=function(e){return!(e.length%2!=0||!e.match(/^[0-9a-f]+$/)&&!e.match(/^[0-9A-F]+$/))},cn.lang.String.isBase64=function(e){return e=e.replace(/\s+/g,""),!(!e.match(/^[0-9A-Za-z+\/]+={0,3}$/)||e.length%4!=0)},cn.lang.String.isBase64URL=function(e){return!e.match(/[+\/=]/)&&(e=nr(e),cn.lang.String.isBase64(e))},cn.lang.String.isIntegerArray=function(e){return e=e.replace(/\s+/g,""),!!e.match(/^\[[0-9,]+\]$/)};var fn=function(e,t){var r=e.length;e.length>t.length&&(r=t.length);for(var n=0;n<r;n++)if(e.charCodeAt(n)!=t.charCodeAt(n))return n;return e.length!=t.length?r:-1};void 0!==cn&&cn||(cn={}),void 0!==cn.crypto&&cn.crypto||(cn.crypto={}),cn.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:Kr.algo.MD5,sha1:Kr.algo.SHA1,sha224:Kr.algo.SHA224,sha256:Kr.algo.SHA256,sha384:Kr.algo.SHA384,sha512:Kr.algo.SHA512,ripemd160:Kr.algo.RIPEMD160},this.getDigestInfoHex=function(e,t){if(void 0===this.DIGESTINFOHEAD[t])throw"alg not supported in Util.DIGESTINFOHEAD: "+t;return this.DIGESTINFOHEAD[t]+e},this.getPaddedDigestInfoHex=function(e,t,r){var n=this.getDigestInfoHex(e,t),i=r/4;if(n.length+22>i)throw"key is too short for SigAlg: keylen="+r+","+t;for(var o="0001",s="00"+n,a="",u=i-o.length-s.length,c=0;c<u;c+=2)a+="ff";return o+a+s},this.hashString=function(e,t){return new cn.crypto.MessageDigest({alg:t}).digestString(e)},this.hashHex=function(e,t){return new cn.crypto.MessageDigest({alg:t}).digestHex(e)},this.sha1=function(e){return new cn.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(e)},this.sha256=function(e){return new cn.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(e)},this.sha256Hex=function(e){return new cn.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(e)},this.sha512=function(e){return new cn.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(e)},this.sha512Hex=function(e){return new cn.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(e)}},cn.crypto.Util.md5=function(e){return new cn.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(e)},cn.crypto.Util.ripemd160=function(e){return new cn.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(e)},cn.crypto.Util.SECURERANDOMGEN=new ft,cn.crypto.Util.getRandomHexOfNbytes=function(e){var t=new Array(e);return cn.crypto.Util.SECURERANDOMGEN.nextBytes(t),Zt(t)},cn.crypto.Util.getRandomBigIntegerOfNbytes=function(e){return new s(cn.crypto.Util.getRandomHexOfNbytes(e),16)},cn.crypto.Util.getRandomHexOfNbits=function(e){var t=e%8,r=(e-t)/8,n=new Array(r+1);return cn.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<t&255^255)&n[0],Zt(n)},cn.crypto.Util.getRandomBigIntegerOfNbits=function(e){return new s(cn.crypto.Util.getRandomHexOfNbits(e),16)},cn.crypto.Util.getRandomBigIntegerZeroToMax=function(e){for(var t=e.bitLength();;){var r=cn.crypto.Util.getRandomBigIntegerOfNbits(t);if(-1!=e.compareTo(r))return r}},cn.crypto.Util.getRandomBigIntegerMinToMax=function(e,t){var r=e.compareTo(t);if(1==r)throw"biMin is greater than biMax";if(0==r)return e;var n=t.subtract(e);return cn.crypto.Util.getRandomBigIntegerZeroToMax(n).add(e)},cn.crypto.MessageDigest=function(e){this.setAlgAndProvider=function(e,t){if(e=cn.crypto.MessageDigest.getCanonicalAlgName(e),null!==e&&void 0===t&&(t=cn.crypto.Util.DEFAULTPROVIDER[e]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(e)&&"cryptojs"==t){try{this.md=cn.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[e].create()}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=Kr.enc.Hex.parse(e);this.md.update(t)},this.digest=function(){return this.md.finalize().toString(Kr.enc.Hex)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}if(-1!=":sha256:".indexOf(e)&&"sjcl"==t){try{this.md=new sjcl.hash.sha256}catch(t){throw"setAlgAndProvider hash alg set fail alg="+e+"/"+t}this.updateString=function(e){this.md.update(e)},this.updateHex=function(e){var t=sjcl.codec.hex.toBits(e);this.md.update(t)},this.digest=function(){var e=this.md.finalize();return sjcl.codec.hex.fromBits(e)},this.digestString=function(e){return this.updateString(e),this.digest()},this.digestHex=function(e){return this.updateHex(e),this.digest()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==e&&void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=cn.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},cn.crypto.MessageDigest.getCanonicalAlgName=function(e){return"string"==typeof e&&(e=e.toLowerCase(),e=e.replace(/-/,"")),e},cn.crypto.MessageDigest.getHashLength=function(e){var t=cn.crypto.MessageDigest,r=t.getCanonicalAlgName(e);if(void 0===t.HASHLENGTH[r])throw"not supported algorithm: "+e;return t.HASHLENGTH[r]},cn.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},cn.crypto.Mac=function(e){this.setAlgAndProvider=function(e,t){if(e=e.toLowerCase(),null==e&&(e="hmacsha1"),e=e.toLowerCase(),"hmac"!=e.substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+e;void 0===t&&(t=cn.crypto.Util.DEFAULTPROVIDER[e]),this.algProv=e+"/"+t;var r=e.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(r)&&"cryptojs"==t){try{var n=cn.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[r];this.mac=Kr.algo.HMAC.create(n,this.pass)}catch(e){throw"setAlgAndProvider hash alg set fail hashAlg="+r+"/"+e}this.updateString=function(e){this.mac.update(e)},this.updateHex=function(e){var t=Kr.enc.Hex.parse(e);this.mac.update(t)},this.doFinal=function(){return this.mac.finalize().toString(Kr.enc.Hex)},this.doFinalString=function(e){return this.updateString(e),this.doFinal()},this.doFinalHex=function(e){return this.updateHex(e),this.doFinal()}}},this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(e){if("string"==typeof e){var t=e;return e.length%2!=1&&e.match(/^[0-9A-Fa-f]+$/)||(t=lr(e)),void(this.pass=Kr.enc.Hex.parse(t))}if("object"!=(void 0===e?"undefined":Dr(e)))throw"KJUR.crypto.Mac unsupported password type: "+e;var t=null;if(void 0!==e.hex){if(e.hex.length%2!=0||!e.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+e.hex;t=e.hex}if(void 0!==e.utf8&&(t=ur(e.utf8)),void 0!==e.rstr&&(t=lr(e.rstr)),void 0!==e.b64&&(t=n(e.b64)),void 0!==e.b64u&&(t=or(e.b64u)),null==t)throw"KJUR.crypto.Mac unsupported password type: "+e;this.pass=Kr.enc.Hex.parse(t)},void 0!==e&&(void 0!==e.pass&&this.setPassword(e.pass),void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov&&(this.provName=cn.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},cn.crypto.Signature=function(e){if(this._setAlgNames=function(){var e=this.algName.match(/^(.+)with(.+)$/);e&&(this.mdAlgName=e[1].toLowerCase(),this.pubkeyAlgName=e[2].toLowerCase())},this._zeroPaddingOfSignature=function(e,t){for(var r="",n=t/4-e.length,i=0;i<n;i++)r+="0";return r+e},this.setAlgAndProvider=function(e,t){if(this._setAlgNames(),"cryptojs/jsrsa"!=t)throw"provider not supported: "+t;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new cn.crypto.MessageDigest({alg:this.mdAlgName})}catch(e){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+e}this.init=function(e,t){var r=null;try{r=void 0===t?pn.getKey(e):pn.getKey(e,t)}catch(e){throw"init failed:"+e}if(!0===r.isPrivate)this.prvKey=r,this.state="SIGN";else{if(!0!==r.isPublic)throw"init failed.:"+r;this.pubKey=r,this.state="VERIFY"}},this.updateString=function(e){this.md.updateString(e)},this.updateHex=function(e){this.md.updateHex(e)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0!==this.ecprvhex&&void 0!==this.eccurvename){var e=new cn.crypto.ECDSA({curve:this.eccurvename});this.hSign=e.signHex(this.sHashHex,this.ecprvhex)}else if(this.prvKey instanceof yt&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof yt&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof cn.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof cn.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(e){return this.updateString(e),this.sign()},this.signHex=function(e){return this.updateHex(e),this.sign()},this.verify=function(e){if(this.sHashHex=this.md.digest(),void 0!==this.ecpubhex&&void 0!==this.eccurvename)return new cn.crypto.ECDSA({curve:this.eccurvename}).verifyHex(this.sHashHex,e,this.ecpubhex);if(this.pubKey instanceof yt&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,e,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof yt&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==cn.crypto.ECDSA&&this.pubKey instanceof cn.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);if(void 0!==cn.crypto.DSA&&this.pubKey instanceof cn.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,e);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(e,t){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(e){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(e){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(e){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(e){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(e){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=e,void 0!==e&&(void 0!==e.alg&&(this.algName=e.alg,void 0===e.prov?this.provName=cn.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=e.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==e.psssaltlen&&(this.pssSaltLen=e.psssaltlen),void 0!==e.prvkeypem)){if(void 0!==e.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{pn.getKey(e.prvkeypem),this.init(null)}catch(e){throw"fatal error to load pem private key: "+e}}},cn.crypto.Cipher=function(e){},cn.crypto.Cipher.encrypt=function(e,t,r){if(t instanceof yt&&t.isPublic){var n=cn.crypto.Cipher.getAlgByKeyAndName(t,r);if("RSA"===n)return t.encrypt(e);if("RSAOAEP"===n)return t.encryptOAEP(e,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return t.encryptOAEP(e,"sha"+i[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.encrypt: unsupported key or algorithm"},cn.crypto.Cipher.decrypt=function(e,t,r){if(t instanceof yt&&t.isPrivate){var n=cn.crypto.Cipher.getAlgByKeyAndName(t,r);if("RSA"===n)return t.decrypt(e);if("RSAOAEP"===n)return t.decryptOAEP(e,"sha1");var i=n.match(/^RSAOAEP(\d+)$/);if(null!==i)return t.decryptOAEP(e,"sha"+i[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+r}throw"Cipher.decrypt: unsupported key or algorithm"},cn.crypto.Cipher.getAlgByKeyAndName=function(e,t){if(e instanceof yt){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(t))return t;if(null===t||void 0===t)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+t}throw"getAlgByKeyAndName: not supported algorithm name: "+t},cn.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==cn&&cn||(cn={}),void 0!==cn.crypto&&cn.crypto||(cn.crypto={}),cn.crypto.ECDSA=function(e){var t=new ft;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(e){return new s(e.bitLength(),t).mod(e.subtract(s.ONE)).add(s.ONE)},this.setNamedCurve=function(e){this.ecparams=cn.crypto.ECParameterDB.getByName(e),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=e},this.setPrivateKeyHex=function(e){this.isPrivate=!0,this.prvKeyHex=e},this.setPublicKeyHex=function(e){this.isPublic=!0,this.pubKeyHex=e},this.getPublicKeyXYHex=function(){var e=this.pubKeyHex;if("04"!==e.substr(0,2))throw"this method supports uncompressed format(04) only";var t=this.ecparams.keylen/4;if(e.length!==2+2*t)throw"malformed public key hex length";var r={};return r.x=e.substr(2,t),r.y=e.substr(2+t),r},this.getShortNISTPCurveName=function(){var e=this.curveName;return"secp256r1"===e||"NIST P-256"===e||"P-256"===e||"prime256v1"===e?"P-256":"secp384r1"===e||"NIST P-384"===e||"P-384"===e?"P-384":null},this.generateKeyPairHex=function(){var e=this.ecparams.n,t=this.getBigRandom(e),r=this.ecparams.G.multiply(t),n=r.getX().toBigInteger(),i=r.getY().toBigInteger(),o=this.ecparams.keylen/4,s=("0000000000"+t.toString(16)).slice(-o),a=("0000000000"+n.toString(16)).slice(-o),u=("0000000000"+i.toString(16)).slice(-o),c="04"+a+u;return this.setPrivateKeyHex(s),this.setPublicKeyHex(c),{ecprvhex:s,ecpubhex:c}},this.signWithMessageHash=function(e){return this.signHex(e,this.prvKeyHex)},this.signHex=function(e,t){var r=new s(t,16),n=this.ecparams.n,i=new s(e,16);do{var o=this.getBigRandom(n),a=this.ecparams.G,u=a.multiply(o),c=u.getX().toBigInteger().mod(n)}while(c.compareTo(s.ZERO)<=0);var h=o.modInverse(n).multiply(i.add(r.multiply(c))).mod(n);return cn.crypto.ECDSA.biRSSigToASN1Sig(c,h)},this.sign=function(e,t){var r=t,n=this.ecparams.n,i=s.fromByteArrayUnsigned(e);do{var o=this.getBigRandom(n),a=this.ecparams.G,u=a.multiply(o),c=u.getX().toBigInteger().mod(n)}while(c.compareTo(s.ZERO)<=0);var h=o.modInverse(n).multiply(i.add(r.multiply(c))).mod(n);return this.serializeSig(c,h)},this.verifyWithMessageHash=function(e,t){return this.verifyHex(e,t,this.pubKeyHex)},this.verifyHex=function(e,t,r){var n,i,o=cn.crypto.ECDSA.parseSigHex(t);n=o.r,i=o.s;var a;a=Tt.decodeFromHex(this.ecparams.curve,r);var u=new s(e,16);return this.verifyRaw(u,n,i,a)},this.verify=function(e,t,r){var n,i;if(Bitcoin.Util.isArray(t)){var o=this.parseSig(t);n=o.r,i=o.s}else{if("object"!==(void 0===t?"undefined":Dr(t))||!t.r||!t.s)throw"Invalid value for signature";n=t.r,i=t.s}var a;if(r instanceof Tt)a=r;else{if(!Bitcoin.Util.isArray(r))throw"Invalid format for pubkey value, must be byte array or ECPointFp";a=Tt.decodeFrom(this.ecparams.curve,r)}var u=s.fromByteArrayUnsigned(e);return this.verifyRaw(u,n,i,a)},this.verifyRaw=function(e,t,r,n){var i=this.ecparams.n,o=this.ecparams.G;if(t.compareTo(s.ONE)<0||t.compareTo(i)>=0)return!1;if(r.compareTo(s.ONE)<0||r.compareTo(i)>=0)return!1;var a=r.modInverse(i),u=e.multiply(a).mod(i),c=t.multiply(a).mod(i);return o.multiply(u).add(n.multiply(c)).getX().toBigInteger().mod(i).equals(t)},this.serializeSig=function(e,t){var r=e.toByteArraySigned(),n=t.toByteArraySigned(),i=[];return i.push(2),i.push(r.length),i=i.concat(r),i.push(2),i.push(n.length),i=i.concat(n),i.unshift(i.length),i.unshift(48),i},this.parseSig=function(e){var t;if(48!=e[0])throw new Error("Signature not a valid DERSequence");if(t=2,2!=e[t])throw new Error("First element in signature must be a DERInteger");var r=e.slice(t+2,t+2+e[t+1]);if(t+=2+e[t+1],2!=e[t])throw new Error("Second element in signature must be a DERInteger");var n=e.slice(t+2,t+2+e[t+1]);return t+=2+e[t+1],{r:s.fromByteArrayUnsigned(r),s:s.fromByteArrayUnsigned(n)}},this.parseSigCompact=function(e){if(65!==e.length)throw"Signature has the wrong length";var t=e[0]-27;if(t<0||t>7)throw"Invalid signature type";var r=this.ecparams.n;return{r:s.fromByteArrayUnsigned(e.slice(1,33)).mod(r),s:s.fromByteArrayUnsigned(e.slice(33,65)).mod(r),i:t}},this.readPKCS5PrvKeyHex=function(e){var t=un,r=cn.crypto.ECDSA.getName,n=t.getVbyList;if(!1===t.isASN1HEX(e))throw"not ASN.1 hex string";var i,o,s;try{i=n(e,0,[2,0],"06"),o=n(e,0,[1],"04");try{s=n(e,0,[3,0],"03").substr(2)}catch(e){}}catch(e){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=r(i),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(s),this.setPrivateKeyHex(o),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(e){var t=un,r=cn.crypto.ECDSA.getName,n=t.getVbyList;if(!1===t.isASN1HEX(e))throw"not ASN.1 hex string";var i,o,s;try{n(e,0,[1,0],"06"),i=n(e,0,[1,1],"06"),o=n(e,0,[2,0,1],"04");try{s=n(e,0,[2,0,2,0],"03").substr(2)}catch(e){}}catch(e){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=r(i),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(s),this.setPrivateKeyHex(o),this.isPublic=!1},this.readPKCS8PubKeyHex=function(e){var t=un,r=cn.crypto.ECDSA.getName,n=t.getVbyList;if(!1===t.isASN1HEX(e))throw"not ASN.1 hex string";var i,o;try{n(e,0,[0,0],"06"),i=n(e,0,[0,1],"06"),o=n(e,0,[1],"03").substr(2)}catch(e){throw"malformed PKCS#8 ECC public key"}if(this.curveName=r(i),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(o)},this.readCertPubKeyHex=function(e,t){5!==t&&(t=6);var r=un,n=cn.crypto.ECDSA.getName,i=r.getVbyList;if(!1===r.isASN1HEX(e))throw"not ASN.1 hex string";var o,s;try{o=i(e,0,[0,t,0,1],"06"),s=i(e,0,[0,t,1],"03").substr(2)}catch(e){throw"malformed X.509 certificate ECC public key"}if(this.curveName=n(o),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(s)},void 0!==e&&void 0!==e.curve&&(this.curveName=e.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==e&&(void 0!==e.prv&&this.setPrivateKeyHex(e.prv),void 0!==e.pub&&this.setPublicKeyHex(e.pub))},cn.crypto.ECDSA.parseSigHex=function(e){var t=cn.crypto.ECDSA.parseSigHexInHexRS(e);return{r:new s(t.r,16),s:new s(t.s,16)}},cn.crypto.ECDSA.parseSigHexInHexRS=function(e){var t=un,r=t.getChildIdx,n=t.getV;if("30"!=e.substr(0,2))throw"signature is not a ASN.1 sequence";var i=r(e,0);if(2!=i.length)throw"number of signature ASN.1 sequence elements seem wrong";var o=i[0],s=i[1];if("02"!=e.substr(o,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=e.substr(s,2))throw"2nd item of sequene of signature is not ASN.1 integer";return{r:n(e,o),s:n(e,s)}},cn.crypto.ECDSA.asn1SigToConcatSig=function(e){var t=cn.crypto.ECDSA.parseSigHexInHexRS(e),r=t.r,n=t.s;if("00"==r.substr(0,2)&&r.length%32==2&&(r=r.substr(2)),"00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),r.length%32==30&&(r="00"+r),n.length%32==30&&(n="00"+n),r.length%32!=0)throw"unknown ECDSA sig r length error";if(n.length%32!=0)throw"unknown ECDSA sig s length error";return r+n},cn.crypto.ECDSA.concatSigToASN1Sig=function(e){if(e.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var t=e.substr(0,e.length/2),r=e.substr(e.length/2);return cn.crypto.ECDSA.hexRSSigToASN1Sig(t,r)},cn.crypto.ECDSA.hexRSSigToASN1Sig=function(e,t){var r=new s(e,16),n=new s(t,16);return cn.crypto.ECDSA.biRSSigToASN1Sig(r,n)},cn.crypto.ECDSA.biRSSigToASN1Sig=function(e,t){var r=cn.asn1,n=new r.DERInteger({bigint:e}),i=new r.DERInteger({bigint:t});return new r.DERSequence({array:[n,i]}).getEncodedHex()},cn.crypto.ECDSA.getName=function(e){return"2a8648ce3d030107"===e?"secp256r1":"2b8104000a"===e?"secp256k1":"2b81040022"===e?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(e)?"secp256r1":-1!=="|secp256k1|".indexOf(e)?"secp256k1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(e)?"secp384r1":null},void 0!==cn&&cn||(cn={}),void 0!==cn.crypto&&cn.crypto||(cn.crypto={}),cn.crypto.ECParameterDB=new function(){function e(e){return new s(e,16)}var t={},r={};this.getByName=function(e){var n=e;if(void 0!==r[n]&&(n=r[e]),void 0!==t[n])return t[n];throw"unregistered EC curve name: "+n},this.regist=function(n,i,o,s,a,u,c,h,l,f,p,d){t[n]={};var g=e(o),v=e(s),y=e(a),m=e(u),S=e(c),_=new Ht(g,v,y),F=_.decodePointHex("04"+h+l);t[n].name=n,t[n].keylen=i,t[n].curve=_,t[n].G=F,t[n].n=m,t[n].h=S,t[n].oid=p,t[n].info=d;for(var b=0;b<f.length;b++)r[f[b]]=n}},cn.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),cn.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),cn.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),cn.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),cn.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),cn.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),cn.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),cn.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),cn.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),cn.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);var pn=function(){var e=function(e,t,r){return n(Kr.AES,e,t,r)},t=function(e,t,r){return n(Kr.TripleDES,e,t,r)},r=function(e,t,r){return n(Kr.DES,e,t,r)},n=function(e,t,r,n){var i=Kr.enc.Hex.parse(t),o=Kr.enc.Hex.parse(r),s=Kr.enc.Hex.parse(n),a={};a.key=o,a.iv=s,a.ciphertext=i;var u=e.decrypt(a,o,{iv:s});return Kr.enc.Hex.stringify(u)},i=function(e,t,r){return a(Kr.AES,e,t,r)},o=function(e,t,r){return a(Kr.TripleDES,e,t,r)},s=function(e,t,r){return a(Kr.DES,e,t,r)},a=function(e,t,r,n){var i=Kr.enc.Hex.parse(t),o=Kr.enc.Hex.parse(r),s=Kr.enc.Hex.parse(n),a=e.encrypt(i,o,{iv:s}),u=Kr.enc.Hex.parse(a.toString());return Kr.enc.Base64.stringify(u)},u={"AES-256-CBC":{proc:e,eproc:i,keylen:32,ivlen:16},"AES-192-CBC":{proc:e,eproc:i,keylen:24,ivlen:16},"AES-128-CBC":{proc:e,eproc:i,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:t,eproc:o,keylen:24,ivlen:8},"DES-CBC":{proc:r,eproc:s,keylen:8,ivlen:8}},c=function(e){var t=Kr.lib.WordArray.random(e);return Kr.enc.Hex.stringify(t)},h=function(e){var t={},r=e.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));r&&(t.cipher=r[1],t.ivsalt=r[2]);var n=e.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));n&&(t.type=n[1]);var i=-1,o=0;-1!=e.indexOf("\r\n\r\n")&&(i=e.indexOf("\r\n\r\n"),o=2),-1!=e.indexOf("\n\n")&&(i=e.indexOf("\n\n"),o=1);var s=e.indexOf("-----END");if(-1!=i&&-1!=s){var a=e.substring(i+2*o,s-o);a=a.replace(/\s+/g,""),t.data=a}return t},l=function(e,t,r){for(var n=r.substring(0,16),i=Kr.enc.Hex.parse(n),o=Kr.enc.Utf8.parse(t),s=u[e].keylen+u[e].ivlen,a="",c=null;;){var h=Kr.algo.MD5.create();if(null!=c&&h.update(c),h.update(o),h.update(i),c=h.finalize(),a+=Kr.enc.Hex.stringify(c),a.length>=2*s)break}var l={};return l.keyhex=a.substr(0,2*u[e].keylen),l.ivhex=a.substr(2*u[e].keylen,2*u[e].ivlen),l},f=function(e,t,r,n){var i=Kr.enc.Base64.parse(e),o=Kr.enc.Hex.stringify(i);return(0,u[t].proc)(o,r,n)},p=function(e,t,r,n){return(0,u[t].eproc)(e,r,n)};return{version:"1.0.0",parsePKCS5PEM:function(e){return h(e)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(e,t,r){return l(e,t,r)},decryptKeyB64:function(e,t,r,n){return f(e,t,r,n)},getDecryptedKeyHex:function(e,t){var r=h(e),n=(r.type,r.cipher),i=r.ivsalt,o=r.data,s=l(n,t,i),a=s.keyhex;return f(o,n,a,i)},getEncryptedPKCS5PEMFromPrvKeyHex:function(e,t,r,n,i){var o="";if(void 0!==n&&null!=n||(n="AES-256-CBC"),void 0===u[n])throw"KEYUTIL unsupported algorithm: "+n;if(void 0===i||null==i){var s=u[n].ivlen;i=c(s).toUpperCase()}var a=l(n,r,i),h=a.keyhex,f=p(t,n,h,i),d=f.replace(/(.{64})/g,"$1\r\n"),o="-----BEGIN "+e+" PRIVATE KEY-----\r\n";return o+="Proc-Type: 4,ENCRYPTED\r\n",o+="DEK-Info: "+n+","+i+"\r\n",o+="\r\n",o+=d,o+="\r\n-----END "+e+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(e){var t=un,r=t.getChildIdx,n=t.getV,i={},o=r(e,0);if(2!=o.length)throw"malformed format: SEQUENCE(0).items != 2: "+o.length;i.ciphertext=n(e,o[1]);var s=r(e,o[0]);if(2!=s.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+s.length;if("2a864886f70d01050d"!=n(e,s[0]))throw"this only supports pkcs5PBES2";var a=r(e,s[1]);if(2!=s.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+a.length;var u=r(e,a[1]);if(2!=u.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+u.length;if("2a864886f70d0307"!=n(e,u[0]))throw"this only supports TripleDES";i.encryptionSchemeAlg="TripleDES",i.encryptionSchemeIV=n(e,u[1]);var c=r(e,a[0]);if(2!=c.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+c.length;if("2a864886f70d01050c"!=n(e,c[0]))throw"this only supports pkcs5PBKDF2";var h=r(e,c[1]);if(h.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+h.length;i.pbkdf2Salt=n(e,h[0]);var l=n(e,h[1]);try{i.pbkdf2Iter=parseInt(l,16)}catch(e){throw"malformed format pbkdf2Iter: "+l}return i},getPBKDF2KeyHexFromParam:function(e,t){var r=Kr.enc.Hex.parse(e.pbkdf2Salt),n=e.pbkdf2Iter,i=Kr.PBKDF2(t,r,{keySize:6,iterations:n});return Kr.enc.Hex.stringify(i)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(e,t){var r=vr(e,"ENCRYPTED PRIVATE KEY"),n=this.parseHexOfEncryptedPKCS8(r),i=pn.getPBKDF2KeyHexFromParam(n,t),o={};o.ciphertext=Kr.enc.Hex.parse(n.ciphertext);var s=Kr.enc.Hex.parse(i),a=Kr.enc.Hex.parse(n.encryptionSchemeIV),u=Kr.TripleDES.decrypt(o,s,{iv:a});return Kr.enc.Hex.stringify(u)},getKeyFromEncryptedPKCS8PEM:function(e,t){var r=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(e,t);return this.getKeyFromPlainPrivatePKCS8Hex(r)},parsePlainPrivatePKCS8Hex:function(e){var t=un,r=t.getChildIdx,n=t.getV,i={};if(i.algparam=null,"30"!=e.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var o=r(e,0);if(3!=o.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=e.substr(o[1],2))throw"malformed PKCS8 private key(code:003)";var s=r(e,o[1]);if(2!=s.length)throw"malformed PKCS8 private key(code:004)";if("06"!=e.substr(s[0],2))throw"malformed PKCS8 private key(code:005)";if(i.algoid=n(e,s[0]),"06"==e.substr(s[1],2)&&(i.algparam=n(e,s[1])),"04"!=e.substr(o[2],2))throw"malformed PKCS8 private key(code:006)";return i.keyidx=t.getVidx(e,o[2]),i},getKeyFromPlainPrivatePKCS8PEM:function(e){var t=vr(e,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(t)},getKeyFromPlainPrivatePKCS8Hex:function(e){var t,r=this.parsePlainPrivatePKCS8Hex(e);if("2a864886f70d010101"==r.algoid)t=new yt;else if("2a8648ce380401"==r.algoid)t=new cn.crypto.DSA;else{if("2a8648ce3d0201"!=r.algoid)throw"unsupported private key algorithm";t=new cn.crypto.ECDSA}return t.readPKCS8PrvKeyHex(e),t},_getKeyFromPublicPKCS8Hex:function(e){var t,r=un.getVbyList(e,0,[0,0],"06");if("2a864886f70d010101"===r)t=new yt;else if("2a8648ce380401"===r)t=new cn.crypto.DSA;else{if("2a8648ce3d0201"!==r)throw"unsupported PKCS#8 public key hex";t=new cn.crypto.ECDSA}return t.readPKCS8PubKeyHex(e),t},parsePublicRawRSAKeyHex:function(e){var t=un,r=t.getChildIdx,n=t.getV,i={};if("30"!=e.substr(0,2))throw"malformed RSA key(code:001)";var o=r(e,0);if(2!=o.length)throw"malformed RSA key(code:002)";if("02"!=e.substr(o[0],2))throw"malformed RSA key(code:003)";if(i.n=n(e,o[0]),"02"!=e.substr(o[1],2))throw"malformed RSA key(code:004)";return i.e=n(e,o[1]),i},parsePublicPKCS8Hex:function(e){var t=un,r=t.getChildIdx,n=t.getV,i={};i.algparam=null;var o=r(e,0);if(2!=o.length)throw"outer DERSequence shall have 2 elements: "+o.length;var s=o[0];if("30"!=e.substr(s,2))throw"malformed PKCS8 public key(code:001)";var a=r(e,s);if(2!=a.length)throw"malformed PKCS8 public key(code:002)";if("06"!=e.substr(a[0],2))throw"malformed PKCS8 public key(code:003)";if(i.algoid=n(e,a[0]),"06"==e.substr(a[1],2)?i.algparam=n(e,a[1]):"30"==e.substr(a[1],2)&&(i.algparam={},i.algparam.p=t.getVbyList(e,a[1],[0],"02"),i.algparam.q=t.getVbyList(e,a[1],[1],"02"),i.algparam.g=t.getVbyList(e,a[1],[2],"02")),"03"!=e.substr(o[1],2))throw"malformed PKCS8 public key(code:004)";return i.key=n(e,o[1]).substr(2),i}}}();pn.getKey=function(e,t,r){var n=un,i=n.getChildIdx,o=(n.getV,n.getVbyList),a=cn.crypto,u=a.ECDSA,c=a.DSA,h=yt,l=vr,f=pn;if(void 0!==h&&e instanceof h)return e;if(void 0!==u&&e instanceof u)return e;if(void 0!==c&&e instanceof c)return e;if(void 0!==e.curve&&void 0!==e.xy&&void 0===e.d)return new u({pub:e.xy,curve:e.curve});if(void 0!==e.curve&&void 0!==e.d)return new u({prv:e.d,curve:e.curve});if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d){var p=new h;return p.setPublic(e.n,e.e),p}if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.co&&void 0===e.qi){var p=new h;return p.setPrivateEx(e.n,e.e,e.d,e.p,e.q,e.dp,e.dq,e.co),p}if(void 0===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0===e.p){var p=new h;return p.setPrivate(e.n,e.e,e.d),p}if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0===e.x){var p=new c;return p.setPublic(e.p,e.q,e.g,e.y),p}if(void 0!==e.p&&void 0!==e.q&&void 0!==e.g&&void 0!==e.y&&void 0!==e.x){var p=new c;return p.setPrivate(e.p,e.q,e.g,e.y,e.x),p}if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0===e.d){var p=new h;return p.setPublic(or(e.n),or(e.e)),p}if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d&&void 0!==e.p&&void 0!==e.q&&void 0!==e.dp&&void 0!==e.dq&&void 0!==e.qi){var p=new h;return p.setPrivateEx(or(e.n),or(e.e),or(e.d),or(e.p),or(e.q),or(e.dp),or(e.dq),or(e.qi)),p}if("RSA"===e.kty&&void 0!==e.n&&void 0!==e.e&&void 0!==e.d){var p=new h;return p.setPrivate(or(e.n),or(e.e),or(e.d)),p}if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0===e.d){var d=new u({curve:e.crv}),g=d.ecparams.keylen/4,v=("0000000000"+or(e.x)).slice(-g),y=("0000000000"+or(e.y)).slice(-g),m="04"+v+y;return d.setPublicKeyHex(m),d}if("EC"===e.kty&&void 0!==e.crv&&void 0!==e.x&&void 0!==e.y&&void 0!==e.d){var d=new u({curve:e.crv}),g=d.ecparams.keylen/4,v=("0000000000"+or(e.x)).slice(-g),y=("0000000000"+or(e.y)).slice(-g),m="04"+v+y,S=("0000000000"+or(e.d)).slice(-g);return d.setPublicKeyHex(m),d.setPrivateKeyHex(S),d}if("pkcs5prv"===r){var _,p,F=e,n=un;if(_=i(F,0),9===_.length)p=new h,p.readPKCS5PrvKeyHex(F);else if(6===_.length)p=new c,p.readPKCS5PrvKeyHex(F);else{if(!(_.length>2&&"04"===F.substr(_[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";p=new u,p.readPKCS5PrvKeyHex(F)}return p}if("pkcs8prv"===r){var p=f.getKeyFromPlainPrivatePKCS8Hex(e);return p}if("pkcs8pub"===r)return f._getKeyFromPublicPKCS8Hex(e);if("x509pub"===r)return Nr.getPublicKeyFromCertHex(e);if(-1!=e.indexOf("-END CERTIFICATE-",0)||-1!=e.indexOf("-END X509 CERTIFICATE-",0)||-1!=e.indexOf("-END TRUSTED CERTIFICATE-",0))return Nr.getPublicKeyFromCertPEM(e);if(-1!=e.indexOf("-END PUBLIC KEY-")){var b=vr(e,"PUBLIC KEY");return f._getKeyFromPublicPKCS8Hex(b)}if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var w=l(e,"RSA PRIVATE KEY");return f.getKey(w,null,"pkcs5prv")}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1==e.indexOf("4,ENCRYPTED")){var E=l(e,"DSA PRIVATE KEY"),x=o(E,0,[1],"02"),A=o(E,0,[2],"02"),P=o(E,0,[3],"02"),C=o(E,0,[4],"02"),k=o(E,0,[5],"02"),p=new c;return p.setPrivate(new s(x,16),new s(A,16),new s(P,16),new s(C,16),new s(k,16)),p}if(-1!=e.indexOf("-END PRIVATE KEY-"))return f.getKeyFromPlainPrivatePKCS8PEM(e);if(-1!=e.indexOf("-END RSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var R=f.getDecryptedKeyHex(e,t),T=new yt;return T.readPKCS5PrvKeyHex(R),T}if(-1!=e.indexOf("-END EC PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var E=f.getDecryptedKeyHex(e,t),p=o(E,0,[1],"04"),I=o(E,0,[2,0],"06"),U=o(E,0,[3,0],"03").substr(2),j="";if(void 0===cn.crypto.OID.oidhex2name[I])throw"undefined OID(hex) in KJUR.crypto.OID: "+I;j=cn.crypto.OID.oidhex2name[I];var d=new u({curve:j});return d.setPublicKeyHex(U),d.setPrivateKeyHex(p),d.isPublic=!1,d}if(-1!=e.indexOf("-END DSA PRIVATE KEY-")&&-1!=e.indexOf("4,ENCRYPTED")){var E=f.getDecryptedKeyHex(e,t),x=o(E,0,[1],"02"),A=o(E,0,[2],"02"),P=o(E,0,[3],"02"),C=o(E,0,[4],"02"),k=o(E,0,[5],"02"),p=new c;return p.setPrivate(new s(x,16),new s(A,16),new s(P,16),new s(C,16),new s(k,16)),p}if(-1!=e.indexOf("-END ENCRYPTED PRIVATE KEY-"))return f.getKeyFromEncryptedPKCS8PEM(e,t);throw"not supported argument"},pn.generateKeypair=function(e,t){if("RSA"==e){var r=t,n=new yt;n.generate(r,"10001"),n.isPrivate=!0,n.isPublic=!0;var i=new yt,o=n.n.toString(16),s=n.e.toString(16);i.setPublic(o,s),i.isPrivate=!1,i.isPublic=!0;var a={};return a.prvKeyObj=n,a.pubKeyObj=i,a}if("EC"==e){var u=t,c=new cn.crypto.ECDSA({curve:u}),h=c.generateKeyPairHex(),n=new cn.crypto.ECDSA({curve:u});n.setPublicKeyHex(h.ecpubhex),n.setPrivateKeyHex(h.ecprvhex),n.isPrivate=!0,n.isPublic=!1;var i=new cn.crypto.ECDSA({curve:u});i.setPublicKeyHex(h.ecpubhex),i.isPrivate=!1,i.isPublic=!0;var a={};return a.prvKeyObj=n,a.pubKeyObj=i,a}throw"unknown algorithm: "+e},pn.getPEM=function(e,t,r,n,i,o){function s(e){return p({seq:[{int:0},{int:{bigint:e.n}},{int:e.e},{int:{bigint:e.d}},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.dmp1}},{int:{bigint:e.dmq1}},{int:{bigint:e.coeff}}]})}function a(e){return p({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a0",!0,{oid:{name:e.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]})}function u(e){return p({seq:[{int:0},{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}},{int:{bigint:e.y}},{int:{bigint:e.x}}]})}var c=cn,h=c.asn1,l=h.DERObjectIdentifier,f=h.DERInteger,p=h.ASN1Util.newObject,d=h.x509,g=d.SubjectPublicKeyInfo,v=c.crypto,y=v.DSA,m=v.ECDSA,S=yt;if((void 0!==S&&e instanceof S||void 0!==y&&e instanceof y||void 0!==m&&e instanceof m)&&1==e.isPublic&&(void 0===t||"PKCS8PUB"==t)){var _=new g(e),F=_.getEncodedHex();return gr(F,"PUBLIC KEY")}if("PKCS1PRV"==t&&void 0!==S&&e instanceof S&&(void 0===r||null==r)&&1==e.isPrivate){var _=s(e),F=_.getEncodedHex();return gr(F,"RSA PRIVATE KEY")}if("PKCS1PRV"==t&&void 0!==m&&e instanceof m&&(void 0===r||null==r)&&1==e.isPrivate){var b=new l({name:e.curveName}),w=b.getEncodedHex(),E=a(e),x=E.getEncodedHex(),A="";return A+=gr(w,"EC PARAMETERS"),A+=gr(x,"EC PRIVATE KEY")}if("PKCS1PRV"==t&&void 0!==y&&e instanceof y&&(void 0===r||null==r)&&1==e.isPrivate){var _=u(e),F=_.getEncodedHex();return gr(F,"DSA PRIVATE KEY")}if("PKCS5PRV"==t&&void 0!==S&&e instanceof S&&void 0!==r&&null!=r&&1==e.isPrivate){var _=s(e),F=_.getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",F,r,n,o)}if("PKCS5PRV"==t&&void 0!==m&&e instanceof m&&void 0!==r&&null!=r&&1==e.isPrivate){var _=a(e),F=_.getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",F,r,n,o)}if("PKCS5PRV"==t&&void 0!==y&&e instanceof y&&void 0!==r&&null!=r&&1==e.isPrivate){var _=u(e),F=_.getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",F,r,n,o)}var P=function(e,t){var r=C(e,t);return new p({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:r.pbkdf2Salt}},{int:r.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:r.encryptionSchemeIV}}]}]}]},{octstr:{hex:r.ciphertext}}]}).getEncodedHex()},C=function(e,t){var r=Kr.lib.WordArray.random(8),n=Kr.lib.WordArray.random(8),i=Kr.PBKDF2(t,r,{keySize:6,iterations:100}),o=Kr.enc.Hex.parse(e),s=Kr.TripleDES.encrypt(o,i,{iv:n})+"",a={};return a.ciphertext=s,a.pbkdf2Salt=Kr.enc.Hex.stringify(r),a.pbkdf2Iter=100,a.encryptionSchemeAlg="DES-EDE3-CBC",a.encryptionSchemeIV=Kr.enc.Hex.stringify(n),a};if("PKCS8PRV"==t&&void 0!=S&&e instanceof S&&1==e.isPrivate){var k=s(e),R=k.getEncodedHex(),_=p({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:R}}]}),F=_.getEncodedHex();if(void 0===r||null==r)return gr(F,"PRIVATE KEY");var x=P(F,r);return gr(x,"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==t&&void 0!==m&&e instanceof m&&1==e.isPrivate){var k=new p({seq:[{int:1},{octstr:{hex:e.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+e.pubKeyHex}}]}]}),R=k.getEncodedHex(),_=p({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:e.curveName}}]},{octstr:{hex:R}}]}),F=_.getEncodedHex();if(void 0===r||null==r)return gr(F,"PRIVATE KEY");var x=P(F,r);return gr(x,"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==t&&void 0!==y&&e instanceof y&&1==e.isPrivate){var k=new f({bigint:e.x}),R=k.getEncodedHex(),_=p({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:e.p}},{int:{bigint:e.q}},{int:{bigint:e.g}}]}]},{octstr:{hex:R}}]}),F=_.getEncodedHex();if(void 0===r||null==r)return gr(F,"PRIVATE KEY");var x=P(F,r);return gr(x,"ENCRYPTED PRIVATE KEY")}throw"unsupported object nor format"},pn.getKeyFromCSRPEM=function(e){var t=vr(e,"CERTIFICATE REQUEST");return pn.getKeyFromCSRHex(t)},pn.getKeyFromCSRHex=function(e){var t=pn.parseCSRHex(e);return pn.getKey(t.p8pubkeyhex,null,"pkcs8pub")},pn.parseCSRHex=function(e){var t=un,r=t.getChildIdx,n=t.getTLV,i={},o=e;if("30"!=o.substr(0,2))throw"malformed CSR(code:001)";var s=r(o,0);if(s.length<1)throw"malformed CSR(code:002)";if("30"!=o.substr(s[0],2))throw"malformed CSR(code:003)";var a=r(o,s[0]);if(a.length<3)throw"malformed CSR(code:004)";return i.p8pubkeyhex=n(o,a[2]),i},pn.getJWKFromKey=function(e){var t={};if(e instanceof yt&&e.isPrivate)return t.kty="RSA",t.n=ir(e.n.toString(16)),t.e=ir(e.e.toString(16)),t.d=ir(e.d.toString(16)),t.p=ir(e.p.toString(16)),t.q=ir(e.q.toString(16)),t.dp=ir(e.dmp1.toString(16)),t.dq=ir(e.dmq1.toString(16)),t.qi=ir(e.coeff.toString(16)),t;if(e instanceof yt&&e.isPublic)return t.kty="RSA",t.n=ir(e.n.toString(16)),t.e=ir(e.e.toString(16)),t;if(e instanceof cn.crypto.ECDSA&&e.isPrivate){var r=e.getShortNISTPCurveName();if("P-256"!==r&&"P-384"!==r)throw"unsupported curve name for JWT: "+r;var n=e.getPublicKeyXYHex();return t.kty="EC",t.crv=r,t.x=ir(n.x),t.y=ir(n.y),t.d=ir(e.prvKeyHex),t}if(e instanceof cn.crypto.ECDSA&&e.isPublic){var r=e.getShortNISTPCurveName();if("P-256"!==r&&"P-384"!==r)throw"unsupported curve name for JWT: "+r;var n=e.getPublicKeyXYHex();return t.kty="EC",t.crv=r,t.x=ir(n.x),t.y=ir(n.y),t}throw"not supported key object"},yt.getPosArrayOfChildrenFromHex=function(e){return un.getChildIdx(e,0)},yt.getHexValueArrayOfChildrenFromHex=function(e){var t=un,r=t.getV,n=yt.getPosArrayOfChildrenFromHex(e),i=r(e,n[0]),o=r(e,n[1]),s=r(e,n[2]),a=r(e,n[3]),u=r(e,n[4]),c=r(e,n[5]),h=r(e,n[6]),l=r(e,n[7]),f=r(e,n[8]),n=new Array;return n.push(i,o,s,a,u,c,h,l,f),n},yt.prototype.readPrivateKeyFromPEMString=function(e){var t=vr(e),r=yt.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8])},yt.prototype.readPKCS5PrvKeyHex=function(e){var t=yt.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},yt.prototype.readPKCS8PrvKeyHex=function(e){var t,r,n,i,o,s,a,u,c=un,h=c.getVbyList;if(!1===c.isASN1HEX(e))throw"not ASN.1 hex string";try{t=h(e,0,[2,0,1],"02"),r=h(e,0,[2,0,2],"02"),n=h(e,0,[2,0,3],"02"),i=h(e,0,[2,0,4],"02"),o=h(e,0,[2,0,5],"02"),s=h(e,0,[2,0,6],"02"),a=h(e,0,[2,0,7],"02"),u=h(e,0,[2,0,8],"02")}catch(e){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(t,r,n,i,o,s,a,u)},yt.prototype.readPKCS5PubKeyHex=function(e){var t=un,r=t.getV;if(!1===t.isASN1HEX(e))throw"keyHex is not ASN.1 hex string";var n=t.getChildIdx(e,0);if(2!==n.length||"02"!==e.substr(n[0],2)||"02"!==e.substr(n[1],2))throw"wrong hex for PKCS#5 public key";var i=r(e,n[0]),o=r(e,n[1]);this.setPublic(i,o)},yt.prototype.readPKCS8PubKeyHex=function(e){var t=un;if(!1===t.isASN1HEX(e))throw"not ASN.1 hex string";if("06092a864886f70d010101"!==t.getTLVbyList(e,0,[0,0]))throw"not PKCS8 RSA public key";var r=t.getTLVbyList(e,0,[1,0]);this.readPKCS5PubKeyHex(r)},yt.prototype.readCertPubKeyHex=function(e,t){var r,n;r=new Nr,r.readCertHex(e),n=r.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};var dn=new RegExp("");dn.compile("[^0-9a-f]","gi"),yt.prototype.sign=function(e,t){var r=function(e){return cn.crypto.Util.hashString(e,t)}(e);return this.signWithMessageHash(r,t)},yt.prototype.signWithMessageHash=function(e,t){var r=cn.crypto.Util.getPaddedDigestInfoHex(e,t,this.n.bitLength()),n=pt(r,16);return jr(this.doPrivate(n).toString(16),this.n.bitLength())},yt.prototype.signPSS=function(e,t,r){var n=function(e){return cn.crypto.Util.hashHex(e,t)}(lr(e));return void 0===r&&(r=-1),this.signWithMessageHashPSS(n,t,r)},yt.prototype.signWithMessageHashPSS=function(e,t,r){var n,i=hr(e),o=i.length,a=this.n.bitLength()-1,u=Math.ceil(a/8),c=function(e){return cn.crypto.Util.hashHex(e,t)};if(-1===r||void 0===r)r=o;else if(-2===r)r=u-o-2;else if(r<-2)throw"invalid salt length";if(u<o+r+2)throw"data too long";var h="";r>0&&(h=new Array(r),(new ft).nextBytes(h),h=String.fromCharCode.apply(String,h));var l=hr(c(lr("\0\0\0\0\0\0\0\0"+i+h))),f=[];for(n=0;n<u-r-o-2;n+=1)f[n]=0;var p=String.fromCharCode.apply(String,f)+""+h,d=Or(l,p.length,c),g=[];for(n=0;n<p.length;n+=1)g[n]=p.charCodeAt(n)^d.charCodeAt(n);var v=65280>>8*u-a&255;for(g[0]&=~v,n=0;n<o;n++)g.push(l.charCodeAt(n));return g.push(188),jr(this.doPrivate(new s(g)).toString(16),this.n.bitLength())},yt.prototype.verify=function(e,t){t=t.replace(dn,""),t=t.replace(/[ \n]+/g,"");var r=pt(t,16);if(r.bitLength()>this.n.bitLength())return 0;var n=this.doPublic(r),i=n.toString(16).replace(/^1f+00/,""),o=Lr(i);if(0==o.length)return!1;var s=o[0];return o[1]==function(e){return cn.crypto.Util.hashString(e,s)}(e)},yt.prototype.verifyWithMessageHash=function(e,t){t=t.replace(dn,""),t=t.replace(/[ \n]+/g,"");var r=pt(t,16);if(r.bitLength()>this.n.bitLength())return 0;var n=this.doPublic(r),i=n.toString(16).replace(/^1f+00/,""),o=Lr(i);return 0!=o.length&&(o[0],o[1]==e)},yt.prototype.verifyPSS=function(e,t,r,n){var i=function(e){return cn.crypto.Util.hashHex(e,r)}(lr(e));return void 0===n&&(n=-1),this.verifyWithMessageHashPSS(i,t,r,n)},yt.prototype.verifyWithMessageHashPSS=function(e,t,r,n){var i=new s(t,16);if(i.bitLength()>this.n.bitLength())return!1;var o,a=function(e){return cn.crypto.Util.hashHex(e,r)},u=hr(e),c=u.length,h=this.n.bitLength()-1,l=Math.ceil(h/8);if(-1===n||void 0===n)n=c;else if(-2===n)n=l-c-2;else if(n<-2)throw"invalid salt length";if(l<c+n+2)throw"data too long";var f=this.doPublic(i).toByteArray();for(o=0;o<f.length;o+=1)f[o]&=255;for(;f.length<l;)f.unshift(0);if(188!==f[l-1])throw"encoded message does not end in 0xbc";f=String.fromCharCode.apply(String,f);var p=f.substr(0,l-c-1),d=f.substr(p.length,c),g=65280>>8*l-h&255;if(0!=(p.charCodeAt(0)&g))throw"bits beyond keysize not zero";var v=Or(d,p.length,a),y=[];for(o=0;o<p.length;o+=1)y[o]=p.charCodeAt(o)^v.charCodeAt(o);y[0]&=~g;var m=l-c-n-2;for(o=0;o<m;o+=1)if(0!==y[o])throw"leftmost octets not zero";if(1!==y[m])throw"0x01 marker not found";return d===hr(a(lr("\0\0\0\0\0\0\0\0"+u+String.fromCharCode.apply(String,y.slice(-n)))))},yt.SALT_LEN_HLEN=-1,yt.SALT_LEN_MAX=-2,yt.SALT_LEN_RECOVER=-2,Nr.hex2dn=function(e,t){if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw"malformed DN";for(var r=new Array,n=un.getChildIdx(e,t),i=0;i<n.length;i++)r.push(Nr.hex2rdn(e,n[i]));return r=r.map(function(e){return e.replace("/","\\/")}),"/"+r.join("/")},Nr.hex2rdn=function(e,t){if(void 0===t&&(t=0),"31"!==e.substr(t,2))throw"malformed RDN";for(var r=new Array,n=un.getChildIdx(e,t),i=0;i<n.length;i++)r.push(Nr.hex2attrTypeValue(e,n[i]));return r=r.map(function(e){return e.replace("+","\\+")}),r.join("+")},Nr.hex2attrTypeValue=function(e,t){var r=un,n=r.getV;if(void 0===t&&(t=0),"30"!==e.substr(t,2))throw"malformed attribute type and value";var i=r.getChildIdx(e,t);2!==i.length||e.substr(i[0],2);var o=n(e,i[0]),s=cn.asn1.ASN1Util.oidHexToInt(o);return cn.asn1.x509.OID.oid2atype(s)+"="+hr(n(e,i[1]))},Nr.getPublicKeyFromCertHex=function(e){var t=new Nr;return t.readCertHex(e),t.getPublicKey()},Nr.getPublicKeyFromCertPEM=function(e){var t=new Nr;return t.readCertPEM(e),t.getPublicKey()},Nr.getPublicKeyInfoPropOfCertPEM=function(e){var t,r,n=un,i=n.getVbyList,o={};return o.algparam=null,t=new Nr,t.readCertPEM(e),r=t.getPublicKeyHex(),o.keyhex=i(r,0,[1],"03").substr(2),o.algoid=i(r,0,[0,0],"06"),"2a8648ce3d0201"===o.algoid&&(o.algparam=i(r,0,[0,1],"06")),o},Nr.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==cn&&cn||(cn={}),void 0!==cn.jws&&cn.jws||(cn.jws={}),cn.jws.JWS=function(){var e=cn,t=e.jws.JWS,r=t.isSafeJSONString;this.parseJWS=function(e,t){if(void 0===this.parsedJWS||!t&&void 0===this.parsedJWS.sigvalH){var n=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==n)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var i=n[1],o=n[2],s=n[3],a=i+"."+o;if(this.parsedJWS={},this.parsedJWS.headB64U=i,this.parsedJWS.payloadB64U=o,this.parsedJWS.sigvalB64U=s,this.parsedJWS.si=a,!t){var u=or(s),c=pt(u,16);this.parsedJWS.sigvalH=u,this.parsedJWS.sigvalBI=c}var h=ln(i),l=ln(o);if(this.parsedJWS.headS=h,this.parsedJWS.payloadS=l,!r(h,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+h}}},cn.jws.JWS.sign=function(e,t,r,n,i){var o,s,a,u=cn,c=u.jws,h=c.JWS,l=h.readSafeJSONString,f=h.isSafeJSONString,p=u.crypto,d=(p.ECDSA,p.Mac),g=p.Signature,v=JSON;if("string"!=typeof t&&"object"!=(void 0===t?"undefined":Dr(t)))throw"spHeader must be JSON string or object: "+t;if("object"==(void 0===t?"undefined":Dr(t))&&(s=t,o=v.stringify(s)),"string"==typeof t){if(o=t,!f(o))throw"JWS Head is not safe JSON string: "+o;s=l(o)}if(a=r,"object"==(void 0===r?"undefined":Dr(r))&&(a=v.stringify(r)),""!=e&&null!=e||void 0===s.alg||(e=s.alg),""!=e&&null!=e&&void 0===s.alg&&(s.alg=e,o=v.stringify(s)),e!==s.alg)throw"alg and sHeader.alg doesn't match: "+e+"!="+s.alg;var y=null;if(void 0===h.jwsalg2sigalg[e])throw"unsupported alg name: "+e;y=h.jwsalg2sigalg[e];var m=hn(o),S=hn(a),_=m+"."+S,F="";if("Hmac"==y.substr(0,4)){if(void 0===n)throw"mac key shall be specified for HS* alg";var b=new d({alg:y,prov:"cryptojs",pass:n});b.updateString(_),F=b.doFinal()}else if(-1!=y.indexOf("withECDSA")){var w=new g({alg:y});w.init(n,i),w.updateString(_),hASN1Sig=w.sign(),F=cn.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig)}else if("none"!=y){var w=new g({alg:y});w.init(n,i),w.updateString(_),F=w.sign()}return _+"."+ir(F)},cn.jws.JWS.verify=function(e,t,r){var n,i=cn,o=i.jws,s=o.JWS,a=s.readSafeJSONString,u=i.crypto,c=u.ECDSA,h=u.Mac,l=u.Signature;void 0!==(void 0===yt?"undefined":Dr(yt))&&(n=yt);var f=e.split(".");if(3!==f.length)return!1;var p=f[0],d=f[1],g=p+"."+d,v=or(f[2]),y=a(ln(f[0])),m=null,S=null;if(void 0===y.alg)throw"algorithm not specified in header";if(m=y.alg,S=m.substr(0,2),null!=r&&"[object Array]"===Object.prototype.toString.call(r)&&r.length>0&&-1==(":"+r.join(":")+":").indexOf(":"+m+":"))throw"algorithm '"+m+"' not accepted in the list";if("none"!=m&&null===t)throw"key shall be specified to verify.";if("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&(t=pn.getKey(t)),!("RS"!=S&&"PS"!=S||t instanceof n))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==S&&!(t instanceof c))throw"key shall be a ECDSA obj for ES* algs";var _=null;if(void 0===s.jwsalg2sigalg[y.alg])throw"unsupported alg name: "+m;if("none"==(_=s.jwsalg2sigalg[m]))throw"not supported";if("Hmac"==_.substr(0,4)){var F=null;if(void 0===t)throw"hexadecimal key shall be specified for HMAC";var b=new h({alg:_,pass:t});return b.updateString(g),F=b.doFinal(),v==F}if(-1!=_.indexOf("withECDSA")){var w=null;try{w=c.concatSigToASN1Sig(v)}catch(e){return!1}var E=new l({alg:_});return E.init(t),E.updateString(g),E.verify(w)}var E=new l({alg:_});return E.init(t),E.updateString(g),E.verify(v)},cn.jws.JWS.parse=function(e){var t,r,n,i=e.split("."),o={};if(2!=i.length&&3!=i.length)throw"malformed sJWS: wrong number of '.' splitted elements";return t=i[0],r=i[1],3==i.length&&(n=i[2]),o.headerObj=cn.jws.JWS.readSafeJSONString(ln(t)),o.payloadObj=cn.jws.JWS.readSafeJSONString(ln(r)),o.headerPP=JSON.stringify(o.headerObj,null,"  "),null==o.payloadObj?o.payloadPP=ln(r):o.payloadPP=JSON.stringify(o.payloadObj,null,"  "),void 0!==n&&(o.sigHex=or(n)),o},cn.jws.JWS.verifyJWT=function(e,t,r){var n=cn,i=n.jws,o=i.JWS,s=o.readSafeJSONString,a=o.inArray,u=o.includedArray,c=e.split("."),h=c[0],l=c[1],f=(or(c[2]),s(ln(h))),p=s(ln(l));if(void 0===f.alg)return!1;if(void 0===r.alg)throw"acceptField.alg shall be specified";if(!a(f.alg,r.alg))return!1;if(void 0!==p.iss&&"object"===Dr(r.iss)&&!a(p.iss,r.iss))return!1;if(void 0!==p.sub&&"object"===Dr(r.sub)&&!a(p.sub,r.sub))return!1;if(void 0!==p.aud&&"object"===Dr(r.aud))if("string"==typeof p.aud){if(!a(p.aud,r.aud))return!1}else if("object"==Dr(p.aud)&&!u(p.aud,r.aud))return!1;var d=i.IntDate.getNow();return void 0!==r.verifyAt&&"number"==typeof r.verifyAt&&(d=r.verifyAt),void 0!==r.gracePeriod&&"number"==typeof r.gracePeriod||(r.gracePeriod=0),!(void 0!==p.exp&&"number"==typeof p.exp&&p.exp+r.gracePeriod<d||void 0!==p.nbf&&"number"==typeof p.nbf&&d<p.nbf-r.gracePeriod||void 0!==p.iat&&"number"==typeof p.iat&&d<p.iat-r.gracePeriod||void 0!==p.jti&&void 0!==r.jti&&p.jti!==r.jti||!o.verify(e,t,r.alg))},cn.jws.JWS.includedArray=function(e,t){var r=cn.jws.JWS.inArray;if(null===e)return!1;if("object"!==(void 0===e?"undefined":Dr(e)))return!1;if("number"!=typeof e.length)return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t))return!1;return!0},cn.jws.JWS.inArray=function(e,t){if(null===t)return!1;if("object"!==(void 0===t?"undefined":Dr(t)))return!1;if("number"!=typeof t.length)return!1;for(var r=0;r<t.length;r++)if(t[r]==e)return!0;return!1},cn.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},cn.jws.JWS.isSafeJSONString=function(e,t,r){var n=null;try{return n=an(e),"object"!=(void 0===n?"undefined":Dr(n))?0:n.constructor===Array?0:(t&&(t[r]=n),1)}catch(e){return 0}},cn.jws.JWS.readSafeJSONString=function(e){var t=null;try{return t=an(e),"object"!=(void 0===t?"undefined":Dr(t))?null:t.constructor===Array?null:t}catch(e){return null}},cn.jws.JWS.getEncodedSignatureValueFromJWS=function(e){var t=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==t)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return t[1]},cn.jws.JWS.getJWKthumbprint=function(e){if("RSA"!==e.kty&&"EC"!==e.kty&&"oct"!==e.kty)throw"unsupported algorithm for JWK Thumprint";var t="{";if("RSA"===e.kty){if("string"!=typeof e.n||"string"!=typeof e.e)throw"wrong n and e value for RSA key";t+='"e":"'+e.e+'",',t+='"kty":"'+e.kty+'",',t+='"n":"'+e.n+'"}'}else if("EC"===e.kty){if("string"!=typeof e.crv||"string"!=typeof e.x||"string"!=typeof e.y)throw"wrong crv, x and y value for EC key";t+='"crv":"'+e.crv+'",',t+='"kty":"'+e.kty+'",',t+='"x":"'+e.x+'",',t+='"y":"'+e.y+'"}'}else if("oct"===e.kty){if("string"!=typeof e.k)throw"wrong k value for oct(symmetric) key";t+='"kty":"'+e.kty+'",',t+='"k":"'+e.k+'"}'}var r=lr(t);return ir(cn.crypto.Util.hashHex(r,"sha256"))},cn.jws.IntDate={},cn.jws.IntDate.get=function(e){var t=cn.jws.IntDate,r=t.getNow,n=t.getZulu;if("now"==e)return r();if("now + 1hour"==e)return r()+3600;if("now + 1day"==e)return r()+86400;if("now + 1month"==e)return r()+2592e3;if("now + 1year"==e)return r()+31536e3;if(e.match(/Z$/))return n(e);if(e.match(/^[0-9]+$/))return parseInt(e);throw"unsupported format: "+e},cn.jws.IntDate.getZulu=function(e){return _r(e)},cn.jws.IntDate.getNow=function(){return~~(new Date/1e3)},cn.jws.IntDate.intDate2UTCString=function(e){return new Date(1e3*e).toUTCString()},cn.jws.IntDate.intDate2Zulu=function(e){var t=new Date(1e3*e);return("0000"+t.getUTCFullYear()).slice(-4)+("00"+(t.getUTCMonth()+1)).slice(-2)+("00"+t.getUTCDate()).slice(-2)+("00"+t.getUTCHours()).slice(-2)+("00"+t.getUTCMinutes()).slice(-2)+("00"+t.getUTCSeconds()).slice(-2)+"Z"},t.SecureRandom=ft,t.rng_seed_time=ct,t.BigInteger=s,t.RSAKey=yt,t.ECDSA=cn.crypto.ECDSA,t.DSA=cn.crypto.DSA,t.Signature=cn.crypto.Signature,t.MessageDigest=cn.crypto.MessageDigest,t.Mac=cn.crypto.Mac,t.Cipher=cn.crypto.Cipher,t.KEYUTIL=pn,t.ASN1HEX=un,t.X509=Nr,t.CryptoJS=Kr,t.b64tohex=n,t.b64toBA=i,t.stoBA=zt,t.BAtos=Xt,t.BAtohex=Zt,t.stohex=Qt,t.stob64=$t,t.stob64u=er,t.b64utos=tr,t.b64tob64u=rr,t.b64utob64=nr,t.hex2b64=r,t.hextob64u=ir,t.b64utohex=or,t.utf8tob64u=hn,t.b64utoutf8=ln,t.utf8tob64=sr,t.b64toutf8=ar,t.utf8tohex=ur,t.hextoutf8=cr,t.hextorstr=hr,t.rstrtohex=lr,t.hextob64=fr,t.hextob64nl=pr,t.b64nltohex=dr,t.hextopem=gr,t.pemtohex=vr,t.hextoArrayBuffer=yr,t.ArrayBuffertohex=mr,t.zulutomsec=Sr,t.zulutosec=_r,t.zulutodate=Fr,t.datetozulu=br,t.uricmptohex=wr,t.hextouricmp=Er,t.ipv6tohex=xr,t.hextoipv6=Ar,t.hextoip=Pr,t.iptohex=Cr,t.encodeURIComponentAll=kr,t.newline_toUnix=Rr,t.newline_toDos=Tr,t.hextoposhex=Ir,t.intarystrtohex=Ur,t.strdiffidx=fn,t.KJUR=cn,t.crypto=cn.crypto,t.asn1=cn.asn1,t.jws=cn.jws,t.lang=cn.lang}).call(this,r("./node_modules/buffer/index.js").Buffer)},"./node_modules/base64-js/index.js":function(e,t,r){function n(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function i(e){var t=n(e),r=t[0],i=t[1];return 3*(r+i)/4-i}function o(e,t,r){return 3*(t+r)/4-r}function s(e){for(var t,r=n(e),i=r[0],s=r[1],a=new f(o(e,i,s)),u=0,c=s>0?i-4:i,h=0;h<c;h+=4)t=l[e.charCodeAt(h)]<<18|l[e.charCodeAt(h+1)]<<12|l[e.charCodeAt(h+2)]<<6|l[e.charCodeAt(h+3)],a[u++]=t>>16&255,a[u++]=t>>8&255,a[u++]=255&t;return 2===s&&(t=l[e.charCodeAt(h)]<<2|l[e.charCodeAt(h+1)]>>4,a[u++]=255&t),1===s&&(t=l[e.charCodeAt(h)]<<10|l[e.charCodeAt(h+1)]<<4|l[e.charCodeAt(h+2)]>>2,a[u++]=t>>8&255,a[u++]=255&t),a}function a(e){return h[e>>18&63]+h[e>>12&63]+h[e>>6&63]+h[63&e]}function u(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(a(n));return i.join("")}function c(e){for(var t,r=e.length,n=r%3,i=[],o=0,s=r-n;o<s;o+=16383)i.push(u(e,o,o+16383>s?s:o+16383));return 1===n?(t=e[r-1],i.push(h[t>>2]+h[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(h[t>>10]+h[t>>4&63]+h[t<<2&63]+"=")),i.join("")}t.byteLength=i,t.toByteArray=s,t.fromByteArray=c;for(var h=[],l=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,g=p.length;d<g;++d)h[d]=p[d],l[p.charCodeAt(d)]=d;l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},"./node_modules/buffer/index.js":function(e,t,r){(function(e){function n(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,r){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return s(this,e,t,r)}function s(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?f(e,t,r,n):"string"==typeof t?h(e,t,r):p(e,t)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,r,n){return a(t),t<=0?i(e,t):void 0!==r?"string"==typeof n?i(e,t).fill(r,n):i(e,t).fill(r):i(e,t)}function c(e,t){if(a(t),e=i(e,t<0?0:0|d(t)),!o.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function h(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!o.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|v(t,r);e=i(e,n);var s=e.write(t,r);return s!==n&&(e=e.slice(0,s)),e}function l(e,t){var r=t.length<0?0:0|d(t.length);e=i(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function f(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=l(e,t),e}function p(e,t){if(o.isBuffer(t)){var r=0|d(t.length);return e=i(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||z(t.length)?i(e,0):l(e,t);if("Buffer"===t.type&&Q(t.data))return l(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function d(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function g(e){return+e!=e&&(e=0),o.alloc(+e)}function v(e,t){if(o.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Y(e).length;default:if(n)return V(e).length;t=(""+t).toLowerCase(),n=!0}}function y(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return R(this,t,r);case"latin1":case"binary":return T(this,t,r);case"base64":return P(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function m(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function S(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:_(e,t,r,n,i);if("number"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):_(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function _(e,t,r,n,i){function o(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}var c;if(i){var h=-1;for(c=r;c<a;c++)if(o(e,c)===o(t,-1===h?0:c-h)){if(-1===h&&(h=c),c-h+1===u)return h*s}else-1!==h&&(c-=c-h),h=-1}else for(r+u>a&&(r=a-u),c=r;c>=0;c--){for(var l=!0,f=0;f<u;f++)if(o(e,c+f)!==o(t,f)){l=!1;break}if(l)return c}return-1}function F(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function b(e,t,r,n){return G(V(t,e.length-r),e,r,n)}function w(e,t,r,n){return G(W(t),e,r,n)}function E(e,t,r,n){return w(e,t,r,n)}function x(e,t,r,n){return G(Y(t),e,r,n)}function A(e,t,r,n){return G(J(t,e.length-r),e,r,n)}function P(e,t,r){return 0===t&&r===e.length?X.fromByteArray(e):X.fromByteArray(e.slice(t,r))}function C(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){var u,c,h,l;switch(a){case 1:o<128&&(s=o);break;case 2:128==(192&(u=e[i+1]))&&(l=(31&o)<<6|63&u)>127&&(s=l);break;case 3:u=e[i+1],c=e[i+2],128==(192&u)&&128==(192&c)&&(l=(15&o)<<12|(63&u)<<6|63&c)>2047&&(l<55296||l>57343)&&(s=l);break;case 4:u=e[i+1],c=e[i+2],h=e[i+3],128==(192&u)&&128==(192&c)&&128==(192&h)&&(l=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&h)>65535&&l<1114112&&(s=l)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=a}return k(n)}function k(e){var t=e.length;if(t<=$)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=$));return r}function R(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function T(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function I(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=q(e[o]);return i}function U(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function j(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function O(e,t,r,n,i,s){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function N(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function D(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function M(e,t,r,n,i){return i||D(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),Z.write(e,t,r,n,23,4),r+4}function B(e,t,r,n,i){return i||D(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),Z.write(e,t,r,n,52,8),r+8}function H(e){if(e=K(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function K(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function q(e){return e<16?"0"+e.toString(16):e.toString(16)}function V(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function W(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function J(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function Y(e){return X.toByteArray(H(e))}function G(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function z(e){return e!==e}var X=r("./node_modules/base64-js/index.js"),Z=r("./node_modules/ieee754/index.js"),Q=r("./node_modules/buffer/node_modules/isarray/index.js");t.Buffer=o,t.SlowBuffer=g,t.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=n(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,r){return s(null,e,t,r)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,r){return u(null,e,t,r)},o.allocUnsafe=function(e){return c(null,e)},o.allocUnsafeSlow=function(e){return c(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=o.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},o.byteLength=v,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):y.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,r,n,i){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var s=i-n,a=r-t,u=Math.min(s,a),c=this.slice(n,i),h=e.slice(t,r),l=0;l<u;++l)if(c[l]!==h[l]){s=c[l],a=h[l];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return S(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return S(this,e,t,r,!1)},o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return F(this,e,t,r);case"utf8":case"utf-8":return b(this,e,t,r);case"ascii":return w(this,e,t,r);case"latin1":case"binary":return E(this,e,t,r);case"base64":return x(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n;if(o.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=o.prototype;else{var i=t-e;n=new o(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+e]}return n},o.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||j(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},o.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||j(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUInt8=function(e,t){return t||j(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||j(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||j(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||j(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||j(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||j(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||j(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||j(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||j(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){t||j(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return t||j(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||j(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||j(e,4,this.length),Z.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||j(e,4,this.length),Z.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||j(e,8,this.length),Z.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||j(e,8,this.length),Z.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,n){e=+e,t|=0,r|=0,n||O(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,n){e=+e,t|=0,r|=0,n||O(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):N(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);O(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);O(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):N(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||O(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):N(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,r){return M(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return M(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return B(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return B(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,s=n-r;if(this===e&&r<t&&t<n)for(i=s-1;i>=0;--i)e[i+t]=this[i+r];else if(s<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+s),t);return s},o.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var s;if("number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{var a=o.isBuffer(e)?e:V(new o(e,n).toString()),u=a.length;for(s=0;s<r-t;++s)this[s+t]=a[s%u]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(this,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/buffer/node_modules/isarray/index.js":function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},"./node_modules/ieee754/index.js":function(e,t){t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,c=u>>1,h=-7,l=r?i-1:0,f=r?-1:1,p=e[t+l];for(l+=f,o=p&(1<<-h)-1,p>>=-h,h+=a;h>0;o=256*o+e[t+l],l+=f,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+e[t+l],l+=f,h-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=c}return(p?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,u,c=8*o-i-1,h=(1<<c)-1,l=h>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=h):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),t+=s+l>=1?f/u:f*Math.pow(2,1-l),t*u>=2&&(s++,u/=2),s+l>=h?(a=0,s=h):s+l>=1?(a=(t*u-1)*Math.pow(2,i),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;e[r+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+p]=255&s,p+=d,s/=256,c-=8);e[r+p-d]|=128*g}},"./node_modules/webpack/buildin/global.js":function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":o(window))&&(r=window)}e.exports=r},"./src/AccessTokenEvents.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.AccessTokenEvents=void 0;var i=r("./src/Log.js"),o=r("./src/Timer.js");t.AccessTokenEvents=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.accessTokenExpiringNotificationTime,i=void 0===r?60:r,s=t.accessTokenExpiringTimer,a=void 0===s?new o.Timer("Access token expiring"):s,u=t.accessTokenExpiredTimer,c=void 0===u?new o.Timer("Access token expired"):u;n(this,e),this._accessTokenExpiringNotificationTime=i,this._accessTokenExpiring=a,this._accessTokenExpired=c}return e.prototype.load=function(e){if(e.access_token&&void 0!==e.expires_in){var t=e.expires_in;if(i.Log.debug("AccessTokenEvents.load: access token present, remaining duration:",t),t>0){var r=t-this._accessTokenExpiringNotificationTime;r<=0&&(r=1),i.Log.debug("AccessTokenEvents.load: registering expiring timer in:",r),this._accessTokenExpiring.init(r)}else i.Log.debug("AccessTokenEvents.load: canceling existing expiring timer becase we're past expiration."),this._accessTokenExpiring.cancel();var n=t+1;i.Log.debug("AccessTokenEvents.load: registering expired timer in:",n),this._accessTokenExpired.init(n)}else this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},e.prototype.unload=function(){i.Log.debug("AccessTokenEvents.unload: canceling existing access token timers"),this._accessTokenExpiring.cancel(),this._accessTokenExpired.cancel()},e.prototype.addAccessTokenExpiring=function(e){this._accessTokenExpiring.addHandler(e)},e.prototype.removeAccessTokenExpiring=function(e){this._accessTokenExpiring.removeHandler(e)},e.prototype.addAccessTokenExpired=function(e){this._accessTokenExpired.addHandler(e)},e.prototype.removeAccessTokenExpired=function(e){this._accessTokenExpired.removeHandler(e)},e}()},"./src/CheckSessionIFrame.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CheckSessionIFrame=void 0;var i=r("./src/Log.js");t.CheckSessionIFrame=function(){function e(t,r,i,o){var s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];n(this,e),this._callback=t,this._client_id=r,this._url=i,this._interval=o||2e3,this._stopOnError=s;var a=i.indexOf("/",i.indexOf("//")+2);this._frame_origin=i.substr(0,a),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.style.width=0,this._frame.style.height=0,this._frame.src=i}return e.prototype.load=function(){var e=this;return new Promise(function(t){e._frame.onload=function(){t()},window.document.body.appendChild(e._frame),e._boundMessageEvent=e._message.bind(e),window.addEventListener("message",e._boundMessageEvent,!1)})},e.prototype._message=function(e){e.origin===this._frame_origin&&e.source===this._frame.contentWindow&&("error"===e.data?(i.Log.error("CheckSessionIFrame: error message from check session op iframe"),this._stopOnError&&this.stop()):"changed"===e.data?(i.Log.debug("CheckSessionIFrame: changed message from check session op iframe"),this.stop(),this._callback()):i.Log.debug("CheckSessionIFrame: "+e.data+" message from check session op iframe"))},e.prototype.start=function(e){var t=this;if(this._session_state!==e){i.Log.debug("CheckSessionIFrame.start"),this.stop(),this._session_state=e;var r=function(){t._frame.contentWindow.postMessage(t._client_id+" "+t._session_state,t._frame_origin)};r(),this._timer=window.setInterval(r,this._interval)}},e.prototype.stop=function(){this._session_state=null,this._timer&&(i.Log.debug("CheckSessionIFrame.stop"),window.clearInterval(this._timer),this._timer=null)},e}()},"./src/CordovaIFrameNavigator.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaIFrameNavigator=void 0;var i=r("./src/CordovaPopupWindow.js");t.CordovaIFrameNavigator=function(){function e(){n(this,e)}return e.prototype.prepare=function(e){e.popupWindowFeatures="hidden=yes";var t=new i.CordovaPopupWindow(e);return Promise.resolve(t)},e}()},"./src/CordovaPopupNavigator.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaPopupNavigator=void 0;var i=r("./src/CordovaPopupWindow.js");t.CordovaPopupNavigator=function(){function e(){n(this,e)}return e.prototype.prepare=function(e){var t=new i.CordovaPopupWindow(e);return Promise.resolve(t)},e}()},"./src/CordovaPopupWindow.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CordovaPopupWindow=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r("./src/Log.js");t.CordovaPopupWindow=function(){function e(t){var r=this;n(this,e),this._promise=new Promise(function(e,t){r._resolve=e,r._reject=t}),this.features=t.popupWindowFeatures||"location=no,toolbar=no,zoom=no",this.target=t.popupWindowTarget||"_blank",this.redirect_uri=t.startUrl,o.Log.debug("CordovaPopupWindow.ctor: redirect_uri: "+this.redirect_uri)}return e.prototype._isInAppBrowserInstalled=function(e){return["cordova-plugin-inappbrowser","cordova-plugin-inappbrowser.inappbrowser","org.apache.cordova.inappbrowser"].some(function(t){return e.hasOwnProperty(t)})},e.prototype.navigate=function(e){if(e&&e.url){if(!window.cordova)return this._error("cordova is undefined");var t=window.cordova.require("cordova/plugin_list").metadata;if(!1===this._isInAppBrowserInstalled(t))return this._error("InAppBrowser plugin not found");this._popup=cordova.InAppBrowser.open(e.url,this.target,this.features),this._popup?(o.Log.debug("CordovaPopupWindow.navigate: popup successfully created"),this._exitCallbackEvent=this._exitCallback.bind(this),this._loadStartCallbackEvent=this._loadStartCallback.bind(this),this._popup.addEventListener("exit",this._exitCallbackEvent,!1),this._popup.addEventListener("loadstart",this._loadStartCallbackEvent,!1)):this._error("Error opening popup window")}else this._error("No url provided");return this.promise},e.prototype._loadStartCallback=function(e){0===e.url.indexOf(this.redirect_uri)&&this._success({url:e.url})},e.prototype._exitCallback=function(e){this._error(e)},e.prototype._success=function(e){this._cleanup(),o.Log.debug("CordovaPopupWindow: Successful response from cordova popup window"),this._resolve(e)},e.prototype._error=function(e){this._cleanup(),o.Log.error(e),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup()},e.prototype._cleanup=function(){this._popup&&(o.Log.debug("CordovaPopupWindow: cleaning up popup"),this._popup.removeEventListener("exit",this._exitCallbackEvent,!1),this._popup.removeEventListener("loadstart",this._loadStartCallbackEvent,!1),this._popup.close()),this._popup=null},i(e,[{key:"promise",get:function(){return this._promise}}]),e}()},"./src/ErrorResponse.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":o(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":o(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorResponse=void 0;var a=r("./src/Log.js");t.ErrorResponse=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.error,s=r.error_description,u=r.error_uri,c=r.state;if(n(this,t),!o)throw a.Log.error("No error passed to ErrorResponse"),new Error("error");var h=i(this,e.call(this,s||o));return h.name="ErrorResponse",h.error=o,h.error_description=s,h.error_uri=u,h.state=c,h}return s(t,e),t}(Error)},"./src/Event.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var i=r("./src/Log.js");t.Event=function(){function e(t){n(this,e),this._name=t,this._callbacks=[]}return e.prototype.addHandler=function(e){this._callbacks.push(e)},e.prototype.removeHandler=function(e){var t=this._callbacks.findIndex(function(t){return t===e});t>=0&&this._callbacks.splice(t,1)},e.prototype.raise=function(){i.Log.debug("Event: Raising event: "+this._name);for(var e=0;e<this._callbacks.length;e++){var t;(t=this._callbacks)[e].apply(t,arguments)}},e}()},"./src/Global.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o={setInterval:function(e){function t(t,r){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){return setInterval(e,t)}),clearInterval:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return clearInterval(e)})},s=!1,a=null;t.Global=function(){function e(){n(this,e)}return e._testing=function(){s=!0},e.setXMLHttpRequest=function(e){a=e},i(e,null,[{key:"location",get:function(){if(!s)return location}},{key:"localStorage",get:function(){if(!s&&"undefined"!=typeof window)return localStorage}},{key:"sessionStorage",get:function(){if(!s&&"undefined"!=typeof window)return sessionStorage}},{key:"XMLHttpRequest",get:function(){if(!s&&"undefined"!=typeof window)return a||XMLHttpRequest}},{key:"timer",get:function(){if(!s)return o}}]),e}()},"./src/IFrameNavigator.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.IFrameNavigator=void 0;var i=r("./src/Log.js"),o=r("./src/IFrameWindow.js");t.IFrameNavigator=function(){function e(){n(this,e)}return e.prototype.prepare=function(e){var t=new o.IFrameWindow(e);return Promise.resolve(t)},e.prototype.callback=function(e){i.Log.debug("IFrameNavigator.callback");try{return o.IFrameWindow.notifyParent(e),Promise.resolve()}catch(e){return Promise.reject(e)}},e}()},"./src/IFrameWindow.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.IFrameWindow=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r("./src/Log.js");t.IFrameWindow=function(){function e(t){var r=this;n(this,e),this._promise=new Promise(function(e,t){r._resolve=e,r._reject=t}),this._boundMessageEvent=this._message.bind(this),window.addEventListener("message",this._boundMessageEvent,!1),this._frame=window.document.createElement("iframe"),this._frame.style.visibility="hidden",this._frame.style.position="absolute",this._frame.style.display="none",this._frame.style.width=0,this._frame.style.height=0,window.document.body.appendChild(this._frame)}return e.prototype.navigate=function(e){if(e&&e.url){var t=e.silentRequestTimeout||1e4;o.Log.debug("IFrameWindow.navigate: Using timeout of:",t),this._timer=window.setTimeout(this._timeout.bind(this),t),this._frame.src=e.url}else this._error("No url provided");return this.promise},e.prototype._success=function(e){this._cleanup(),o.Log.debug("IFrameWindow: Successful response from frame window"),this._resolve(e)},e.prototype._error=function(e){this._cleanup(),o.Log.error(e),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup()},e.prototype._cleanup=function(){this._frame&&(o.Log.debug("IFrameWindow: cleanup"),window.removeEventListener("message",this._boundMessageEvent,!1),window.clearTimeout(this._timer),window.document.body.removeChild(this._frame),this._timer=null,this._frame=null,this._boundMessageEvent=null)},e.prototype._timeout=function(){o.Log.debug("IFrameWindow.timeout"),this._error("Frame window timed out")},e.prototype._message=function(e){if(o.Log.debug("IFrameWindow.message"),this._timer&&e.origin===this._origin&&e.source===this._frame.contentWindow){var t=e.data;t?this._success({url:t}):this._error("Invalid response from frame")}},e.notifyParent=function(e){o.Log.debug("IFrameWindow.notifyParent"),window.parent&&window!==window.parent&&(e=e||window.location.href)&&(o.Log.debug("IFrameWindow.notifyParent: posting url message to parent"),window.parent.postMessage(e,location.protocol+"//"+location.host))},i(e,[{key:"promise",get:function(){return this._promise}},{key:"_origin",get:function(){return location.protocol+"//"+location.host}}]),e}()},"./src/InMemoryWebStorage.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.InMemoryWebStorage=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r("./src/Log.js");t.InMemoryWebStorage=function(){function e(){n(this,e),this._data={}}return e.prototype.getItem=function(e){return o.Log.debug("InMemoryWebStorage.getItem",e),this._data[e]},e.prototype.setItem=function(e,t){o.Log.debug("InMemoryWebStorage.setItem",e),this._data[e]=t},e.prototype.removeItem=function(e){o.Log.debug("InMemoryWebStorage.removeItem",e),delete this._data[e]},e.prototype.key=function(e){return Object.getOwnPropertyNames(this._data)[e]},i(e,[{key:"length",get:function(){return Object.getOwnPropertyNames(this._data).length}}]),e}()},"./src/JoseUtil.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.JoseUtil=void 0;var i=r("./jsrsasign/dist/jsrsasign.js"),o=r("./src/Log.js"),s=["RS256","RS384","RS512","PS256","PS384","PS512","ES256","ES384","ES512"];t.JoseUtil=function(){function e(){n(this,e)}return e.parseJwt=function(e){o.Log.debug("JoseUtil.parseJwt");try{var t=i.jws.JWS.parse(e);return{header:t.headerObj,payload:t.payloadObj}}catch(e){o.Log.error(e)}},e.validateJwt=function(t,r,n,s,a,u){o.Log.debug("JoseUtil.validateJwt");try{if("RSA"===r.kty)if(r.e&&r.n)r=i.KEYUTIL.getKey(r);else{if(!r.x5c||!r.x5c.length)return o.Log.error("JoseUtil.validateJwt: RSA key missing key material",r),Promise.reject(new Error("RSA key missing key material"));var c=(0,i.b64tohex)(r.x5c[0]);r=i.X509.getPublicKeyFromCertHex(c)}else{if("EC"!==r.kty)return o.Log.error("JoseUtil.validateJwt: Unsupported key type",r&&r.kty),Promise.reject(new Error("Unsupported key type: "+r&&r.kty));if(!(r.crv&&r.x&&r.y))return o.Log.error("JoseUtil.validateJwt: EC key missing key material",r),Promise.reject(new Error("EC key missing key material"));r=i.KEYUTIL.getKey(r)}return e._validateJwt(t,r,n,s,a,u)}catch(e){return o.Log.error(e&&e.message||e),Promise.reject("JWT validation failed")}},e._validateJwt=function(t,r,n,a,u,c){u||(u=0),c||(c=parseInt(Date.now()/1e3));var h=e.parseJwt(t).payload;if(!h.iss)return o.Log.error("JoseUtil._validateJwt: issuer was not provided"),Promise.reject(new Error("issuer was not provided"));if(h.iss!==n)return o.Log.error("JoseUtil._validateJwt: Invalid issuer in token",h.iss),Promise.reject(new Error("Invalid issuer in token: "+h.iss));if(!h.aud)return o.Log.error("JoseUtil._validateJwt: aud was not provided"),Promise.reject(new Error("aud was not provided"));if(!(h.aud===a||Array.isArray(h.aud)&&h.aud.indexOf(a)>=0))return o.Log.error("JoseUtil._validateJwt: Invalid audience in token",h.aud),Promise.reject(new Error("Invalid audience in token: "+h.aud));var l=c+u,f=c-u;if(!h.iat)return o.Log.error("JoseUtil._validateJwt: iat was not provided"),Promise.reject(new Error("iat was not provided"));if(l<h.iat)return o.Log.error("JoseUtil._validateJwt: iat is in the future",h.iat),Promise.reject(new Error("iat is in the future: "+h.iat));if(h.nbf&&l<h.nbf)return o.Log.error("JoseUtil._validateJwt: nbf is in the future",h.nbf),Promise.reject(new Error("nbf is in the future: "+h.nbf));if(!h.exp)return o.Log.error("JoseUtil._validateJwt: exp was not provided"),Promise.reject(new Error("exp was not provided"));if(h.exp<f)return o.Log.error("JoseUtil._validateJwt: exp is in the past",h.exp),Promise.reject(new Error("exp is in the past:"+h.exp));try{if(!i.jws.JWS.verify(t,r,s))return o.Log.error("JoseUtil._validateJwt: signature validation failed"),Promise.reject(new Error("signature validation failed"))}catch(e){return o.Log.error(e&&e.message||e),Promise.reject(new Error("signature validation failed"))}return Promise.resolve()},e.hashString=function(e,t){try{return i.crypto.Util.hashString(e,t)}catch(e){o.Log.error(e)}},e.hexToBase64Url=function(e){try{return(0,i.hextob64u)(e)}catch(e){o.Log.error(e)}},e}()},"./src/JsonService.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.JsonService=void 0;var i=r("./src/Log.js"),o=r("./src/Global.js");t.JsonService=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.Global.XMLHttpRequest;n(this,e),t&&Array.isArray(t)?this._contentTypes=t.slice():this._contentTypes=[],this._contentTypes.push("application/json"),this._XMLHttpRequest=r}return e.prototype.getJson=function(e,t){var r=this;if(!e)throw i.Log.error("JsonService.getJson: No url passed"),new Error("url");return i.Log.debug("JsonService.getJson, url: ",e),new Promise(function(n,o){var s=new r._XMLHttpRequest;s.open("GET",e);var a=r._contentTypes;s.onload=function(){if(i.Log.debug("JsonService.getJson: HTTP response received, status",s.status),200===s.status){var t=s.getResponseHeader("Content-Type");if(t&&a.find(function(e){if(t.startsWith(e))return!0}))try{return void n(JSON.parse(s.responseText))}catch(e){return i.Log.error("JsonService.getJson: Error parsing JSON response",e.message),void o(e)}o(Error("Invalid response Content-Type: "+t+", from URL: "+e))}else o(Error(s.statusText+" ("+s.status+")"))},s.onerror=function(){i.Log.error("JsonService.getJson: network error"),o(Error("Network Error"))},t&&(i.Log.debug("JsonService.getJson: token passed, setting Authorization header"),s.setRequestHeader("Authorization","Bearer "+t)),s.send()})},e}()},"./src/Log.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o={debug:function(){},info:function(){},warn:function(){},error:function(){}},s=void 0,a=void 0;(t.Log=function(){function e(){n(this,e)}return e.reset=function(){a=3,s=o},e.debug=function(){if(a>=4){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s.debug.apply(s,Array.from(t))}},e.info=function(){if(a>=3){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s.info.apply(s,Array.from(t))}},e.warn=function(){if(a>=2){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s.warn.apply(s,Array.from(t))}},e.error=function(){if(a>=1){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];s.error.apply(s,Array.from(t))}},i(e,null,[{key:"NONE",get:function(){return 0}},{key:"ERROR",get:function(){return 1}},{key:"WARN",get:function(){return 2}},{key:"INFO",get:function(){return 3}},{key:"DEBUG",get:function(){return 4}},{key:"level",get:function(){return a},set:function(e){if(!(0<=e&&e<=4))throw new Error("Invalid log level");a=e}},{key:"logger",get:function(){return s},set:function(e){if(!e.debug&&e.info&&(e.debug=e.info),!(e.debug&&e.info&&e.warn&&e.error))throw new Error("Invalid logger");s=e}}]),e}()).reset()},"./src/MetadataService.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataService=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r("./src/Log.js"),s=r("./src/JsonService.js");t.MetadataService=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.JsonService;if(n(this,e),!t)throw o.Log.error("MetadataService: No settings passed to MetadataService"),new Error("settings");this._settings=t,this._jsonService=new r(["application/jwk-set+json"])}return e.prototype.getMetadata=function(){var e=this;return this._settings.metadata?(o.Log.debug("MetadataService.getMetadata: Returning metadata from settings"),Promise.resolve(this._settings.metadata)):this.metadataUrl?(o.Log.debug("MetadataService.getMetadata: getting metadata from",this.metadataUrl),this._jsonService.getJson(this.metadataUrl).then(function(t){return o.Log.debug("MetadataService.getMetadata: json received"),e._settings.metadata=t,t})):(o.Log.error("MetadataService.getMetadata: No authority or metadataUrl configured on settings"),Promise.reject(new Error("No authority or metadataUrl configured on settings")))},e.prototype.getIssuer=function(){return this._getMetadataProperty("issuer")},e.prototype.getAuthorizationEndpoint=function(){return this._getMetadataProperty("authorization_endpoint")},e.prototype.getUserInfoEndpoint=function(){return this._getMetadataProperty("userinfo_endpoint")},e.prototype.getTokenEndpoint=function(){return this._getMetadataProperty("token_endpoint",!0)},e.prototype.getCheckSessionIframe=function(){return this._getMetadataProperty("check_session_iframe",!0)},e.prototype.getEndSessionEndpoint=function(){return this._getMetadataProperty("end_session_endpoint",!0)},e.prototype.getRevocationEndpoint=function(){return this._getMetadataProperty("revocation_endpoint",!0)},e.prototype._getMetadataProperty=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return o.Log.debug("MetadataService.getMetadataProperty for: "+e),this.getMetadata().then(function(r){if(o.Log.debug("MetadataService.getMetadataProperty: metadata recieved"),void 0===r[e]){if(!0===t)return void o.Log.warn("MetadataService.getMetadataProperty: Metadata does not contain optional property "+e);throw o.Log.error("MetadataService.getMetadataProperty: Metadata does not contain property "+e),new Error("Metadata does not contain property "+e)}return r[e]})},e.prototype.getSigningKeys=function(){var e=this;return this._settings.signingKeys?(o.Log.debug("MetadataService.getSigningKeys: Returning signingKeys from settings"),Promise.resolve(this._settings.signingKeys)):this._getMetadataProperty("jwks_uri").then(function(t){return o.Log.debug("MetadataService.getSigningKeys: jwks_uri received",t),e._jsonService.getJson(t).then(function(t){if(o.Log.debug("MetadataService.getSigningKeys: key set received",t),!t.keys)throw o.Log.error("MetadataService.getSigningKeys: Missing keys on keyset"),new Error("Missing keys on keyset");return e._settings.signingKeys=t.keys,e._settings.signingKeys})})},i(e,[{key:"metadataUrl",get:function(){return this._metadataUrl||(this._settings.metadataUrl?this._metadataUrl=this._settings.metadataUrl:(this._metadataUrl=this._settings.authority,this._metadataUrl&&this._metadataUrl.indexOf(".well-known/openid-configuration")<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=".well-known/openid-configuration"))),this._metadataUrl}}]),e}()},"./src/OidcClient.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.OidcClient=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r("./src/Log.js"),s=r("./src/OidcClientSettings.js"),a=r("./src/ErrorResponse.js"),u=r("./src/SigninRequest.js"),c=r("./src/SigninResponse.js"),h=r("./src/SignoutRequest.js"),l=r("./src/SignoutResponse.js"),f=r("./src/SigninState.js"),p=r("./src/State.js");t.OidcClient=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),t instanceof s.OidcClientSettings?this._settings=t:this._settings=new s.OidcClientSettings(t)}return e.prototype.createSigninRequest=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.response_type,n=t.scope,i=t.redirect_uri,s=t.data,a=t.state,c=t.prompt,h=t.display,l=t.max_age,f=t.ui_locales,p=t.id_token_hint,d=t.login_hint,g=t.acr_values,v=t.resource,y=t.request,m=t.request_uri,S=t.extraQueryParams,_=arguments[1];o.Log.debug("OidcClient.createSigninRequest");var F=this._settings.client_id;r=r||this._settings.response_type,n=n||this._settings.scope,i=i||this._settings.redirect_uri,c=c||this._settings.prompt,h=h||this._settings.display,l=l||this._settings.max_age,f=f||this._settings.ui_locales,g=g||this._settings.acr_values,v=v||this._settings.resource,S=S||this._settings.extraQueryParams;var b=this._settings.authority;return this._metadataService.getAuthorizationEndpoint().then(function(t){o.Log.debug("OidcClient.createSigninRequest: Received authorization endpoint",t);var w=new u.SigninRequest({url:t,client_id:F,redirect_uri:i,response_type:r,scope:n,data:s||a,authority:b,prompt:c,display:h,max_age:l,ui_locales:f,id_token_hint:p,login_hint:d,acr_values:g,resource:v,request:y,request_uri:m,extraQueryParams:S}),E=w.state;return _=_||e._stateStore,_.set(E.id,E.toStorageString()).then(function(){return w})})},e.prototype.processSigninResponse=function(e,t){var r=this;o.Log.debug("OidcClient.processSigninResponse");var n=new c.SigninResponse(e);return n.state?(t=t||this._stateStore,t.remove(n.state).then(function(e){if(!e)throw o.Log.error("OidcClient.processSigninResponse: No matching state found in storage"),new Error("No matching state found in storage");var t=f.SigninState.fromStorageString(e);return o.Log.debug("OidcClient.processSigninResponse: Received state from storage; validating response"),r._validator.validateSigninResponse(t,n)})):(o.Log.error("OidcClient.processSigninResponse: No state in response"),Promise.reject(new Error("No state in response")))},e.prototype.createSignoutRequest=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id_token_hint,n=t.data,i=t.state,s=t.post_logout_redirect_uri,a=arguments[1];return o.Log.debug("OidcClient.createSignoutRequest"),s=s||this._settings.post_logout_redirect_uri,this._metadataService.getEndSessionEndpoint().then(function(t){if(!t)throw o.Log.error("OidcClient.createSignoutRequest: No end session endpoint url returned"),new Error("no end session endpoint");o.Log.debug("OidcClient.createSignoutRequest: Received end session endpoint",t);var u=new h.SignoutRequest({url:t,id_token_hint:r,post_logout_redirect_uri:s,data:n||i}),c=u.state;return c&&(o.Log.debug("OidcClient.createSignoutRequest: Signout request has state to persist"),a=a||e._stateStore,a.set(c.id,c.toStorageString())),u})},e.prototype.processSignoutResponse=function(e,t){var r=this;o.Log.debug("OidcClient.processSignoutResponse");var n=new l.SignoutResponse(e);if(!n.state)return o.Log.debug("OidcClient.processSignoutResponse: No state in response"),n.error?(o.Log.warn("OidcClient.processSignoutResponse: Response was error: ",n.error),Promise.reject(new a.ErrorResponse(n))):Promise.resolve(n);var i=n.state;return t=t||this._stateStore,t.remove(i).then(function(e){if(!e)throw o.Log.error("OidcClient.processSignoutResponse: No matching state found in storage"),new Error("No matching state found in storage");var t=p.State.fromStorageString(e);return o.Log.debug("OidcClient.processSignoutResponse: Received state from storage; validating response"),r._validator.validateSignoutResponse(t,n)})},e.prototype.clearStaleState=function(e){return o.Log.debug("OidcClient.clearStaleState"),e=e||this._stateStore,p.State.clearStaleState(e,this.settings.staleStateAge)},i(e,[{key:"_stateStore",get:function(){return this.settings.stateStore}},{key:"_validator",get:function(){return this.settings.validator}},{key:"_metadataService",get:function(){return this.settings.metadataService}},{key:"settings",get:function(){return this._settings}},{key:"metadataService",get:function(){return this._metadataService}}]),e}()},"./src/OidcClientSettings.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.OidcClientSettings=void 0;var i="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return void 0===e?"undefined":o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":o(e)},s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r("./src/Log.js"),u=r("./src/WebStorageStateStore.js"),c=r("./src/ResponseValidator.js"),h=r("./src/MetadataService.js");t.OidcClientSettings=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.authority,o=t.metadataUrl,s=t.metadata,a=t.signingKeys,l=t.client_id,f=t.client_secret,p=t.response_type,d=void 0===p?"id_token":p,g=t.scope,v=void 0===g?"openid":g,y=t.redirect_uri,m=t.post_logout_redirect_uri,S=t.prompt,_=t.display,F=t.max_age,b=t.ui_locales,w=t.acr_values,E=t.resource,x=t.filterProtocolClaims,A=void 0===x||x,P=t.loadUserInfo,C=void 0===P||P,k=t.staleStateAge,R=void 0===k?900:k,T=t.clockSkew,I=void 0===T?300:T,U=t.stateStore,j=void 0===U?new u.WebStorageStateStore:U,O=t.ResponseValidatorCtor,L=void 0===O?c.ResponseValidator:O,N=t.MetadataServiceCtor,D=void 0===N?h.MetadataService:N,M=t.extraQueryParams,B=void 0===M?{}:M;n(this,e),this._authority=r,this._metadataUrl=o,this._metadata=s,this._signingKeys=a,this._client_id=l,this._client_secret=f,this._response_type=d,this._scope=v,this._redirect_uri=y,this._post_logout_redirect_uri=m,this._prompt=S,this._display=_,this._max_age=F,this._ui_locales=b,this._acr_values=w,this._resource=E,this._filterProtocolClaims=!!A,this._loadUserInfo=!!C,this._staleStateAge=R,this._clockSkew=I,this._stateStore=j,this._validator=new L(this),this._metadataService=new D(this),this._extraQueryParams="object"===(void 0===B?"undefined":i(B))?B:{}}return s(e,[{key:"client_id",get:function(){return this._client_id},set:function(e){if(this._client_id)throw a.Log.error("OidcClientSettings.set_client_id: client_id has already been assigned."),new Error("client_id has already been assigned.");this._client_id=e}},{key:"client_secret",get:function(){return this._client_secret}},{key:"response_type",get:function(){return this._response_type}},{key:"scope",get:function(){return this._scope}},{key:"redirect_uri",get:function(){return this._redirect_uri}},{key:"post_logout_redirect_uri",get:function(){return this._post_logout_redirect_uri}},{key:"prompt",get:function(){return this._prompt}},{key:"display",get:function(){return this._display}},{key:"max_age",get:function(){return this._max_age}},{key:"ui_locales",get:function(){return this._ui_locales}},{key:"acr_values",get:function(){return this._acr_values}},{key:"resource",get:function(){return this._resource}},{key:"authority",get:function(){return this._authority},set:function(e){if(this._authority)throw a.Log.error("OidcClientSettings.set_authority: authority has already been assigned."),new Error("authority has already been assigned.");this._authority=e}},{key:"metadataUrl",get:function(){return this._metadataUrl||(this._metadataUrl=this.authority,this._metadataUrl&&this._metadataUrl.indexOf(".well-known/openid-configuration")<0&&("/"!==this._metadataUrl[this._metadataUrl.length-1]&&(this._metadataUrl+="/"),this._metadataUrl+=".well-known/openid-configuration")),this._metadataUrl}},{key:"metadata",get:function(){return this._metadata},set:function(e){this._metadata=e}},{key:"signingKeys",get:function(){return this._signingKeys},set:function(e){this._signingKeys=e}},{key:"filterProtocolClaims",get:function(){return this._filterProtocolClaims}},{key:"loadUserInfo",get:function(){return this._loadUserInfo}},{key:"staleStateAge",get:function(){return this._staleStateAge}},{key:"clockSkew",get:function(){return this._clockSkew}},{key:"stateStore",get:function(){return this._stateStore}},{key:"validator",get:function(){return this._validator}},{key:"metadataService",get:function(){return this._metadataService}},{key:"extraQueryParams",get:function(){return this._extraQueryParams},set:function(e){"object"===(void 0===e?"undefined":i(e))?this._extraQueryParams=e:this._extraQueryParams={}}}]),e}()},"./src/PopupNavigator.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.PopupNavigator=void 0;var i=r("./src/Log.js"),o=r("./src/PopupWindow.js");t.PopupNavigator=function(){function e(){n(this,e)}return e.prototype.prepare=function(e){var t=new o.PopupWindow(e);return Promise.resolve(t)},e.prototype.callback=function(e,t,r){i.Log.debug("PopupNavigator.callback");try{return o.PopupWindow.notifyOpener(e,t,r),Promise.resolve()}catch(e){return Promise.reject(e)}},e}()},"./src/PopupWindow.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.PopupWindow=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r("./src/Log.js"),s=r("./src/UrlUtility.js");t.PopupWindow=function(){function e(t){var r=this;n(this,e),this._promise=new Promise(function(e,t){r._resolve=e,r._reject=t});var i=t.popupWindowTarget||"_blank",s=t.popupWindowFeatures||"location=no,toolbar=no,width=500,height=500,left=100,top=100;";this._popup=window.open("",i,s),this._popup&&(o.Log.debug("PopupWindow.ctor: popup successfully created"),this._checkForPopupClosedTimer=window.setInterval(this._checkForPopupClosed.bind(this),500))}return e.prototype.navigate=function(e){return this._popup?e&&e.url?(o.Log.debug("PopupWindow.navigate: Setting URL in popup"),this._id=e.id,this._id&&(window["popupCallback_"+e.id]=this._callback.bind(this)),this._popup.focus(),this._popup.window.location=e.url):(this._error("PopupWindow.navigate: no url provided"),this._error("No url provided")):this._error("PopupWindow.navigate: Error opening popup window"),this.promise},e.prototype._success=function(e){o.Log.debug("PopupWindow.callback: Successful response from popup window"),this._cleanup(),this._resolve(e)},e.prototype._error=function(e){o.Log.error("PopupWindow.error: ",e),this._cleanup(),this._reject(new Error(e))},e.prototype.close=function(){this._cleanup(!1)},e.prototype._cleanup=function(e){o.Log.debug("PopupWindow.cleanup"),window.clearInterval(this._checkForPopupClosedTimer),this._checkForPopupClosedTimer=null,delete window["popupCallback_"+this._id],this._popup&&!e&&this._popup.close(),this._popup=null},e.prototype._checkForPopupClosed=function(){this._popup&&!this._popup.closed||this._error("Popup window closed")},e.prototype._callback=function(e,t){this._cleanup(t),e?(o.Log.debug("PopupWindow.callback success"),this._success({url:e})):(o.Log.debug("PopupWindow.callback: Invalid response from popup"),this._error("Invalid response from popup"))},e.notifyOpener=function(e,t,r){if(window.opener){if(e=e||window.location.href){var n=s.UrlUtility.parseUrlFragment(e,r);if(n.state){var i="popupCallback_"+n.state,a=window.opener[i];a?(o.Log.debug("PopupWindow.notifyOpener: passing url message to opener"),a(e,t)):o.Log.warn("PopupWindow.notifyOpener: no matching callback found on opener")}else o.Log.warn("PopupWindow.notifyOpener: no state found in response url")}}else o.Log.warn("PopupWindow.notifyOpener: no window.opener. Can't complete notification.")},i(e,[{key:"promise",get:function(){return this._promise}}]),e}()},"./src/RedirectNavigator.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.RedirectNavigator=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r("./src/Log.js");t.RedirectNavigator=function(){function e(){n(this,e)}return e.prototype.prepare=function(){return Promise.resolve(this)},e.prototype.navigate=function(e){return e&&e.url?(window.location=e.url,Promise.resolve()):(o.Log.error("RedirectNavigator.navigate: No url provided"),Promise.reject(new Error("No url provided")))},i(e,[{key:"url",get:function(){return window.location.href}}]),e}()},"./src/ResponseValidator.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseValidator=void 0;var i=r("./src/Log.js"),o=r("./src/MetadataService.js"),s=r("./src/UserInfoService.js"),a=r("./src/ErrorResponse.js"),u=r("./src/JoseUtil.js"),c=["nonce","at_hash","iat","nbf","exp","aud","iss","c_hash"];t.ResponseValidator=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.MetadataService,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.UserInfoService,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u.JoseUtil;if(n(this,e),!t)throw i.Log.error("ResponseValidator.ctor: No settings passed to ResponseValidator"),new Error("settings");this._settings=t,this._metadataService=new r(this._settings),this._userInfoService=new a(this._settings),this._joseUtil=c}return e.prototype.validateSigninResponse=function(e,t){var r=this;return i.Log.debug("ResponseValidator.validateSigninResponse"),this._processSigninParams(e,t).then(function(t){return i.Log.debug("ResponseValidator.validateSigninResponse: state processed"),r._validateTokens(e,t).then(function(e){return i.Log.debug("ResponseValidator.validateSigninResponse: tokens validated"),r._processClaims(e).then(function(e){return i.Log.debug("ResponseValidator.validateSigninResponse: claims processed"),e})})})},e.prototype.validateSignoutResponse=function(e,t){return e.id!==t.state?(i.Log.error("ResponseValidator.validateSignoutResponse: State does not match"),Promise.reject(new Error("State does not match"))):(i.Log.debug("ResponseValidator.validateSignoutResponse: state validated"),t.state=e.data,t.error?(i.Log.warn("ResponseValidator.validateSignoutResponse: Response was error",t.error),Promise.reject(new a.ErrorResponse(t))):Promise.resolve(t))},e.prototype._processSigninParams=function(e,t){if(e.id!==t.state)return i.Log.error("ResponseValidator._processSigninParams: State does not match"),Promise.reject(new Error("State does not match"));if(!e.client_id)return i.Log.error("ResponseValidator._processSigninParams: No client_id on state"),Promise.reject(new Error("No client_id on state"));if(!e.authority)return i.Log.error("ResponseValidator._processSigninParams: No authority on state"),Promise.reject(new Error("No authority on state"));if(this._settings.authority){if(this._settings.authority&&this._settings.authority!==e.authority)return i.Log.error("ResponseValidator._processSigninParams: authority mismatch on settings vs. signin state"),Promise.reject(new Error("authority mismatch on settings vs. signin state"))}else this._settings.authority=e.authority;if(this._settings.client_id){if(this._settings.client_id&&this._settings.client_id!==e.client_id)return i.Log.error("ResponseValidator._processSigninParams: client_id mismatch on settings vs. signin state"),Promise.reject(new Error("client_id mismatch on settings vs. signin state"))}else this._settings.client_id=e.client_id;return i.Log.debug("ResponseValidator._processSigninParams: state validated"),t.state=e.data,t.error?(i.Log.warn("ResponseValidator._processSigninParams: Response was error",t.error),Promise.reject(new a.ErrorResponse(t))):e.nonce&&!t.id_token?(i.Log.error("ResponseValidator._processSigninParams: Expecting id_token in response"),Promise.reject(new Error("No id_token in response"))):!e.nonce&&t.id_token?(i.Log.error("ResponseValidator._processSigninParams: Not expecting id_token in response"),Promise.reject(new Error("Unexpected id_token in response"))):Promise.resolve(t)},e.prototype._processClaims=function(e){var t=this;if(e.isOpenIdConnect){if(i.Log.debug("ResponseValidator._processClaims: response is OIDC, processing claims"),e.profile=this._filterProtocolClaims(e.profile),this._settings.loadUserInfo&&e.access_token)return i.Log.debug("ResponseValidator._processClaims: loading user info"),this._userInfoService.getClaims(e.access_token).then(function(r){return i.Log.debug("ResponseValidator._processClaims: user info claims received from user info endpoint"),r.sub!==e.profile.sub?(i.Log.error("ResponseValidator._processClaims: sub from user info endpoint does not match sub in access_token"),Promise.reject(new Error("sub from user info endpoint does not match sub in access_token"))):(e.profile=t._mergeClaims(e.profile,r),i.Log.debug("ResponseValidator._processClaims: user info claims received, updated profile:",e.profile),e)});i.Log.debug("ResponseValidator._processClaims: not loading user info")}else i.Log.debug("ResponseValidator._processClaims: response is not OIDC, not processing claims");return Promise.resolve(e)},e.prototype._mergeClaims=function(e,t){var r=Object.assign({},e);for(var n in t){var i=t[n];Array.isArray(i)||(i=[i]);for(var o=0;o<i.length;o++){var s=i[o];r[n]?Array.isArray(r[n])?r[n].indexOf(s)<0&&r[n].push(s):r[n]!==s&&(r[n]=[r[n],s]):r[n]=s}}return r},e.prototype._filterProtocolClaims=function(e){i.Log.debug("ResponseValidator._filterProtocolClaims, incoming claims:",e);var t=Object.assign({},e);return this._settings._filterProtocolClaims?(c.forEach(function(e){delete t[e]}),i.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims filtered",t)):i.Log.debug("ResponseValidator._filterProtocolClaims: protocol claims not filtered"),t},e.prototype._validateTokens=function(e,t){return t.id_token?t.access_token?(i.Log.debug("ResponseValidator._validateTokens: Validating id_token and access_token"),this._validateIdTokenAndAccessToken(e,t)):(i.Log.debug("ResponseValidator._validateTokens: Validating id_token"),this._validateIdToken(e,t)):(i.Log.debug("ResponseValidator._validateTokens: No id_token to validate"),Promise.resolve(t))},e.prototype._validateIdTokenAndAccessToken=function(e,t){var r=this;return this._validateIdToken(e,t).then(function(e){return r._validateAccessToken(e)})},e.prototype._validateIdToken=function(e,t){var r=this;if(!e.nonce)return i.Log.error("ResponseValidator._validateIdToken: No nonce on state"),Promise.reject(new Error("No nonce on state"));var n=this._joseUtil.parseJwt(t.id_token);if(!n||!n.header||!n.payload)return i.Log.error("ResponseValidator._validateIdToken: Failed to parse id_token",n),Promise.reject(new Error("Failed to parse id_token"));if(e.nonce!==n.payload.nonce)return i.Log.error("ResponseValidator._validateIdToken: Invalid nonce in id_token"),Promise.reject(new Error("Invalid nonce in id_token"));var o=n.header.kid;return this._metadataService.getIssuer().then(function(s){return i.Log.debug("ResponseValidator._validateIdToken: Received issuer"),r._metadataService.getSigningKeys().then(function(a){if(!a)return i.Log.error("ResponseValidator._validateIdToken: No signing keys from metadata"),Promise.reject(new Error("No signing keys from metadata"));i.Log.debug("ResponseValidator._validateIdToken: Received signing keys");var u=void 0;if(o)u=a.filter(function(e){return e.kid===o})[0];else{if(a=r._filterByAlg(a,n.header.alg),a.length>1)return i.Log.error("ResponseValidator._validateIdToken: No kid found in id_token and more than one key found in metadata"),Promise.reject(new Error("No kid found in id_token and more than one key found in metadata"));u=a[0]}if(!u)return i.Log.error("ResponseValidator._validateIdToken: No key matching kid or alg found in signing keys"),Promise.reject(new Error("No key matching kid or alg found in signing keys"));var c=e.client_id,h=r._settings.clockSkew;return i.Log.debug("ResponseValidator._validateIdToken: Validaing JWT; using clock skew (in seconds) of: ",h),r._joseUtil.validateJwt(t.id_token,u,s,c,h).then(function(){return i.Log.debug("ResponseValidator._validateIdToken: JWT validation successful"),n.payload.sub?(t.profile=n.payload,t):(i.Log.error("ResponseValidator._validateIdToken: No sub present in id_token"),Promise.reject(new Error("No sub present in id_token")))})})})},e.prototype._filterByAlg=function(e,t){var r=null;if(t.startsWith("RS"))r="RSA";else if(t.startsWith("PS"))r="PS";else{if(!t.startsWith("ES"))return i.Log.debug("ResponseValidator._filterByAlg: alg not supported: ",t),[];r="EC"}return i.Log.debug("ResponseValidator._filterByAlg: Looking for keys that match kty: ",r),e=e.filter(function(e){return e.kty===r}),i.Log.debug("ResponseValidator._filterByAlg: Number of keys that match kty: ",r,e.length),e},e.prototype._validateAccessToken=function(e){if(!e.profile)return i.Log.error("ResponseValidator._validateAccessToken: No profile loaded from id_token"),Promise.reject(new Error("No profile loaded from id_token"));if(!e.profile.at_hash)return i.Log.error("ResponseValidator._validateAccessToken: No at_hash in id_token"),Promise.reject(new Error("No at_hash in id_token"));if(!e.id_token)return i.Log.error("ResponseValidator._validateAccessToken: No id_token"),Promise.reject(new Error("No id_token"));var t=this._joseUtil.parseJwt(e.id_token);if(!t||!t.header)return i.Log.error("ResponseValidator._validateAccessToken: Failed to parse id_token",t),Promise.reject(new Error("Failed to parse id_token"));var r=t.header.alg;if(!r||5!==r.length)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r),Promise.reject(new Error("Unsupported alg: "+r));var n=r.substr(2,3);if(!n)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r,n),Promise.reject(new Error("Unsupported alg: "+r));if(256!==(n=parseInt(n))&&384!==n&&512!==n)return i.Log.error("ResponseValidator._validateAccessToken: Unsupported alg:",r,n),Promise.reject(new Error("Unsupported alg: "+r));var o="sha"+n,s=this._joseUtil.hashString(e.access_token,o);if(!s)return i.Log.error("ResponseValidator._validateAccessToken: access_token hash failed:",o),Promise.reject(new Error("Failed to validate at_hash"));var a=s.substr(0,s.length/2),u=this._joseUtil.hexToBase64Url(a);return u!==e.profile.at_hash?(i.Log.error("ResponseValidator._validateAccessToken: Failed to validate at_hash",u,e.profile.at_hash),Promise.reject(new Error("Failed to validate at_hash"))):(i.Log.debug("ResponseValidator._validateAccessToken: success"),Promise.resolve(e))},e}()},"./src/SessionMonitor.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SessionMonitor=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r("./src/Log.js"),s=r("./src/CheckSessionIFrame.js");t.SessionMonitor=function(){function e(t){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.CheckSessionIFrame;if(n(this,e),!t)throw o.Log.error("SessionMonitor.ctor: No user manager passed to SessionMonitor"),new Error("userManager");this._userManager=t,this._CheckSessionIFrameCtor=i,this._userManager.events.addUserLoaded(this._start.bind(this)),this._userManager.events.addUserUnloaded(this._stop.bind(this)),this._userManager.getUser().then(function(e){e&&r._start(e)}).catch(function(e){o.Log.error("SessionMonitor ctor: error from getUser:",e.message)})}return e.prototype._start=function(e){var t=this,r=e.session_state;r&&(this._sub=e.profile.sub,this._sid=e.profile.sid,o.Log.debug("SessionMonitor._start: session_state:",r,", sub:",this._sub),this._checkSessionIFrame?this._checkSessionIFrame.start(r):this._metadataService.getCheckSessionIframe().then(function(e){if(e){o.Log.debug("SessionMonitor._start: Initializing check session iframe");var n=t._client_id,i=t._checkSessionInterval,s=t._stopCheckSessionOnError;t._checkSessionIFrame=new t._CheckSessionIFrameCtor(t._callback.bind(t),n,e,i,s),t._checkSessionIFrame.load().then(function(){t._checkSessionIFrame.start(r)})}else o.Log.warn("SessionMonitor._start: No check session iframe found in the metadata")}).catch(function(e){o.Log.error("SessionMonitor._start: Error from getCheckSessionIframe:",e.message)}))},e.prototype._stop=function(){this._sub=null,this._sid=null,this._checkSessionIFrame&&(o.Log.debug("SessionMonitor._stop"),this._checkSessionIFrame.stop())},e.prototype._callback=function(){var e=this;this._userManager.querySessionStatus().then(function(t){var r=!0;t?t.sub===e._sub?(r=!1,e._checkSessionIFrame.start(t.session_state),t.sid===e._sid?o.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, restarting check session iframe; session_state:",t.session_state):(o.Log.debug("SessionMonitor._callback: Same sub still logged in at OP, session state has changed, restarting check session iframe; session_state:",t.session_state),e._userManager.events._raiseUserSessionChanged())):o.Log.debug("SessionMonitor._callback: Different subject signed into OP:",t.sub):o.Log.debug("SessionMonitor._callback: Subject no longer signed into OP"),r&&(o.Log.debug("SessionMonitor._callback: SessionMonitor._callback; raising signed out event"),e._userManager.events._raiseUserSignedOut())}).catch(function(t){o.Log.debug("SessionMonitor._callback: Error calling queryCurrentSigninSession; raising signed out event",t.message),e._userManager.events._raiseUserSignedOut()})},i(e,[{key:"_settings",get:function(){return this._userManager.settings}},{key:"_metadataService",get:function(){return this._userManager.metadataService}},{key:"_client_id",get:function(){return this._settings.client_id}},{key:"_checkSessionInterval",get:function(){return this._settings.checkSessionInterval}},{key:"_stopCheckSessionOnError",get:function(){return this._settings.stopCheckSessionOnError}}]),e}()},"./src/SigninRequest.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SigninRequest=void 0;var i=r("./src/Log.js"),o=r("./src/UrlUtility.js"),s=r("./src/SigninState.js");t.SigninRequest=function(){function e(t){var r=t.url,a=t.client_id,u=t.redirect_uri,c=t.response_type,h=t.scope,l=t.authority,f=t.data,p=t.prompt,d=t.display,g=t.max_age,v=t.ui_locales,y=t.id_token_hint,m=t.login_hint,S=t.acr_values,_=t.resource,F=t.request,b=t.request_uri,w=t.extraQueryParams;if(n(this,e),!r)throw i.Log.error("SigninRequest.ctor: No url passed"),new Error("url");if(!a)throw i.Log.error("SigninRequest.ctor: No client_id passed"),new Error("client_id");if(!u)throw i.Log.error("SigninRequest.ctor: No redirect_uri passed"),new Error("redirect_uri");if(!c)throw i.Log.error("SigninRequest.ctor: No response_type passed"),new Error("response_type");if(!h)throw i.Log.error("SigninRequest.ctor: No scope passed"),new Error("scope");if(!l)throw i.Log.error("SigninRequest.ctor: No authority passed"),new Error("authority");var E=e.isOidc(c);this.state=new s.SigninState({nonce:E,data:f,client_id:a,authority:l}),r=o.UrlUtility.addQueryParam(r,"client_id",a),r=o.UrlUtility.addQueryParam(r,"redirect_uri",u),r=o.UrlUtility.addQueryParam(r,"response_type",c),r=o.UrlUtility.addQueryParam(r,"scope",h),r=o.UrlUtility.addQueryParam(r,"state",this.state.id),E&&(r=o.UrlUtility.addQueryParam(r,"nonce",this.state.nonce));var x={prompt:p,display:d,max_age:g,ui_locales:v,id_token_hint:y,login_hint:m,acr_values:S,resource:_,request:F,request_uri:b};for(var A in x)x[A]&&(r=o.UrlUtility.addQueryParam(r,A,x[A]));for(var P in w)r=o.UrlUtility.addQueryParam(r,P,w[P]);this.url=r}return e.isOidc=function(e){return!!e.split(/\s+/g).filter(function(e){return"id_token"===e})[0]},e.isOAuth=function(e){return!!e.split(/\s+/g).filter(function(e){return"token"===e})[0]},e}()},"./src/SigninResponse.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SigninResponse=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r("./src/UrlUtility.js");t.SigninResponse=function(){function e(t){n(this,e);var r=o.UrlUtility.parseUrlFragment(t,"#");this.error=r.error,this.error_description=r.error_description,this.error_uri=r.error_uri,this.state=r.state,this.id_token=r.id_token,this.session_state=r.session_state,this.access_token=r.access_token,this.token_type=r.token_type,this.scope=r.scope,this.profile=void 0;var i=parseInt(r.expires_in);if("number"==typeof i&&i>0){var s=parseInt(Date.now()/1e3);this.expires_at=s+i}}return i(e,[{key:"expires_in",get:function(){if(this.expires_at){var e=parseInt(Date.now()/1e3);return this.expires_at-e}}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}},{key:"isOpenIdConnect",get:function(){return this.scopes.indexOf("openid")>=0||!!this.id_token}}]),e}()},"./src/SigninState.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":o(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":o(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.SigninState=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r("./src/Log.js"),c=r("./src/State.js"),h=r("./src/random.js"),l=function(e){return e&&e.__esModule?e:{default:e}}(h);t.SigninState=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.nonce,s=r.authority,a=r.client_id;n(this,t);var u=i(this,e.call(this,arguments[0]));return!0===o?u._nonce=(0,l.default)():o&&(u._nonce=o),u._authority=s,u._client_id=a,u}return s(t,e),t.prototype.toStorageString=function(){return u.Log.debug("SigninState.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created,nonce:this.nonce,authority:this.authority,client_id:this.client_id})},t.fromStorageString=function(e){return u.Log.debug("SigninState.fromStorageString"),new t(JSON.parse(e))},a(t,[{key:"nonce",get:function(){return this._nonce}},{key:"authority",get:function(){return this._authority}},{key:"client_id",get:function(){return this._client_id}}]),t}(c.State)},"./src/SignoutRequest.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SignoutRequest=void 0;var i=r("./src/Log.js"),o=r("./src/UrlUtility.js"),s=r("./src/State.js");t.SignoutRequest=function e(t){var r=t.url,a=t.id_token_hint,u=t.post_logout_redirect_uri,c=t.data;if(n(this,e),!r)throw i.Log.error("SignoutRequest.ctor: No url passed"),new Error("url");a&&(r=o.UrlUtility.addQueryParam(r,"id_token_hint",a)),u&&(r=o.UrlUtility.addQueryParam(r,"post_logout_redirect_uri",u),c&&(this.state=new s.State({data:c}),r=o.UrlUtility.addQueryParam(r,"state",this.state.id))),this.url=r}},"./src/SignoutResponse.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SignoutResponse=void 0;var i=r("./src/UrlUtility.js");t.SignoutResponse=function e(t){n(this,e);var r=i.UrlUtility.parseUrlFragment(t,"?");this.error=r.error,this.error_description=r.error_description,this.error_uri=r.error_uri,this.state=r.state}},"./src/SilentRenewService.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.SilentRenewService=void 0;var i=r("./src/Log.js");t.SilentRenewService=function(){function e(t){n(this,e),this._userManager=t}return e.prototype.start=function(){this._callback||(this._callback=this._tokenExpiring.bind(this),this._userManager.events.addAccessTokenExpiring(this._callback),this._userManager.getUser().then(function(e){}).catch(function(e){i.Log.error("SilentRenewService.start: Error from getUser:",e.message)}))},e.prototype.stop=function(){this._callback&&(this._userManager.events.removeAccessTokenExpiring(this._callback),delete this._callback)},e.prototype._tokenExpiring=function(){var e=this;this._userManager.signinSilent().then(function(e){i.Log.debug("SilentRenewService._tokenExpiring: Silent token renewal successful")},function(t){i.Log.error("SilentRenewService._tokenExpiring: Error from signinSilent:",t.message),e._userManager.events._raiseSilentRenewError(t)})},e}()},"./src/State.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.State=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r("./src/Log.js"),s=r("./src/random.js"),a=function(e){return e&&e.__esModule?e:{default:e}}(s);t.State=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.id,i=t.data,o=t.created;n(this,e),this._id=r||(0,a.default)(),this._data=i,this._created="number"==typeof o&&o>0?o:parseInt(Date.now()/1e3)}return e.prototype.toStorageString=function(){return o.Log.debug("State.toStorageString"),JSON.stringify({id:this.id,data:this.data,created:this.created})},e.fromStorageString=function(t){return o.Log.debug("State.fromStorageString"),new e(JSON.parse(t))},e.clearStaleState=function(t,r){var n=Date.now()/1e3-r;return t.getAllKeys().then(function(r){o.Log.debug("State.clearStaleState: got keys",r);for(var i=[],s=0;s<r.length;s++){var a;!function(s){var u=r[s];a=t.get(u).then(function(r){var i=!1;if(r)try{var s=e.fromStorageString(r);o.Log.debug("State.clearStaleState: got item from key: ",u,s.created),s.created<=n&&(i=!0)}catch(e){o.Log.error("State.clearStaleState: Error parsing state for key",u,e.message),i=!0}else o.Log.debug("State.clearStaleState: no item in storage for key: ",u),i=!0;if(i)return o.Log.debug("State.clearStaleState: removed item for key: ",u),t.remove(u)}),i.push(a)}(s)}return o.Log.debug("State.clearStaleState: waiting on promise count:",i.length),Promise.all(i)})},i(e,[{key:"id",get:function(){return this._id}},{key:"data",get:function(){return this._data}},{key:"created",get:function(){return this._created}}]),e}()},"./src/Timer.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":o(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":o(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r("./src/Log.js"),c=r("./src/Global.js"),h=r("./src/Event.js");t.Timer=function(e){function t(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.Global.timer,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;n(this,t);var a=i(this,e.call(this,r));return a._timer=o,a._nowFunc=s||function(){return Date.now()/1e3},a}return s(t,e),t.prototype.init=function(e){e<=0&&(e=1),e=parseInt(e);var t=this.now+e;if(this.expiration===t&&this._timerHandle)return void u.Log.debug("Timer.init timer "+this._name+" skipping initialization since already initialized for expiration:",this.expiration);this.cancel(),u.Log.debug("Timer.init timer "+this._name+" for duration:",e),this._expiration=t;var r=5;e<r&&(r=e),this._timerHandle=this._timer.setInterval(this._callback.bind(this),1e3*r)},t.prototype.cancel=function(){this._timerHandle&&(u.Log.debug("Timer.cancel: ",this._name),this._timer.clearInterval(this._timerHandle),this._timerHandle=null)},t.prototype._callback=function(){var t=this._expiration-this.now;u.Log.debug("Timer.callback; "+this._name+" timer expires in:",t),this._expiration<=this.now&&(this.cancel(),e.prototype.raise.call(this))},a(t,[{key:"now",get:function(){return parseInt(this._nowFunc())}},{key:"expiration",get:function(){return this._expiration}}]),t}(h.Event)},"./src/TokenRevocationClient.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRevocationClient=void 0;var i=r("./src/Log.js"),o=r("./src/MetadataService.js"),s=r("./src/Global.js");t.TokenRevocationClient=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.Global.XMLHttpRequest,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.MetadataService;if(n(this,e),!t)throw i.Log.error("TokenRevocationClient.ctor: No settings provided"),new Error("No settings provided.");this._settings=t,this._XMLHttpRequestCtor=r,this._metadataService=new a(this._settings)}return e.prototype.revoke=function(e,t){var r=this;if(!e)throw i.Log.error("TokenRevocationClient.revoke: No accessToken provided"),new Error("No accessToken provided.");return this._metadataService.getRevocationEndpoint().then(function(n){if(n){i.Log.error("TokenRevocationClient.revoke: Revoking access token");var o=r._settings.client_id,s=r._settings.client_secret;return r._revoke(n,o,s,e)}if(t)throw i.Log.error("TokenRevocationClient.revoke: Revocation not supported"),new Error("Revocation not supported")})},e.prototype._revoke=function(e,t,r,n){var o=this;return new Promise(function(s,a){var u=new o._XMLHttpRequestCtor;u.open("POST",e),u.onload=function(){i.Log.debug("TokenRevocationClient.revoke: HTTP response received, status",u.status),200===u.status?s():a(Error(u.statusText+" ("+u.status+")"))};var c="client_id="+encodeURIComponent(t);r&&(c+="&client_secret="+encodeURIComponent(r)),c+="&token_type_hint="+encodeURIComponent("access_token"),c+="&token="+encodeURIComponent(n),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),u.send(c)})},e}()},"./src/UrlUtility.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.UrlUtility=void 0;var i=r("./src/Log.js"),o=r("./src/Global.js");t.UrlUtility=function(){function e(){n(this,e)}return e.addQueryParam=function(e,t,r){return e.indexOf("?")<0&&(e+="?"),"?"!==e[e.length-1]&&(e+="&"),e+=encodeURIComponent(t),e+="=",e+=encodeURIComponent(r)},e.parseUrlFragment=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.Global;"string"!=typeof e&&(e=r.location.href);var n=e.lastIndexOf(t);n>=0&&(e=e.substr(n+1));for(var s,a={},u=/([^&=]+)=([^&]*)/g,c=0;s=u.exec(e);)if(a[decodeURIComponent(s[1])]=decodeURIComponent(s[2]),c++>50)return i.Log.error("UrlUtility.parseUrlFragment: response exceeded expected number of parameters",e),{error:"Response exceeded expected number of parameters"};for(var h in a)return a;return{}},e}()},"./src/User.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.User=void 0;var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r("./src/Log.js");t.User=function(){function e(t){var r=t.id_token,i=t.session_state,o=t.access_token,s=t.token_type,a=t.scope,u=t.profile,c=t.expires_at,h=t.state;n(this,e),this.id_token=r,this.session_state=i,this.access_token=o,this.token_type=s,this.scope=a,this.profile=u,this.expires_at=c,this.state=h}return e.prototype.toStorageString=function(){return o.Log.debug("User.toStorageString"),JSON.stringify({id_token:this.id_token,session_state:this.session_state,access_token:this.access_token,token_type:this.token_type,scope:this.scope,profile:this.profile,expires_at:this.expires_at})},e.fromStorageString=function(t){return o.Log.debug("User.fromStorageString"),new e(JSON.parse(t))},i(e,[{key:"expires_in",get:function(){if(this.expires_at){var e=parseInt(Date.now()/1e3);return this.expires_at-e}}},{key:"expired",get:function(){var e=this.expires_in;if(void 0!==e)return e<=0}},{key:"scopes",get:function(){return(this.scope||"").split(" ")}}]),e}()},"./src/UserInfoService.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.UserInfoService=void 0;var i=r("./src/JsonService.js"),o=r("./src/MetadataService.js"),s=r("./src/Log.js");t.UserInfoService=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.JsonService,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.MetadataService;if(n(this,e),!t)throw s.Log.error("UserInfoService.ctor: No settings passed"),new Error("settings");this._settings=t,this._jsonService=new r,this._metadataService=new a(this._settings)}return e.prototype.getClaims=function(e){var t=this;return e?this._metadataService.getUserInfoEndpoint().then(function(r){return s.Log.debug("UserInfoService.getClaims: received userinfo url",r),t._jsonService.getJson(r,e).then(function(e){return s.Log.debug("UserInfoService.getClaims: claims received",e),e})}):(s.Log.error("UserInfoService.getClaims: No token passed"),Promise.reject(new Error("A token is required")))},e}()},"./src/UserManager.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":o(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":o(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UserManager=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r("./src/Log.js"),c=r("./src/OidcClient.js"),h=r("./src/UserManagerSettings.js"),l=r("./src/User.js"),f=r("./src/UserManagerEvents.js"),p=r("./src/SilentRenewService.js"),d=r("./src/SessionMonitor.js"),g=r("./src/TokenRevocationClient.js");t.UserManager=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.SilentRenewService,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d.SessionMonitor,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:g.TokenRevocationClient;n(this,t),r instanceof h.UserManagerSettings||(r=new h.UserManagerSettings(r));var c=i(this,e.call(this,r));return c._events=new f.UserManagerEvents(r),c._silentRenewService=new o(c),c.settings.automaticSilentRenew&&(u.Log.debug("UserManager.ctor: automaticSilentRenew is configured, setting up silent renew"),c.startSilentRenew()),c.settings.monitorSession&&(u.Log.debug("UserManager.ctor: monitorSession is configured, setting up session monitor"),c._sessionMonitor=new s(c)),c._tokenRevocationClient=new a(c._settings),c}return s(t,e),t.prototype.getUser=function(){var e=this;return this._loadUser().then(function(t){return t?(u.Log.info("UserManager.getUser: user loaded"),e._events.load(t,!1),t):(u.Log.info("UserManager.getUser: user not found in storage"),null)})},t.prototype.removeUser=function(){var e=this;return this.storeUser(null).then(function(){u.Log.info("UserManager.removeUser: user removed from storage"),e._events.unload()})},t.prototype.signinRedirect=function(e){return this._signinStart(e,this._redirectNavigator).then(function(){u.Log.info("UserManager.signinRedirect: successful")})},t.prototype.signinRedirectCallback=function(e){return this._signinEnd(e||this._redirectNavigator.url).then(function(e){return e&&(e.profile&&e.profile.sub?u.Log.info("UserManager.signinRedirectCallback: successful, signed in sub: ",e.profile.sub):u.Log.info("UserManager.signinRedirectCallback: no sub")),e})},t.prototype.signinPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.redirect_uri||this.settings.popup_redirect_uri||this.settings.redirect_uri;return t?(e.redirect_uri=t,e.display="popup",this._signin(e,this._popupNavigator,{startUrl:t,popupWindowFeatures:e.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:e.popupWindowTarget||this.settings.popupWindowTarget}).then(function(e){return e&&(e.profile&&e.profile.sub?u.Log.info("UserManager.signinPopup: signinPopup successful, signed in sub: ",e.profile.sub):u.Log.info("UserManager.signinPopup: no sub")),e})):(u.Log.error("UserManager.signinPopup: No popup_redirect_uri or redirect_uri configured"),Promise.reject(new Error("No popup_redirect_uri or redirect_uri configured")))},t.prototype.signinPopupCallback=function(e){return this._signinCallback(e,this._popupNavigator).then(function(e){return e&&(e.profile&&e.profile.sub?u.Log.info("UserManager.signinPopupCallback: successful, signed in sub: ",e.profile.sub):u.Log.info("UserManager.signinPopupCallback: no sub")),e}).catch(function(e){u.Log.error("UserManager.signinPopupCallback error: "+e&&e.message)})},t.prototype.signinSilent=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.redirect_uri||this.settings.silent_redirect_uri;if(!r)return u.Log.error("UserManager.signinSilent: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured"));t.redirect_uri=r,t.prompt="none";var n=void 0;return n=t.id_token_hint||!this.settings.includeIdTokenInSilentRenew?Promise.resolve():this._loadUser().then(function(e){t.id_token_hint=e&&e.id_token}),n.then(function(){return e._signin(t,e._iframeNavigator,{startUrl:r,silentRequestTimeout:t.silentRequestTimeout||e.settings.silentRequestTimeout})}).then(function(e){return e&&(e.profile&&e.profile.sub?u.Log.info("UserManager.signinSilent: successful, signed in sub: ",e.profile.sub):u.Log.info("UserManager.signinSilent: no sub")),e})},t.prototype.signinSilentCallback=function(e){return this._signinCallback(e,this._iframeNavigator).then(function(e){return e&&(e.profile&&e.profile.sub?u.Log.info("UserManager.signinSilentCallback: successful, signed in sub: ",e.profile.sub):u.Log.info("UserManager.signinSilentCallback: no sub")),e})},t.prototype.querySessionStatus=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.redirect_uri||this.settings.silent_redirect_uri;return r?(t.redirect_uri=r,t.prompt="none",t.response_type="id_token",t.scope="openid",this._signinStart(t,this._iframeNavigator,{startUrl:r,silentRequestTimeout:t.silentRequestTimeout||this.settings.silentRequestTimeout}).then(function(t){return e.processSigninResponse(t.url).then(function(e){if(u.Log.debug("UserManager.querySessionStatus: got signin response"),e.session_state&&e.profile.sub&&e.profile.sid)return u.Log.info("UserManager.querySessionStatus: querySessionStatus success for sub: ",e.profile.sub),{session_state:e.session_state,sub:e.profile.sub,sid:e.profile.sid};u.Log.info("querySessionStatus successful, user not authenticated")})})):(u.Log.error("UserManager.querySessionStatus: No silent_redirect_uri configured"),Promise.reject(new Error("No silent_redirect_uri configured")))},t.prototype._signin=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signinStart(e,t,n).then(function(e){return r._signinEnd(e.url)})},t.prototype._signinStart=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.prepare(n).then(function(t){return u.Log.debug("UserManager._signinStart: got navigator window handle"),r.createSigninRequest(e).then(function(e){return u.Log.debug("UserManager._signinStart: got signin request"),n.url=e.url,n.id=e.state.id,t.navigate(n)}).catch(function(e){throw t.close&&(u.Log.debug("UserManager._signinStart: Error after preparing navigator, closing navigator window"),t.close()),e})})},t.prototype._signinEnd=function(e){var t=this;return this.processSigninResponse(e).then(function(e){u.Log.debug("UserManager._signinEnd: got signin response");var r=new l.User(e);return t.storeUser(r).then(function(){return u.Log.debug("UserManager._signinEnd: user stored"),t._events.load(r),r})})},t.prototype._signinCallback=function(e,t){return u.Log.debug("UserManager._signinCallback"),t.callback(e)},t.prototype.signoutRedirect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return t&&(e.post_logout_redirect_uri=t),this._signoutStart(e,this._redirectNavigator).then(function(){u.Log.info("UserManager.signoutRedirect: successful")})},t.prototype.signoutRedirectCallback=function(e){return this._signoutEnd(e||this._redirectNavigator.url).then(function(e){return u.Log.info("UserManager.signoutRedirectCallback: successful"),e})},t.prototype.signoutPopup=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.post_logout_redirect_uri||this.settings.popup_post_logout_redirect_uri||this.settings.post_logout_redirect_uri;return e.post_logout_redirect_uri=t,e.display="popup",e.post_logout_redirect_uri&&(e.state=e.state||{}),this._signout(e,this._popupNavigator,{startUrl:t,popupWindowFeatures:e.popupWindowFeatures||this.settings.popupWindowFeatures,popupWindowTarget:e.popupWindowTarget||this.settings.popupWindowTarget}).then(function(){u.Log.info("UserManager.signinPopup: successful")})},t.prototype.signoutPopupCallback=function(e,t){return void 0===t&&"boolean"==typeof e&&(e=null,t=!0),this._popupNavigator.callback(e,t,"?").then(function(){u.Log.info("UserManager.signoutPopupCallback: successful")})},t.prototype._signout=function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this._signoutStart(e,t,n).then(function(e){return r._signoutEnd(e.url)})},t.prototype._signoutStart=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,r=arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.prepare(n).then(function(r){return u.Log.debug("UserManager._signoutStart: got navigator window handle"),t._loadUser().then(function(i){return u.Log.debug("UserManager._signoutStart: loaded current user from storage"),(t._settings.revokeAccessTokenOnSignout?t._revokeInternal(i):Promise.resolve()).then(function(){var o=e.id_token_hint||i&&i.id_token;return o&&(u.Log.debug("UserManager._signoutStart: Setting id_token into signout request"),e.id_token_hint=o),t.removeUser().then(function(){return u.Log.debug("UserManager._signoutStart: user removed, creating signout request"),t.createSignoutRequest(e).then(function(e){return u.Log.debug("UserManager._signoutStart: got signout request"),n.url=e.url,e.state&&(n.id=e.state.id),r.navigate(n)})})})}).catch(function(e){throw r.close&&(u.Log.debug("UserManager._signoutStart: Error after preparing navigator, closing navigator window"),r.close()),e})})},t.prototype._signoutEnd=function(e){return this.processSignoutResponse(e).then(function(e){return u.Log.debug("UserManager._signoutEnd: got signout response"),e})},t.prototype.revokeAccessToken=function(){var e=this;return this._loadUser().then(function(t){return e._revokeInternal(t,!0).then(function(r){if(r)return u.Log.debug("UserManager.revokeAccessToken: removing token properties from user and re-storing"),t.access_token=null,t.expires_at=null,t.token_type=null,e.storeUser(t).then(function(){u.Log.debug("UserManager.revokeAccessToken: user stored"),e._events.load(t)})})}).then(function(){u.Log.info("UserManager.revokeAccessToken: access token revoked successfully")})},t.prototype._revokeInternal=function(e,t){var r=e&&e.access_token;return!r||r.indexOf(".")>=0?(u.Log.debug("UserManager.revokeAccessToken: no need to revoke due to no user, token, or JWT format"),Promise.resolve(!1)):this._tokenRevocationClient.revoke(r,t).then(function(){return!0})},t.prototype.startSilentRenew=function(){this._silentRenewService.start()},t.prototype.stopSilentRenew=function(){this._silentRenewService.stop()},t.prototype._loadUser=function(){return this._userStore.get(this._userStoreKey).then(function(e){return e?(u.Log.debug("UserManager._loadUser: user storageString loaded"),l.User.fromStorageString(e)):(u.Log.debug("UserManager._loadUser: no user storageString"),null)})},t.prototype.storeUser=function(e){if(e){u.Log.debug("UserManager.storeUser: storing user");var t=e.toStorageString();return this._userStore.set(this._userStoreKey,t)}return u.Log.debug("storeUser.storeUser: removing user"),this._userStore.remove(this._userStoreKey)},a(t,[{key:"_redirectNavigator",get:function(){return this.settings.redirectNavigator}},{key:"_popupNavigator",get:function(){return this.settings.popupNavigator}},{key:"_iframeNavigator",get:function(){return this.settings.iframeNavigator}},{key:"_userStore",get:function(){return this.settings.userStore}},{key:"events",get:function(){return this._events}},{key:"_userStoreKey",get:function(){return"user:"+this.settings.authority+":"+this.settings.client_id}}]),t}(c.OidcClient)},"./src/UserManagerEvents.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":o(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":o(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UserManagerEvents=void 0;var a=r("./src/Log.js"),u=r("./src/AccessTokenEvents.js"),c=r("./src/Event.js");t.UserManagerEvents=function(e){function t(r){n(this,t);var o=i(this,e.call(this,r));return o._userLoaded=new c.Event("User loaded"),o._userUnloaded=new c.Event("User unloaded"),o._silentRenewError=new c.Event("Silent renew error"),o._userSignedOut=new c.Event("User signed out"),o._userSessionChanged=new c.Event("User session changed"),o}return s(t,e),t.prototype.load=function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];a.Log.debug("UserManagerEvents.load"),e.prototype.load.call(this,t),r&&this._userLoaded.raise(t)},t.prototype.unload=function(){a.Log.debug("UserManagerEvents.unload"),e.prototype.unload.call(this),this._userUnloaded.raise()},t.prototype.addUserLoaded=function(e){this._userLoaded.addHandler(e)},t.prototype.removeUserLoaded=function(e){this._userLoaded.removeHandler(e)},t.prototype.addUserUnloaded=function(e){this._userUnloaded.addHandler(e)},t.prototype.removeUserUnloaded=function(e){this._userUnloaded.removeHandler(e)},t.prototype.addSilentRenewError=function(e){this._silentRenewError.addHandler(e)},t.prototype.removeSilentRenewError=function(e){this._silentRenewError.removeHandler(e)},t.prototype._raiseSilentRenewError=function(e){a.Log.debug("UserManagerEvents._raiseSilentRenewError",e.message),this._silentRenewError.raise(e)},t.prototype.addUserSignedOut=function(e){this._userSignedOut.addHandler(e)},t.prototype.removeUserSignedOut=function(e){this._userSignedOut.removeHandler(e)},t.prototype._raiseUserSignedOut=function(e){a.Log.debug("UserManagerEvents._raiseUserSignedOut"),this._userSignedOut.raise(e)},t.prototype.addUserSessionChanged=function(e){this._userSessionChanged.addHandler(e)},t.prototype.removeUserSessionChanged=function(e){this._userSessionChanged.removeHandler(e)},t.prototype._raiseUserSessionChanged=function(e){a.Log.debug("UserManagerEvents._raiseUserSessionChanged"),this._userSessionChanged.raise(e)},t}(u.AccessTokenEvents)},"./src/UserManagerSettings.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":o(t))&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":o(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.UserManagerSettings=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=(r("./src/Log.js"),r("./src/OidcClientSettings.js")),c=r("./src/RedirectNavigator.js"),h=r("./src/PopupNavigator.js"),l=r("./src/IFrameNavigator.js"),f=r("./src/WebStorageStateStore.js"),p=r("./src/Global.js");t.UserManagerSettings=function(e){function t(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.popup_redirect_uri,s=r.popup_post_logout_redirect_uri,a=r.popupWindowFeatures,u=r.popupWindowTarget,d=r.silent_redirect_uri,g=r.silentRequestTimeout,v=r.automaticSilentRenew,y=void 0!==v&&v,m=r.includeIdTokenInSilentRenew,S=void 0===m||m,_=r.monitorSession,F=void 0===_||_,b=r.checkSessionInterval,w=void 0===b?2e3:b,E=r.stopCheckSessionOnError,x=void 0===E||E,A=r.revokeAccessTokenOnSignout,P=void 0!==A&&A,C=r.accessTokenExpiringNotificationTime,k=void 0===C?60:C,R=r.redirectNavigator,T=void 0===R?new c.RedirectNavigator:R,I=r.popupNavigator,U=void 0===I?new h.PopupNavigator:I,j=r.iframeNavigator,O=void 0===j?new l.IFrameNavigator:j,L=r.userStore,N=void 0===L?new f.WebStorageStateStore({store:p.Global.sessionStorage}):L;n(this,t);var D=i(this,e.call(this,arguments[0]));return D._popup_redirect_uri=o,D._popup_post_logout_redirect_uri=s,D._popupWindowFeatures=a,D._popupWindowTarget=u,D._silent_redirect_uri=d,D._silentRequestTimeout=g,D._automaticSilentRenew=!!y,D._includeIdTokenInSilentRenew=S,D._accessTokenExpiringNotificationTime=k,D._monitorSession=F,D._checkSessionInterval=w,D._stopCheckSessionOnError=x,D._revokeAccessTokenOnSignout=P,D._redirectNavigator=T,D._popupNavigator=U,D._iframeNavigator=O,D._userStore=N,D}return s(t,e),a(t,[{key:"popup_redirect_uri",get:function(){return this._popup_redirect_uri}},{key:"popup_post_logout_redirect_uri",get:function(){return this._popup_post_logout_redirect_uri}},{key:"popupWindowFeatures",get:function(){return this._popupWindowFeatures}},{key:"popupWindowTarget",get:function(){return this._popupWindowTarget}},{key:"silent_redirect_uri",get:function(){return this._silent_redirect_uri}},{key:"silentRequestTimeout",get:function(){return this._silentRequestTimeout}},{key:"automaticSilentRenew",get:function(){return!(!this.silent_redirect_uri||!this._automaticSilentRenew)}},{key:"includeIdTokenInSilentRenew",get:function(){return this._includeIdTokenInSilentRenew}},{key:"accessTokenExpiringNotificationTime",get:function(){return this._accessTokenExpiringNotificationTime}},{key:"monitorSession",get:function(){return this._monitorSession}},{key:"checkSessionInterval",get:function(){return this._checkSessionInterval}},{key:"stopCheckSessionOnError",get:function(){return this._stopCheckSessionOnError}},{key:"revokeAccessTokenOnSignout",get:function(){return this._revokeAccessTokenOnSignout}},{key:"redirectNavigator",get:function(){return this._redirectNavigator}},{key:"popupNavigator",get:function(){return this._popupNavigator}},{key:"iframeNavigator",get:function(){return this._iframeNavigator}},{key:"userStore",get:function(){return this._userStore}}]),t}(u.OidcClientSettings)},"./src/WebStorageStateStore.js":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.WebStorageStateStore=void 0;var i=r("./src/Log.js"),o=r("./src/Global.js");t.WebStorageStateStore=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.prefix,i=void 0===r?"oidc.":r,s=t.store,a=void 0===s?o.Global.localStorage:s;n(this,e),this._store=a,this._prefix=i}return e.prototype.set=function(e,t){return i.Log.debug("WebStorageStateStore.set",e),e=this._prefix+e,this._store.setItem(e,t),Promise.resolve()},e.prototype.get=function(e){i.Log.debug("WebStorageStateStore.get",e),e=this._prefix+e;var t=this._store.getItem(e);return Promise.resolve(t)},e.prototype.remove=function(e){i.Log.debug("WebStorageStateStore.remove",e),e=this._prefix+e;var t=this._store.getItem(e);return this._store.removeItem(e),Promise.resolve(t)},e.prototype.getAllKeys=function(){i.Log.debug("WebStorageStateStore.getAllKeys");for(var e=[],t=0;t<this._store.length;t++){var r=this._store.key(t);0===r.indexOf(this._prefix)&&e.push(r.substr(this._prefix.length))}return Promise.resolve(e)},e}()},"./src/random.js":function(e,t,r){function n(){for(var e="xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx",t="0123456789abcdef",r=0,n="",i=0;i<e.length;i++)"-"!==e[i]&&"4"!==e[i]&&(r=16*Math.random()|0),"x"===e[i]?n+=t[r]:"y"===e[i]?(r&=3,r|=8,n+=t[r]):n+=e[i];return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n,e.exports=t.default}})})}).call(t,r(14)(e))},function(e,t,r){"use strict";function n(e){t.nextMiddleware=d=e}function i(){return d}function o(e){t.storedUser=p=e}function s(){t.storedUser=p=null}function a(e){!e||e.expired?d((0,l.userExpired)()):(t.storedUser=p=e,d((0,l.userFound)(e)))}function u(e){console.error("redux-oidc: Error loading user in oidcMiddleware: "+e.message),d((0,l.loadUserError)())}function c(e,r,n){return r.type===f.USER_EXPIRED||r.type===f.LOADING_USER||r.type===f.USER_FOUND?e(r):(t.nextMiddleware=d=e,p&&!p.expired||(e((0,l.loadingUser)()),n.getUser().then(a).catch(u)),e(r))}function h(e){if(!e||!e.getUser)throw new Error("You must provide a user manager!");return function(t){return function(t){return function(r){c(t,r,e)}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.nextMiddleware=t.storedUser=void 0,t.setNext=n,t.getNext=i,t.setStoredUser=o,t.removeStoredUser=s,t.getUserCallback=a,t.errorCallback=u,t.middlewareHandler=c,t.default=h;var l=r(0),f=r(1),p=t.storedUser=null,d=t.nextMiddleware=null},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(1),o=void 0;try{var s=r(15),a=s.fromJS,u=s.Seq,c=function e(t){return"object"!==(void 0===t?"undefined":n(t))||null===t?t:Array.isArray(t)?u(t).map(e).toList():u(t).map(e).toMap()},h=a({user:null,isLoadingUser:!1});o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments[1];switch(t.type){case i.USER_EXPIRED:case i.SILENT_RENEW_ERROR:return a({user:null,isLoadingUser:!1});case i.SESSION_TERMINATED:case i.USER_SIGNED_OUT:return a({user:null,isLoadingUser:!1});case i.USER_FOUND:return c({user:t.payload,isLoadingUser:!1});case i.LOADING_USER:return e.set("isLoadingUser",!0);default:return e}}}catch(e){o=function(){console.error("You must install immutable-js for the immutable reducer to work!")}}t.default=o},function(e,t,r){"use strict";function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s,t=arguments[1];switch(t.type){case o.USER_EXPIRED:case o.SILENT_RENEW_ERROR:return Object.assign({},i({},e),{user:null,isLoadingUser:!1});case o.SESSION_TERMINATED:case o.USER_SIGNED_OUT:return Object.assign({},i({},e),{user:null,isLoadingUser:!1});case o.USER_FOUND:return Object.assign({},i({},e),{user:t.payload,isLoadingUser:!1});case o.LOADING_USER:return Object.assign({},i({},e),{isLoadingUser:!0});default:return e}}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.default=n;var o=r(1),s={user:null,isLoadingUser:!1}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=require("immutable")},function(e,t,r){e.exports=r(5)}])});